<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>debug-test - MARC Records</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; line-height: 1.6; background: #fafafa; }
        
        /* Header */
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 2em; font-weight: 300; }
        .header p { margin: 10px 0 0; opacity: 0.9; }
        
        /* Image Gallery */
        .image-gallery { display: flex; gap: 15px; overflow-x: auto; padding: 20px 0; margin-bottom: 30px; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .thumbnail-container { flex-shrink: 0; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .thumbnail-container:hover { transform: scale(1.02); box-shadow: 0 4px 15px rgba(0,0,0,0.15); }
        .thumbnail { width: 200px; height: 300px; object-fit: cover; border-radius: 8px; border: 3px solid #e0e0e0; transition: border-color 0.2s ease; }
        .thumbnail-container:hover .thumbnail { border-color: #667eea; }
        .thumbnail-label { text-align: center; margin-top: 8px; font-size: 0.85em; color: #666; font-weight: 500; word-break: break-word; max-width: 200px; }
        .no-images { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 90vw; max-height: 90vh; }
        .modal-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .modal-close { position: absolute; top: 15px; right: 20px; color: white; font-size: 30px; font-weight: bold; cursor: pointer; z-index: 1001; width: 40px; height: 40px; border-radius: 50%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .modal-close:hover { background: rgba(255,0,0,0.7); }
        .modal-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.5); color: white; border: none; padding: 15px 20px; font-size: 18px; cursor: pointer; border-radius: 5px; transition: background 0.2s ease; }
        .modal-nav:hover { background: rgba(0,0,0,0.8); }
        .modal-prev { left: 20px; }
        .modal-next { right: 20px; }
        .modal-counter { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: white; background: rgba(0,0,0,0.7); padding: 8px 16px; border-radius: 20px; font-size: 14px; }
        
        /* MARC Records */
        .records-section h2 { color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; margin: 30px 0 20px; }
        .marc-record { background: white; border: none; margin-bottom: 25px; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .marc-record h3 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .confidence { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); padding: 6px 12px; border-radius: 20px; display: inline-block; margin-bottom: 15px; color: #2c5530; font-weight: 500; font-size: 0.9em; }
        .review-flag { background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); border: none; color: #d63031; padding: 6px 12px; border-radius: 20px; margin-bottom: 15px; font-weight: 500; font-size: 0.9em; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 5px rgba(0,0,0,0.05); }
        th, td { padding: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #f0f0f0; }
        th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; width: 100px; }
        .subfield-code { font-weight: bold; color: #667eea; background: #f8f9ff; padding: 2px 4px; border-radius: 3px; margin-right: 5px; }
        .no-records { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* External API Results */
        .api-results-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .api-results-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .api-summary { background: #f8f9ff; border: 1px solid #e0e6ff; border-radius: 6px; padding: 12px; margin-bottom: 20px; }
        .api-summary p { margin: 0; color: #333; font-size: 0.95em; }
        .api-source { margin-bottom: 20px; }
        .api-source h3 { color: #667eea; margin-bottom: 10px; font-size: 1.1em; }
        .api-matches { background: #f8f9ff; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .api-match { background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 10px; margin-bottom: 10px; }
        .api-match:last-child { margin-bottom: 0; }
        .match-title { font-weight: 600; color: #333; margin-bottom: 5px; }
        .match-author { color: #666; margin-bottom: 5px; }
        .match-details { font-size: 0.9em; color: #888; }
        .no-matches { text-align: center; padding: 20px; color: #999; font-style: italic; }
        .api-no-results { }
        .search-details { background: #f8f9fa; border-radius: 6px; padding: 15px; margin-top: 15px; }
        .search-details h4 { margin-top: 0; color: #495057; }
        .search-details ul { margin: 10px 0; padding-left: 20px; }
        .search-details li { margin-bottom: 5px; color: #6c757d; }
        .search-details em { color: #6c757d; }
        .authority-result { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 0.85em; margin-right: 10px; }
        .authority-valid { background: #d4edda; color: #155724; }
        .authority-invalid { background: #f8d7da; color: #721c24; }
        
        /* JSON Tree View */
        .json-tree-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .json-tree-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .tree-container { border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; background: #fafafa; max-height: 600px; overflow-y: auto; font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono", monospace; }
        .expand-all-btn, .collapse-all-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; margin-right: 10px; margin-bottom: 15px; font-size: 0.9em; transition: transform 0.2s ease; }
        .expand-all-btn:hover, .collapse-all-btn:hover { transform: translateY(-1px); }
        
        /* Footer */
        .footer { text-align: center; padding: 20px; color: #666; font-size: 0.9em; background: white; border-radius: 10px; margin-top: 30px; }
        .footer a { color: #667eea; text-decoration: none; font-weight: 500; }
        .footer a:hover { text-decoration: underline; }
        
        /* Responsive */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .thumbnail { width: 150px; height: 225px; }
            .thumbnail-label { max-width: 150px; }
            .modal-nav { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>debug-test</h1>
        <p>üìö MARC Records generated by marcsnarc on 2025-12-23 11:47:47</p>
    </div>
    
    <div class='image-gallery'>

                <div class='thumbnail-container' onclick='openModal(0)'>
                    <img src='img_PXL_20251212_165802824.webp' alt='PXL_20251212_165802824.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165802824.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(1)'>
                    <img src='img_PXL_20251212_165807773.webp' alt='PXL_20251212_165807773.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165807773.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(2)'>
                    <img src='img_PXL_20251212_165816342.webp' alt='PXL_20251212_165816342.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165816342.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(3)'>
                    <img src='img_PXL_20251212_165825246.webp' alt='PXL_20251212_165825246.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165825246.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(4)'>
                    <img src='img_PXL_20251212_165855357.webp' alt='PXL_20251212_165855357.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165855357.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(5)'>
                    <img src='img_PXL_20251212_165928834.webp' alt='PXL_20251212_165928834.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165928834.jpg</div>
                </div>
                </div>

    
    <!-- Modal for image viewing -->
    <div id="imageModal" class="modal">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <button class="modal-nav modal-prev" onclick="changeImage(-1)">‚Äπ</button>
        <button class="modal-nav modal-next" onclick="changeImage(1)">‚Ä∫</button>
        <div class="modal-content">
            <img id="modalImage" class="modal-image" src="" alt="">
        </div>
        <div class="modal-counter" id="modalCounter"></div>
    </div>
    
    <div class="records-section">
        <h2>üìã MARC Records</h2>
        <div class='marc-record'>
<h3>Record 1</h3>
<div class='confidence'>Confidence: 0.47</div>
<div class='review-flag'>‚ö†Ô∏è Review Required</div>
<table><tr><th>LDR</th><td>00000nam a200000 Ki 500</td></tr><tr><th>001</th><td>msn20251223174746</td></tr><tr><th>003</th><td>DLC</td></tr><tr><th>005</th><td>20251223174746.0</td></tr><tr><th>008</th><td>251223m19372019            o     00jpn und d</td></tr><tr><th>040</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>DLC <span class="subfield-code">‚Ä°b</span>eng <span class="subfield-code">‚Ä°c</span>DLC <span class="subfield-code">‚Ä°e</span>rda </td></tr><tr><th>245</th><td><strong>00</strong> <span class="subfield-code">‚Ä°a</span>debug-test </td></tr><tr><th>264</th><td><strong>_1</strong> <span class="subfield-code">‚Ä°c</span>1937 </td></tr><tr><th>300</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>6 items (various formats) </td></tr><tr><th>520</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection consists of 3 books, 3 other items. Items date from 1937 to 2019. </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection-level record for 6 items </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Provenance: Extracted from 6 images using marcsnarc </td></tr><tr><th>561</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Extracted from 6 images using marcsnarc </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Sino-Japanese War </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Military history </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Japanese history </td></tr><tr><th>999</th><td><strong>__</strong> <span class="subfield-code">‚Ä°i</span>Generated by marcsnarc on 2025-12-23 <span class="subfield-code">‚Ä°s</span>marcsnarc </td></tr></table></div>

    </div>
    
    <div class="api-results-section">
<h2>üåê External API Results</h2>
<div class="api-summary">
<p><strong>Search Summary:</strong> 2 item(s) searched across WorldCat, Library of Congress, and Alma catalogs</p>
</div>
<div class="api-no-results">
<div class="no-matches">External catalog searches were performed but no matches were found.</div>
<div class="search-details">
<p><strong>Search Status by Service:</strong></p>
<ul>
<li><strong>üìö WorldCat:</strong> Search attempted - likely failed due to server issues or no matches</li>
<li><strong>üèõÔ∏è Library of Congress:</strong> Authority validation performed</li>
<li><strong>üéì Alma Catalog:</strong> Local catalog searched</li>
</ul>
<p><em>Check the processing logs for detailed error messages.</em></p>
</div>
</div>
</div>

    
    
            <div class='json-tree-section'>
                <h2>üìä Analysis Data</h2>
                <div class='tree-container' id='analysis-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("analysis-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("analysis-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
            <div class='json-tree-section'>
                <h2>üìã Processing Metadata</h2>
                <div class='tree-container' id='metadata-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("metadata-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("metadata-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
    
    <div class="footer">
        Generated with <a href="https://github.com/anthropics/marcsnarc">marcsnarc</a> - AI-powered MARC cataloging
    </div>
    
    <script>
        // Global variables for modal and JSON data
        let currentImages = [];
        let currentImageIndex = 0;
        const analysisData = {"collection_analysis": {"item_count": 6, "formats": {"format_counts": {"book": 2, "pamphlet": 1, "manuscript|note": 1, "magazine/pictorial": 1, "magazine|pamphlet": 1}, "unique_formats": "{'manuscript|note', 'magazine|pamphlet', 'magazine/pictorial', 'pamphlet', 'book'}", "books": 3, "serials": 0, "ephemera": 0, "other": 3, "primary_format": "book"}, "creators": {"creator_counts": {"ÊÅ©‰∫ïÂππÈõÑ": 1, "ÊúùÊó•Êñ∞ËÅûÁ§æ": 1, "Multiple authors referenced (Kyoshi, Showa entries)": 1}, "unique_creators": "{'ÊúùÊó•Êñ∞ËÅûÁ§æ', 'Multiple authors referenced (Kyoshi, Showa entries)', 'ÊÅ©‰∫ïÂππÈõÑ'}", "items_with_creators": 3, "items_without_creators": 3, "dominant_creator": ["ÊÅ©‰∫ïÂππÈõÑ", 1]}, "dates": {"date_range": [1937, 2019], "earliest_date": 1937, "latest_date": 2019, "date_span": 82, "items_with_dates": 4, "date_counts": {"1937": 2, "1943": 1, "2019": 1}}, "languages": {"language_counts": {"multiple languages - english, japanese, chinese": 1, "jpn": 2, "tibetan": 1, "english with japanese romanization": 1, "english, japanese": 1}, "unique_languages": "{'tibetan', 'jpn', 'multiple languages - english, japanese, chinese', 'english with japanese romanization', 'english, japanese'}", "primary_language": "jpn", "multilingual": true}, "subjects": {"subject_counts": {"Sino-Japanese War": 2, "China Incident": 1, "Military history": 2, "Japanese occupation of China": 1, "World War II period": 1, "Pictorial documentation": 1, "Manchuria": 1, "Manchukuo": 1, "Dance": 1, "Cultural studies": 1, "Ethnography": 1, "North China Incident": 1, "Military photography": 1, "War journalism": 1, "1937 China conflict": 1, "Japanese history": 2, "Japanese government": 1, "Osaka region": 1, "World War II era": 1, "Burma": 1, "Solomon Islands": 1, "Cover operations": 1, "Diplomacy": 1, "War news": 1, "East Asia": 1, "Combined Fleet": 1, "Burma front": 1, "Admiral Soemu Toyoda": 1, "Koga fleet": 1}, "unique_subjects": "{'Japanese history', 'War news', 'Osaka region', 'East Asia', 'Manchukuo', 'Ethnography', 'Pictorial documentation', 'Diplomacy', 'World War II period', 'Japanese occupation of China', 'Solomon Islands', 'Combined Fleet', 'Koga fleet', 'North China Incident', 'Japanese government', 'Military history', 'Admiral Soemu Toyoda', 'Sino-Japanese War', 'Cultural studies', 'War journalism', 'Dance', 'Cover operations', 'Manchuria', 'World War II era', 'Burma front', 'Burma', '1937 China conflict', 'China Incident', 'Military photography'}", "items_with_subjects": 5, "common_subjects": [["Sino-Japanese War", 2], ["Military history", 2], ["Japanese history", 2], ["China Incident", 1], ["Japanese occupation of China", 1]], "subject_coherence": 2.718390804597701}, "provenance": {"collection_provenance": "Extracted from 6 images using marcsnarc", "item_provenances": {}, "consistency_score": 1.0, "has_provenance": true}, "identifiers": {"items_with_isbn": 0, "items_with_issn": 0, "items_with_oclc": 0, "items_with_lccn": 0, "identifier_coverage": 0.0}, "physical_characteristics": {"extent_variety": 5, "dimension_variety": 4, "physical_coherence": 0.25}, "format_diversity": 5, "creator_diversity": 3, "has_books_serials": true, "shared_provenance": true, "temporal_coherence": 0.2, "workflow_type": "collection_images_to_marc", "collection_name": "debug-test", "processing_timestamp": "2025-12-23T11:47:47.147382", "total_records": 1, "approach": "collection"}, "batch_analysis": {"collection_name": "debug-test", "total_images": 6, "successful_analyses": 6, "failed_analyses": 0, "individual_results": [{"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "extracted_data": {"title": "The China Incident Pictorial", "publisher": "Asahi Shimbun sha (Osaka mai nichi Shimbun sha and nichi Shinbun sha)", "publication_place": "Osaka and Tokyo, Japan", "publication_date": "1937-1939 (primary entries); 1958 (referenced item)", "normalized_date": {"normalized": "1937", "end_date": "1939", "circa": false, "uncertain": false, "original": "1937-1939 (primary entries); 1958 (referenced item)"}, "format": "book", "extent": "Multiple issues/volumes referenced", "language": "multiple languages - english, japanese, chinese", "original_script_title": "Latin script with references to Japanese and Chinese characters", "other_identifiers": "Showa references: Showa 12 (August 3), Showa 12 (August 30), Showa 12 (October 21), Showa 13 (February 11-13), Showa 13 (February 21), Showa 13 (March 11), Showa 13 (September 1), Showa 14 (March 5-April 5), Showa 14 (April 20-70), Showa 14 (July 5)", "subjects": [{"heading": "Sino-Japanese War", "type": "topical", "source": "claude_analysis"}, {"heading": "China Incident", "type": "topical", "source": "claude_analysis"}, {"heading": "Military history", "type": "topical", "source": "claude_analysis"}, {"heading": "Japanese occupation of China", "type": "topical", "source": "claude_analysis"}, {"heading": "World War II period", "type": "topical", "source": "claude_analysis"}, {"heading": "Pictorial documentation", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This appears to be a bibliographic reference list or catalog entry describing pictorial materials related to the Sino-Japanese War (also known as 'The China Incident')", "source": "image_analysis"}, {"text": "References Showa dating system (Japanese imperial calendar)", "source": "image_analysis"}, {"text": "Multiple date entries ranging from Showa 12-14 (1937-1939)", "source": "image_analysis"}, {"text": "Contains references to various covers including soldiers, military scenes, daily life in China, and commemorative imagery", "source": "image_analysis"}, {"text": "References items numbered 1-70 with specific cover descriptions", "source": "image_analysis"}, {"text": "Published during active wartime period", "source": "image_analysis"}, {"text": "Includes reference to 'Jinan Gibyo' (a large format box photo-illustrated magazine)", "source": "image_analysis"}, {"text": "Multiple publishers referenced including Osaka mai nichi, Tokyo nichi nichi", "source": "image_analysis"}, {"text": "Special issues noted for campaigns including Hanchang campaign, Nanchang, East Asia", "source": "image_analysis"}, {"text": "References to landings at Swatow and support craft imagery", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.2, "publication": 0.5850000000000001, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.52325}, "overall_confidence": 0.52325, "claude_factors": {"text_clarity": "high", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Osaka mai nichi, Tokyo nichi nichi", "language": "Japanese (romanized)", "location": "publisher information"}, {"text": "Title: ÊîØÈÇ£‰∫ãËÆäÁï´Â†± Shina jihen gaho [The China Incident Pictorial]", "language": "Japanese and English", "location": "title section"}, {"text": "Publisher: Â§ßÈò™ÊØèÊó•Êñ∞ËÅûÁ§æ Osaka mai nichi Shinbun sha Âú∞ÊñπÁâàÊó•Êñ∞ËÅûÁ§æ Tokyo nichi Shinbun", "language": "Japanese (traditional characters) and English romanization", "location": "publisher information"}, {"text": "Showa 12, August 3; no. 1; Showa 12, August 30; no. 5; Showa 12, October 21; no. 7; [1958]; Showa 13, February 11; no. 18; Showa 13, February 21; no. 19; Showa 13, March 11; no. 20; Showa 13, September 1; no. 38; [1939]; Showa 14, March 5; no. 54; Showa 14, April 5; no. 56; Showa 14, April 20; no. 57; Showa 14, July 5; no. 62", "language": "English with Japanese era dating", "location": "publication dates and issue numbers"}], "processing_notes": ["Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 1}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "extracted_data": {"title": "Ê∫ÄÊ¥≤Â∏ùÂõΩ", "subtitle": "Ê∫ÄÊ¥≤„ÅÆÈ¢®Áâ©„Å®ËàûË∏ä / Ê∫ÄÊ¥≤„ÅÆËàûË∏ä„Å®È¢®Áâ©", "creator": {"name": "ÊÅ©‰∫ïÂππÈõÑ", "type": "personal", "source": "claude_analysis", "romanization": "Onoi Mikio"}, "publication_place": "Ê∫ÄÊ¥≤Â∏ùÂõΩ (Manchukuo/Manchuria)", "format": "pamphlet", "extent": "Single sheet or pamphlet page", "dimensions": "Approximately A4 or similar size", "language": "jpn", "original_script_title": "Japanese (Kanji and Kana)", "subjects": [{"heading": "Manchuria", "type": "topical", "source": "claude_analysis"}, {"heading": "Manchukuo", "type": "topical", "source": "claude_analysis"}, {"heading": "Dance", "type": "topical", "source": "claude_analysis"}, {"heading": "Cultural studies", "type": "topical", "source": "claude_analysis"}, {"heading": "Ethnography", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document appears to be a cover or title page of a publication about Manchukuo", "source": "image_analysis"}, {"text": "Contains photographic illustrations showing architectural scenes and a figure in traditional dress", "source": "image_analysis"}, {"text": "Text is printed in traditional right-to-left vertical Japanese format", "source": "image_analysis"}, {"text": "Paper shows significant age-related discoloration and wear", "source": "image_analysis"}, {"text": "Main title reads 'Ê∫ÄÊ¥≤Â∏ùÂõΩ' (Mansh≈´ Teikoku - Manchurian Empire)", "source": "image_analysis"}, {"text": "Subtitle appears to discuss 'customs/scenery and dance of Manchuria'", "source": "image_analysis"}, {"text": "Header text at top of page appears to be publication information", "source": "image_analysis"}, {"text": "Historical document likely from 1930s-1940s period of Japanese occupation", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.15166666666666667, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.4668333333333333}, "overall_confidence": 0.4668333333333333, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Ê∫ÄÊ¥≤Â∏ùÂõΩ", "language": "Japanese", "location": "title"}, {"text": "Ê∫ÄÊ¥≤„ÅÆËàûË∏ä„Å®È¢®Áâ© / Ê∫ÄÊ¥≤„ÅÆÈ¢®Áâ©„Å®ËàûË∏ä", "language": "Japanese", "location": "subtitle area"}, {"text": "ÊÅ©‰∫ïÂππÈõÑ", "language": "Japanese", "location": "left margin (vertical text)"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 2}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "extracted_data": {"title": "Bet lhun", "format": "manuscript|note", "extent": "1 note", "dimensions": "approximately 15 x 12 cm (estimated from image)", "language": "tibetan", "original_script_title": "Tibetan script (Uchen or cursive)", "notes": [{"text": "Handwritten text on blue paper/sticky note", "source": "image_analysis"}, {"text": "Text appears to be written vertically in Tibetan script", "source": "image_analysis"}, {"text": "The text reads 'Bet lhun' (approximate romanization)", "source": "image_analysis"}, {"text": "Appears to be a personal note or label rather than a formal publication", "source": "image_analysis"}, {"text": "Photographed on wooden surface", "source": "image_analysis"}, {"text": "Cursive/informal Tibetan handwriting style", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.2, "publication": 0.0, "format": 0.26, "language": 0.45499999999999996, "overall": 0.313}, "overall_confidence": 0.313, "claude_factors": {"text_clarity": "medium", "completeness": "low", "language_certainty": "medium"}, "original_text_regions": [{"text": "‡Ωñ‡Ω∫‡Ωë‡ºã‡Ω£‡æ∑‡Ω¥‡Ωì‡ºç (approximate - handwriting makes exact transcription difficult)", "language": "Tibetan", "location": "front of note"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Bibliographic information appears incomplete in image", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 3}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "extracted_data": {"title": "ÂåóÊîØ‰∫ãÂèòÁîªÂ†±", "creator": {"name": "ÊúùÊó•Êñ∞ËÅûÁ§æ", "type": "corporate", "source": "claude_analysis", "romanization": "Asahi Shinbunsha"}, "publisher": "ÊúùÊó•Êñ∞ËÅûÁ§æ", "publication_place": "Êó•Êú¨ (Japan)", "publication_date": "Êò≠ÂíåÂçÅ‰∫åÂπ¥ (1937)", "normalized_date": {"normalized": "1937", "end_date": null, "circa": false, "uncertain": false, "original": "Êò≠ÂíåÂçÅ‰∫åÂπ¥ (1937)"}, "format": "magazine/pictorial", "extent": "Single issue pamphlet", "dimensions": "Approximately A4 size based on visual assessment", "language": "jpn", "original_script_title": "Traditional Chinese characters (Kanji)", "other_identifiers": "Á¨¨‰∏ÄËºØ (Volume/Issue 1)", "subjects": [{"heading": "Sino-Japanese War", "type": "topical", "source": "claude_analysis"}, {"heading": "North China Incident", "type": "topical", "source": "claude_analysis"}, {"heading": "Military photography", "type": "topical", "source": "claude_analysis"}, {"heading": "War journalism", "type": "topical", "source": "claude_analysis"}, {"heading": "1937 China conflict", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Photographic pictorial report published by Asahi Shimbun", "source": "image_analysis"}, {"text": "Cover shows soldiers in helmets with rifles in combat position", "source": "image_analysis"}, {"text": "Historical military propaganda/news publication from WWII era", "source": "image_analysis"}, {"text": "Paper shows age-related discoloration and wear", "source": "image_analysis"}, {"text": "Title translates to 'North China Incident Pictorial Report'", "source": "image_analysis"}, {"text": "This appears to be the first volume/issue (Á¨¨‰∏ÄËºØ)", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.45499999999999996, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.5275}, "overall_confidence": 0.5275, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "ÂåóÊîØ‰∫ãÂ§âÁîªÂ†±", "language": "Japanese (using Chinese characters)", "location": "cover title"}, {"text": "ÊúùÊó•Êñ∞ËÅûÁ§æ", "language": "Japanese", "location": "publisher information on cover"}, {"text": "Êò≠ÂíåÂçÅ‰∫åÂπ¥ÂÖ´Êúà‰∏âÂçÅ‰∏ÄÊó•ÁôºË°å", "language": "Japanese", "location": "left side vertical text (publication date)"}, {"text": "Á¨¨‰∏ÄËºØ", "language": "Japanese", "location": "left side vertical text (issue number)"}], "processing_notes": ["Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 4}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "extracted_data": {"title": "Bibliography or Reference Work (appears to be endnotes or bibliography entries)", "creator": {"name": "Multiple authors referenced (Kyoshi, Showa entries)", "type": "corporate", "source": "claude_analysis"}, "publisher": "Various publishers referenced in entries", "publication_place": "Tokyo; Showa; New Guinea; Shanghai; various locations", "publication_date": "1930s-2000s (range of dates in references: 1943, 1944, 1964, 2006)", "normalized_date": {"normalized": "1943", "end_date": null, "circa": false, "uncertain": false, "original": "1930s-2000s (range of dates in references: 1943, 1944, 1964, 2006)"}, "format": "book", "extent": "Single page of bibliography/endnotes", "dimensions": "Standard letter size (approximately 8.5 x 11 inches)", "language": "english with japanese romanization", "original_script_title": "Latin alphabet with romanized Japanese (some Japanese characters visible)", "other_identifiers": "Entry numbers visible: [1930], [1943], [1944], ranging approximately Show 14-16 and subsequent entries", "subjects": [{"heading": "Japanese history", "type": "topical", "source": "claude_analysis"}, {"heading": "Japanese government", "type": "topical", "source": "claude_analysis"}, {"heading": "Osaka region", "type": "topical", "source": "claude_analysis"}, {"heading": "World War II era", "type": "topical", "source": "claude_analysis"}, {"heading": "Burma", "type": "topical", "source": "claude_analysis"}, {"heading": "Solomon Islands", "type": "topical", "source": "claude_analysis"}, {"heading": "Military history", "type": "topical", "source": "claude_analysis"}, {"heading": "Cover operations", "type": "topical", "source": "claude_analysis"}, {"heading": "Diplomacy", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This appears to be a page of endnotes or bibliography entries from an academic work", "source": "image_analysis"}, {"text": "Contains mixed English and romanized Japanese text", "source": "image_analysis"}, {"text": "Multiple entries reference 'Dai-toa senso pishi' (Greater East Asia War Pictorial) and similar Japanese sources", "source": "image_analysis"}, {"text": "References include both English and Japanese language sources", "source": "image_analysis"}, {"text": "Entries discuss topics related to Japanese ambassadors, military operations, and WWII-era events", "source": "image_analysis"}, {"text": "Shows numbering system for citations (e.g., Showa 14, August 5, no. 64)", "source": "image_analysis"}, {"text": "Contains detailed bibliographic information including editors, publishers, dates, and page numbers", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.45499999999999996, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.5275}, "overall_confidence": 0.5275, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Showa 14, August 5, no. 64. Anglo-Japanese talks in Tokyo. Cover II neutralizers, pp. of behind a paint tree to celebrate establishment of a new government of China.", "language": "English", "location": "body text - left column"}, {"text": "Showa 15, April 5, no. 80. Special issue on the formation of a new Chinese national government under Wang Jingwei in Nanjing. Cover, celebratory arch in Shanghai.", "language": "English", "location": "body text - left column"}, {"text": "Â§ßÊù±‰∫úÊà¶‰∫âÁîªÂ†± Dai-toa senso pishi (Greater East Asia War Pictorial)", "language": "Japanese with romanization", "location": "body text - middle and right columns"}], "processing_notes": ["Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 5}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg", "extracted_data": {"title": "Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æÊà¶ÊôÇÂè∑Â§ñÁæ§", "publication_date": "2019", "normalized_date": {"normalized": "2019", "end_date": null, "circa": false, "uncertain": false, "original": "2019"}, "format": "magazine|pamphlet", "language": "english, japanese", "original_script_title": "Latin script, Japanese script (Kanji)", "other_identifiers": "Total issues held: 19", "subjects": [{"heading": "Japanese history", "type": "topical", "source": "claude_analysis"}, {"heading": "War news", "type": "topical", "source": "claude_analysis"}, {"heading": "East Asia", "type": "topical", "source": "claude_analysis"}, {"heading": "Combined Fleet", "type": "topical", "source": "claude_analysis"}, {"heading": "Burma front", "type": "topical", "source": "claude_analysis"}, {"heading": "Admiral Soemu Toyoda", "type": "topical", "source": "claude_analysis"}, {"heading": "Koga fleet", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Publication appears to be a catalog or description of a collection of wartime news extra editions from Tokyo nichi nichi shimbunsha", "source": "image_analysis"}, {"text": "Text describes various military news items including Japan's war in Greater East Asia", "source": "image_analysis"}, {"text": "Mentions photographed issues and advertisements related to military contents from front cover and Admiral Soemu Toyoda", "source": "image_analysis"}, {"text": "Reference to Combined Fleet, India-Burma front, Staines in connection", "source": "image_analysis"}, {"text": "Mentions Admiral Mineichi Koga as combined fleet commander", "source": "image_analysis"}, {"text": "Reference to the Combined Fleet and related military content", "source": "image_analysis"}, {"text": "Text includes mixed English and Japanese characters", "source": "image_analysis"}, {"text": "Cataloged in July 2019", "source": "image_analysis"}, {"text": "Document appears to be rotated 90 degrees in the image", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.2, "publication": 0.15166666666666667, "format": 0.26, "language": 0.5850000000000001, "overall": 0.35633333333333334}, "overall_confidence": 0.35633333333333334, "claude_factors": {"text_clarity": "medium", "completeness": "low", "language_certainty": "high"}, "original_text_regions": [{"text": "Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æÊà¶ÊôÇÂè∑Â§ñÁæ§", "language": "Japanese", "location": "title page"}, {"text": "Tokyo nichi nichi shimbunsha jikyo goki sendan jidai gekkan. A large format monthly illustrated magazine devoted to the news of Japan's war in greater East Asia. Includes a day by day summary of the month's news. Photographs are u&w only. Rear covers are advertisements. Contents: front cover; Admiral Soemu Toyoda, commander of the Combined Fleet; standing on the bridge, India-Burma front, Staines in Battleannihle. Death of Admiral Mineichi Koga, commander of the combined fleet. Loyang. Condition. Excellent. Disbound, with four small holes punctured along edge, purchased from Utagawa123 via Ebay in the early 2000s.", "language": "English", "location": "description"}, {"text": "Total issues held: 19. Cataloged July, 2019.", "language": "English", "location": "cataloging information"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Bibliographic information appears incomplete in image", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 6}], "collection_analysis": {"total_items": 6, "successful_extractions": 6, "common_characteristics": {"primary_language": "jpn", "language_distribution": {"multiple languages - english, japanese, chinese": 1, "jpn": 2, "tibetan": 1, "english with japanese romanization": 1, "english, japanese": 1}, "primary_format": "book", "format_distribution": {"book": 2, "pamphlet": 1, "manuscript|note": 1, "magazine/pictorial": 1, "magazine|pamphlet": 1}, "publishers": {"Asahi Shimbun sha (Osaka mai nichi Shimbun sha and nichi Shinbun sha)": 1, "ÊúùÊó•Êñ∞ËÅûÁ§æ": 1, "Various publishers referenced in entries": 1}}, "quality_assessment": {"average_confidence": 0.45240277777777776, "high_confidence_items": 0, "low_confidence_items": 3, "confidence_range": [0.313, 0.5275]}, "recommendations": ["More than 30% of items have low confidence - consider manual review", "Multiple languages detected - verify language coding", "6 items contain CJK characters - verify romanization"]}, "batch_confidence": 0.45240277777777776, "processing_timestamp": "2025-12-23T11:47:46.841855"}, "individual_extractions": [{"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "extraction_confidence": 0.52325, "extracted_fields": ["title", "publisher", "publication_place", "publication_date", "normalized_date", "format", "extent", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "extraction_confidence": 0.4668333333333333, "extracted_fields": ["title", "subtitle", "creator", "publication_place", "format", "extent", "dimensions", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "extraction_confidence": 0.313, "extracted_fields": ["title", "format", "extent", "dimensions", "language", "original_script_title", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "extraction_confidence": 0.5275, "extracted_fields": ["title", "creator", "publisher", "publication_place", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "extraction_confidence": 0.5275, "extracted_fields": ["title", "creator", "publisher", "publication_place", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg", "extraction_confidence": 0.35633333333333334, "extracted_fields": ["title", "publication_date", "normalized_date", "format", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}], "external_api_results": [{"worldcat": [], "loc": [], "alma": [], "best_match": null}]};
        const metadataData = {"workflow_type": "collection_images_to_marc", "collection_name": "debug-test", "processing_result": {"approach": "collection", "records_generated": 1, "review_required": true, "groupings": {"approach": "collection", "total_items": 6, "groups": [{"type": "collection", "items": ["The China Incident Pictorial", "Ê∫ÄÊ¥≤Â∏ùÂõΩ", "Bet lhun", "ÂåóÊîØ‰∫ãÂèòÁîªÂ†±", "Bibliography or Reference Work (appears to be endnotes or bibliography entries)", "Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æÊà¶ÊôÇÂè∑Â§ñÁæ§"], "record_type": "collection"}]}}, "collection_data": {"total_items": 6, "source_images": ["examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg"], "provenance": "Extracted from 6 images using marcsnarc"}, "batch_analysis_summary": {"total_images": 6, "successful_analyses": 6, "batch_confidence": 0.45240277777777776}, "processing_timestamp": "2025-12-23T11:47:47.147403"};
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize images array from gallery
            const thumbnails = document.querySelectorAll('.thumbnail');
            currentImages = Array.from(thumbnails).map(img => ({
                src: img.src,
                alt: img.alt
            }));
            
            // Initialize JSON trees
            if (analysisData && Object.keys(analysisData).length > 0) {
                renderJsonTree('analysis-tree', analysisData);
            }
            if (metadataData && Object.keys(metadataData).length > 0) {
                renderJsonTree('metadata-tree', metadataData);
            }
        });
        
        // Modal functions
        function openModal(index) {
            currentImageIndex = index;
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const counter = document.getElementById('modalCounter');
            
            if (currentImages[index]) {
                modalImage.src = currentImages[index].src;
                modalImage.alt = currentImages[index].alt;
                counter.textContent = `${index + 1} of ${currentImages.length}`;
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function changeImage(direction) {
            currentImageIndex = (currentImageIndex + direction + currentImages.length) % currentImages.length;
            openModal(currentImageIndex);
        }
        
        // Keyboard controls
        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'block') {
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft') changeImage(-1);
                if (e.key === 'ArrowRight') changeImage(1);
            }
        });
        
        // Close modal on background click
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        // JSON Tree rendering functions
        function renderJsonTree(containerId, data) {
            const container = document.getElementById(containerId);
            if (!container || !data) return;
            
            container.innerHTML = '';
            const tree = createTreeElement(data, '', 0);
            container.appendChild(tree);
        }
        
        function createTreeElement(value, key, level) {
            const wrapper = document.createElement('div');
            wrapper.style.marginLeft = `${level * 20}px`;
            wrapper.style.marginBottom = '3px';
            
            if (value && typeof value === 'object' && !Array.isArray(value)) {
                // Object
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                Object.entries(value).forEach(([childKey, childValue]) => {
                    children.appendChild(createTreeElement(childValue, childKey, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìÇ ${key} {${Object.keys(value).length}}</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else if (Array.isArray(value)) {
                // Array
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                value.forEach((item, index) => {
                    children.appendChild(createTreeElement(item, `[${index}]`, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìñ ${key} [${value.length}]</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else {
                // Primitive value
                const element = document.createElement('div');
                const valueStr = value === null ? 'null' : String(value);
                const valueType = typeof value;
                let color = '#4a5568';
                let icon = 'üìÑ';
                
                if (valueType === 'string') { color = '#38a169'; icon = 'üìù'; }
                else if (valueType === 'number') { color = '#d69e2e'; icon = 'üî¢'; }
                else if (valueType === 'boolean') { color = '#9f7aea'; icon = '‚úÖ'; }
                else if (value === null) { color = '#a0aec0'; icon = '‚ùå'; }
                
                element.innerHTML = `<span style="color: #2d3748; font-weight: 600;">${icon} ${key}:</span> <span style="color: ${color};">${valueType === 'string' ? '"' + valueStr + '"' : valueStr}</span>`;
                wrapper.appendChild(element);
            }
            
            return wrapper;
        }
        
        function expandAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñ∂')) {
                    span.parentElement.click();
                }
            });
        }
        
        function collapseAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñº')) {
                    span.parentElement.click();
                }
            });
        }
    </script>
</body>
</html>