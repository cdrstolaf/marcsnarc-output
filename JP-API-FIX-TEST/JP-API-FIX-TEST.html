<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>JP-API-FIX-TEST - MARC Records</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; line-height: 1.6; background: #fafafa; }
        
        /* Header */
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 2em; font-weight: 300; }
        .header p { margin: 10px 0 0; opacity: 0.9; }
        
        /* Image Gallery */
        .image-gallery { display: flex; gap: 15px; overflow-x: auto; padding: 20px 0; margin-bottom: 30px; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .thumbnail-container { flex-shrink: 0; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .thumbnail-container:hover { transform: scale(1.02); box-shadow: 0 4px 15px rgba(0,0,0,0.15); }
        .thumbnail { width: 200px; height: 300px; object-fit: cover; border-radius: 8px; border: 3px solid #e0e0e0; transition: border-color 0.2s ease; }
        .thumbnail-container:hover .thumbnail { border-color: #667eea; }
        .thumbnail-label { text-align: center; margin-top: 8px; font-size: 0.85em; color: #666; font-weight: 500; word-break: break-word; max-width: 200px; }
        .no-images { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 90vw; max-height: 90vh; }
        .modal-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .modal-close { position: absolute; top: 15px; right: 20px; color: white; font-size: 30px; font-weight: bold; cursor: pointer; z-index: 1001; width: 40px; height: 40px; border-radius: 50%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .modal-close:hover { background: rgba(255,0,0,0.7); }
        .modal-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.5); color: white; border: none; padding: 15px 20px; font-size: 18px; cursor: pointer; border-radius: 5px; transition: background 0.2s ease; }
        .modal-nav:hover { background: rgba(0,0,0,0.8); }
        .modal-prev { left: 20px; }
        .modal-next { right: 20px; }
        .modal-counter { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: white; background: rgba(0,0,0,0.7); padding: 8px 16px; border-radius: 20px; font-size: 14px; }
        
        /* MARC Records */
        .records-section h2 { color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; margin: 30px 0 20px; }
        .marc-record { background: white; border: none; margin-bottom: 25px; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .marc-record h3 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .confidence { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); padding: 6px 12px; border-radius: 20px; display: inline-block; margin-bottom: 15px; color: #2c5530; font-weight: 500; font-size: 0.9em; }
        .review-flag { background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); border: none; color: #d63031; padding: 6px 12px; border-radius: 20px; margin-bottom: 15px; font-weight: 500; font-size: 0.9em; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 5px rgba(0,0,0,0.05); }
        th, td { padding: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #f0f0f0; }
        th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; width: 100px; }
        .subfield-code { font-weight: bold; color: #667eea; background: #f8f9ff; padding: 2px 4px; border-radius: 3px; margin-right: 5px; }
        .no-records { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* External API Results */
        .api-results-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .api-results-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .api-summary { background: #f8f9ff; border: 1px solid #e0e6ff; border-radius: 6px; padding: 12px; margin-bottom: 20px; }
        .api-summary p { margin: 0; color: #333; font-size: 0.95em; }
        .api-source { margin-bottom: 20px; }
        .api-source h3 { color: #667eea; margin-bottom: 10px; font-size: 1.1em; }
        .api-matches { background: #f8f9ff; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .api-match { background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 10px; margin-bottom: 10px; }
        .api-match:last-child { margin-bottom: 0; }
        .match-title { font-weight: 600; color: #333; margin-bottom: 5px; }
        .match-author { color: #666; margin-bottom: 5px; }
        .match-details { font-size: 0.9em; color: #888; }
        .no-matches { text-align: center; padding: 20px; color: #999; font-style: italic; }
        .api-no-results { }
        .search-details { background: #f8f9fa; border-radius: 6px; padding: 15px; margin-top: 15px; }
        .search-details h4 { margin-top: 0; color: #495057; }
        .search-details ul { margin: 10px 0; padding-left: 20px; }
        .search-details li { margin-bottom: 5px; color: #6c757d; }
        .search-details em { color: #6c757d; }
        .authority-result { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 0.85em; margin-right: 10px; }
        .authority-valid { background: #d4edda; color: #155724; }
        .authority-invalid { background: #f8d7da; color: #721c24; }
        
        /* JSON Tree View */
        .json-tree-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .json-tree-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .tree-container { border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; background: #fafafa; max-height: 600px; overflow-y: auto; font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono", monospace; }
        .expand-all-btn, .collapse-all-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; margin-right: 10px; margin-bottom: 15px; font-size: 0.9em; transition: transform 0.2s ease; }
        .expand-all-btn:hover, .collapse-all-btn:hover { transform: translateY(-1px); }
        
        /* Footer */
        .footer { text-align: center; padding: 20px; color: #666; font-size: 0.9em; background: white; border-radius: 10px; margin-top: 30px; }
        .footer a { color: #667eea; text-decoration: none; font-weight: 500; }
        .footer a:hover { text-decoration: underline; }
        
        /* Responsive */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .thumbnail { width: 150px; height: 225px; }
            .thumbnail-label { max-width: 150px; }
            .modal-nav { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>JP-API-FIX-TEST</h1>
        <p>üìö MARC Records generated by marcsnarc on 2025-12-23 14:08:24</p>
    </div>
    
    <div class='image-gallery'>

                <div class='thumbnail-container' onclick='openModal(0)'>
                    <img src='img_PXL_20251212_165802824.webp' alt='PXL_20251212_165802824.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165802824.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(1)'>
                    <img src='img_PXL_20251212_165807773.webp' alt='PXL_20251212_165807773.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165807773.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(2)'>
                    <img src='img_PXL_20251212_165816342.webp' alt='PXL_20251212_165816342.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165816342.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(3)'>
                    <img src='img_PXL_20251212_165825246.webp' alt='PXL_20251212_165825246.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165825246.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(4)'>
                    <img src='img_PXL_20251212_165855357.webp' alt='PXL_20251212_165855357.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165855357.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(5)'>
                    <img src='img_PXL_20251212_165928834.webp' alt='PXL_20251212_165928834.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165928834.jpg</div>
                </div>
                </div>

    
    <!-- Modal for image viewing -->
    <div id="imageModal" class="modal">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <button class="modal-nav modal-prev" onclick="changeImage(-1)">‚Äπ</button>
        <button class="modal-nav modal-next" onclick="changeImage(1)">‚Ä∫</button>
        <div class="modal-content">
            <img id="modalImage" class="modal-image" src="" alt="">
        </div>
        <div class="modal-counter" id="modalCounter"></div>
    </div>
    
    <div class="records-section">
        <h2>üìã MARC Records</h2>
        <div class='marc-record'>
<h3>Record 1</h3>
<div class='confidence'>Confidence: 0.57</div>
<div class='review-flag'>‚ö†Ô∏è Review Required</div>
<table><tr><th>LDR</th><td>00000nam a200000 Ki 500</td></tr><tr><th>001</th><td>msn20251223200823</td></tr><tr><th>003</th><td>DLC</td></tr><tr><th>005</th><td>20251223200823.0</td></tr><tr><th>008</th><td>251223s1937                o     00eng und d</td></tr><tr><th>040</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>DLC <span class="subfield-code">‚Ä°b</span>eng <span class="subfield-code">‚Ä°c</span>DLC <span class="subfield-code">‚Ä°e</span>rda </td></tr><tr><th>245</th><td><strong>00</strong> <span class="subfield-code">‚Ä°a</span>JP-API-FIX-TEST </td></tr><tr><th>264</th><td><strong>_1</strong> <span class="subfield-code">‚Ä°c</span>1937 </td></tr><tr><th>300</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>6 items (various formats) </td></tr><tr><th>520</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection consists of 2 books, 1 serials, 3 other items. Items date from 1937 to 1937. </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection-level record for 6 items </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Provenance: Extracted from 6 images using marcsnarc </td></tr><tr><th>561</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Extracted from 6 images using marcsnarc </td></tr><tr><th>999</th><td><strong>__</strong> <span class="subfield-code">‚Ä°i</span>Generated by marcsnarc on 2025-12-23 <span class="subfield-code">‚Ä°s</span>marcsnarc </td></tr></table></div>

    </div>
    
    <div class="api-results-section">
<h2>üåê External API Results</h2>
<div class="api-summary">
<p><strong>Search Summary:</strong> 2 item(s) searched across WorldCat, Library of Congress, and Alma catalogs</p>
</div>
<div class="api-no-results">
<div class="no-matches">External catalog searches were performed but no matches were found.</div>
<div class="search-details">
<p><strong>Search Status by Service:</strong></p>
<ul>
<li><strong>üìö WorldCat:</strong> Search attempted - likely failed due to server issues or no matches</li>
<li><strong>üèõÔ∏è Library of Congress:</strong> Authority validation performed</li>
<li><strong>üéì Alma Catalog:</strong> Local catalog searched</li>
</ul>
<p><em>Check the processing logs for detailed error messages.</em></p>
</div>
</div>
</div>

    
    
            <div class='json-tree-section'>
                <h2>üìä Analysis Data</h2>
                <div class='tree-container' id='analysis-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("analysis-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("analysis-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
            <div class='json-tree-section'>
                <h2>üìã Processing Metadata</h2>
                <div class='tree-container' id='metadata-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("metadata-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("metadata-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
    
    <div class="footer">
        Generated with <a href="https://github.com/anthropics/marcsnarc">marcsnarc</a> - AI-powered MARC cataloging
    </div>
    
    <script>
        // Global variables for modal and JSON data
        let currentImages = [];
        let currentImageIndex = 0;
        const analysisData = {"collection_analysis": {"item_count": 6, "formats": {"format_counts": {"periodical": 1, "pamphlet": 1, "note": 1, "periodical|pictorial magazine": 1, "book": 1, "magazine": 1}, "unique_formats": "{'book', 'pamphlet', 'periodical|pictorial magazine', 'note', 'periodical', 'magazine'}", "books": 2, "serials": 1, "ephemera": 0, "other": 3, "primary_format": "periodical"}, "creators": {"creator_counts": {"Âªñ‰∫ï‰∏π": 1}, "unique_creators": "{'Âªñ‰∫ï‰∏π'}", "items_with_creators": 1, "items_without_creators": 5, "dominant_creator": ["Âªñ‰∫ï‰∏π", 1]}, "dates": {"date_range": [1937, 1937], "earliest_date": 1937, "latest_date": 1937, "date_span": 0, "items_with_dates": 2, "date_counts": {"1937": 2}}, "languages": {"language_counts": {"japanese with english annotations": 1, "chi": 1, "eng": 2, "jpn": 1, "english with japanese/chinese romanization": 1}, "unique_languages": "{'eng', 'jpn', 'japanese with english annotations', 'chi', 'english with japanese/chinese romanization'}", "primary_language": "eng", "multilingual": true}, "subjects": {"subject_counts": {"Sino-Japanese War (1937-1945)": 1, "Japan-China relations": 1, "War photography": 1, "Military history": 1, "Propaganda": 1, "Manchu history": 1, "Manchu culture": 1, "Photography": 1, "Architecture": 1, "Signage": 1, "Labels": 1, "Office supplies": 1, "Sino-Japanese War": 1, "North China Incident": 1, "Military photography": 1, "War pictorial": 1, "Japanese military history": 1, "1937-1945": 1, "Japanese history": 1, "Puppet regimes": 1, "Burma": 1, "China": 1, "Osaka": 1, "World War II era": 1, "Chinese national government": 1, "Japanese ambassadors": 1, "Japan's war in greater East Asia": 1, "Front cover: Admiral Soemu Toyoda": 1, "Combined Fleet": 1, "Burma front": 1, "Admiral Mineichi Koga": 1, "Utzigawa123 via Ebay": 1}, "unique_subjects": "{'Chinese national government', 'Front cover: Admiral Soemu Toyoda', 'North China Incident', \"Japan's war in greater East Asia\", 'Sino-Japanese War (1937-1945)', 'Burma', 'Military photography', 'Sino-Japanese War', 'Puppet regimes', 'Japan-China relations', 'World War II era', 'Manchu culture', 'Combined Fleet', 'War pictorial', 'Photography', 'Admiral Mineichi Koga', 'Burma front', 'Osaka', 'Japanese military history', '1937-1945', 'War photography', 'Architecture', 'Manchu history', 'Signage', 'Propaganda', 'Labels', 'Japanese history', 'Utzigawa123 via Ebay', 'China', 'Japanese ambassadors', 'Military history', 'Office supplies'}", "items_with_subjects": 6, "common_subjects": [["Sino-Japanese War (1937-1945)", 1], ["Japan-China relations", 1], ["War photography", 1], ["Military history", 1], ["Propaganda", 1]], "subject_coherence": 2.6666666666666665}, "provenance": {"collection_provenance": "Extracted from 6 images using marcsnarc", "item_provenances": {}, "consistency_score": 1.0, "has_provenance": true}, "identifiers": {"items_with_isbn": 0, "items_with_issn": 0, "items_with_oclc": 0, "items_with_lccn": 0, "identifier_coverage": 0.0}, "physical_characteristics": {"extent_variety": 4, "dimension_variety": 3, "physical_coherence": 0.41666666666666663}, "format_diversity": 6, "creator_diversity": 1, "has_books_serials": true, "shared_provenance": true, "temporal_coherence": 1.0, "workflow_type": "collection_images_to_marc", "collection_name": "JP-API-FIX-TEST", "processing_timestamp": "2025-12-23T14:08:23.299421", "total_records": 1, "approach": "collection"}, "batch_analysis": {"collection_name": "JP-API-FIX-TEST", "total_images": 6, "successful_analyses": 6, "failed_analyses": 0, "individual_results": [{"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "extracted_data": {"title": "The Shina Jihen Gah≈ç (The China Incident Pictorial)", "publication_place": "Osaka and T≈çky≈ç", "publication_date": "1937-1939", "normalized_date": {"normalized": "1937", "end_date": "1939", "circa": false, "uncertain": false, "original": "1937-1939"}, "format": "periodical", "extent": "Multiple issues documented", "language": "japanese with english annotations", "original_script_title": "Japanese (Kanji and Kana)", "subjects": [{"heading": "Sino-Japanese War (1937-1945)", "type": "topical", "source": "claude_analysis"}, {"heading": "Japan-China relations", "type": "topical", "source": "claude_analysis"}, {"heading": "War photography", "type": "topical", "source": "claude_analysis"}, {"heading": "Military history", "type": "topical", "source": "claude_analysis"}, {"heading": "Propaganda", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This appears to be a bibliographic reference or catalog page describing issues of 'Shina Jihen Gah≈ç' (ÊîØÈÇ£‰∫ãÂ§âÁîªÂ†±), a Japanese war propaganda magazine", "source": "image_analysis"}, {"text": "Document lists multiple issues (Sh≈çwa 12-14) covering period from August 1937 to April 1939", "source": "image_analysis"}, {"text": "References specific cover features including soldiers, Japanese officers, Chinese child subjects, and military scenes", "source": "image_analysis"}, {"text": "Issues documented from early 2000s purchase (via eBay, $15 per issue)", "source": "image_analysis"}, {"text": "Contains descriptions of cover imagery showing soldiers in trenches, periscopes, military activities", "source": "image_analysis"}, {"text": "Notes mention illustrated magazine format with war photographs and civilian subjects", "source": "image_analysis"}, {"text": "Special issues noted covering Beijing hand embroidery, military campaigns, and supply wagon activities", "source": "image_analysis"}, {"text": "References both Shanghai and North China front coverage", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.2, "publication": 0.39, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.48425}, "overall_confidence": 0.48425, "claude_factors": {"text_clarity": "high", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "ÊîØÈÇ£‰∫ãÂ§âÁîªÂ†± Shina Jihen gah≈ç", "language": "Japanese with romanization", "location": "title section"}, {"text": "Âú∞ÂÆù‰∫¨Èò™Êñ∞Âç∞Âà∑Ê†™ÂºèÊúÉÁ§æ Osaka mai nichi, T≈çky≈ç nichi nichi", "language": "Japanese with English", "location": "publisher information"}, {"text": "ÊîØÈÇ£‰∫ãÂ§âË®òÂøµÂÜôÁúüÂ±ïË¶ß‰ºö Â•≥ÊîØÈÇ£Êà¶Â†¥ÂæìËªçË®òËÄÖÂÜôÂÆüÂèéË¶ß‰ºö", "language": "Japanese (Kanji)", "location": "publisher/exhibition details"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 1}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "extracted_data": {"title": "Ê±üÂüé", "creator": {"name": "Âªñ‰∫ï‰∏π", "type": "personal", "source": "claude_analysis", "romanization": "Liao Jingdan"}, "format": "pamphlet", "extent": "Single sheet/page", "language": "chi", "original_script_title": "Traditional Chinese characters", "subjects": [{"heading": "Manchu history", "type": "topical", "source": "claude_analysis"}, {"heading": "Manchu culture", "type": "topical", "source": "claude_analysis"}, {"heading": "Photography", "type": "topical", "source": "claude_analysis"}, {"heading": "Architecture", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document appears to be oriented for vertical reading (traditional Chinese format)", "source": "image_analysis"}, {"text": "Contains photographic images of buildings/architecture and a person", "source": "image_analysis"}, {"text": "Text includes what appears to be Manchu script in addition to Chinese characters", "source": "image_analysis"}, {"text": "Shows signs of age with discoloration and staining", "source": "image_analysis"}, {"text": "Contains mixed script - both Chinese characters and what appears to be Manchu vertical script", "source": "image_analysis"}, {"text": "Top margin contains dense text in smaller characters, possibly publication or editorial information", "source": "image_analysis"}, {"text": "The layout suggests this may be a magazine page or illustrated pamphlet", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.45499999999999996, "creator": 0.5249999999999999, "publication": 0.0, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.39449999999999996}, "overall_confidence": 0.39449999999999996, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Ê±üÂüé", "language": "Chinese", "location": "title area, right side"}, {"text": "ÁÄãÈôΩ„ÖáËàûÂ£á\nÁÄãÈôΩ„ÖáËàûÂ£á", "language": "Chinese with possible Korean characters", "location": "subtitle area, center-right"}, {"text": "Âªñ‰∫ï‰∏π", "language": "Chinese", "location": "left margin, vertical orientation"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 2}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "extracted_data": {"title": "Bathroom", "format": "note", "extent": "1 adhesive note", "dimensions": "approximately 76mm x 76mm (standard Post-it note size)", "language": "eng", "original_script_title": "Latin", "subjects": [{"heading": "Signage", "type": "topical", "source": "claude_analysis"}, {"heading": "Labels", "type": "topical", "source": "claude_analysis"}, {"heading": "Office supplies", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This is a light blue adhesive note (Post-it type) with handwritten text", "source": "image_analysis"}, {"text": "The text appears to read 'Bathroom' written in cursive/script handwriting", "source": "image_analysis"}, {"text": "The note is photographed on a wooden surface (appears to be oak or similar grain)", "source": "image_analysis"}, {"text": "This is not a bibliographic item but rather an ephemeral office supply item", "source": "image_analysis"}, {"text": "The writing appears to be done in blue ink", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.2, "publication": 0.0, "format": 0.5850000000000001, "language": 0.5850000000000001, "overall": 0.42575}, "overall_confidence": 0.42575, "claude_factors": {"text_clarity": "high", "completeness": "high", "language_certainty": "high"}, "original_text_regions": [{"text": "Bathroom", "language": "English", "location": "center of note"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 3}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "extracted_data": {"title": "ÂåóÊîØ‰∫ãÂ§âÁîªÂ†±", "publication_date": "Êò≠ÂíåÂçÅ‰∫åÂπ¥ (1937)", "normalized_date": {"normalized": "1937", "end_date": null, "circa": false, "uncertain": false, "original": "Êò≠ÂíåÂçÅ‰∫åÂπ¥ (1937)"}, "format": "periodical|pictorial magazine", "extent": "Single issue", "dimensions": "Approximately A4 or similar magazine format", "language": "jpn", "original_script_title": "Traditional Chinese characters (Kanji)", "other_identifiers": "Á¨¨‰∫åËºØ (Volume/Issue 2)", "subjects": [{"heading": "Sino-Japanese War", "type": "topical", "source": "claude_analysis"}, {"heading": "North China Incident", "type": "topical", "source": "claude_analysis"}, {"heading": "Military photography", "type": "topical", "source": "claude_analysis"}, {"heading": "War pictorial", "type": "topical", "source": "claude_analysis"}, {"heading": "Japanese military history", "type": "topical", "source": "claude_analysis"}, {"heading": "1937-1945", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Shows soldiers with helmets and rifles in combat or military position", "source": "image_analysis"}, {"text": "Black and white photography on cover", "source": "image_analysis"}, {"text": "Historical war pictorial magazine from the Second Sino-Japanese War period", "source": "image_analysis"}, {"text": "Cover depicts Japanese soldiers in field positions with bamboo vegetation", "source": "image_analysis"}, {"text": "Publication appears to be wartime propaganda or documentary material", "source": "image_analysis"}, {"text": "Shows signs of aging with discoloration and wear", "source": "image_analysis"}, {"text": "Additional text visible below title banner appears to provide publication details", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.2, "publication": 0.15166666666666667, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.38558333333333333}, "overall_confidence": 0.38558333333333333, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "ÂåóÊîØ‰∫ãÂ§âÁîªÂ†±", "language": "Japanese", "location": "title banner"}, {"text": "Êò≠ÂíåÂçÅ‰∫åÂπ¥", "language": "Japanese", "location": "left margin, publication date"}, {"text": "Á¨¨‰∫åËºØ", "language": "Japanese", "location": "left margin, issue number"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 4}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "extracted_data": {"title": "Bibliography or reference work containing entries about Japanese puppet regime and related topics", "publisher": "Multiple publishers referenced", "publication_place": "Multiple locations mentioned (Showa, Tokyo, etc.)", "publication_date": "References span 1940s-2000s", "normalized_date": {"normalized": null, "end_date": null, "circa": false, "uncertain": true, "original": "References span 1940s-2000s"}, "format": "book", "dimensions": "Standard letter size (approximately 8.5 x 11 inches)", "language": "english with japanese/chinese romanization", "original_script_title": "Latin script with romanized Chinese/Japanese terms", "other_identifiers": "Entry numbers visible: [1930], [1943], [1944] and others", "subjects": [{"heading": "Japanese history", "type": "topical", "source": "claude_analysis"}, {"heading": "Puppet regimes", "type": "topical", "source": "claude_analysis"}, {"heading": "Burma", "type": "topical", "source": "claude_analysis"}, {"heading": "China", "type": "topical", "source": "claude_analysis"}, {"heading": "Osaka", "type": "topical", "source": "claude_analysis"}, {"heading": "World War II era", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese national government", "type": "topical", "source": "claude_analysis"}, {"heading": "Japanese ambassadors", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This appears to be a page from a bibliography or reference work", "source": "image_analysis"}, {"text": "Contains multiple bibliographic entries with mixed English and romanized Chinese/Japanese text", "source": "image_analysis"}, {"text": "Entries include references to works about Japanese puppet regimes, diplomatic history, and wartime publications", "source": "image_analysis"}, {"text": "Multiple date ranges visible: Showa 14 (1939), Showa 15 (1940), 1943, 1944, 2000s", "source": "image_analysis"}, {"text": "References include publications from Tokyo, Osaka, and other locations", "source": "image_analysis"}, {"text": "Topics covered include the Burma puppet regime, Chinese collaborationist governments, and Japanese diplomatic activities", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.2, "publication": 0.45499999999999996, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.44625}, "overall_confidence": 0.44625, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Showa 14, August 5, no. 64. Anglo-Japanese talks in Tokyo. Cover of hierarchies go of behind a paint tree to celebrate establishment of a new government in China.", "language": "English", "location": "left column, first entry"}, {"text": "Showa 14, November 5, no. 76 Cover On the Jiangxi battlefront Down at Huihuchen.", "language": "English", "location": "left column"}, {"text": "Dai seisensho gaho Â§ßÊàêÊà¶ÂãùÁîªÂ†± [Osaka magazine]", "language": "English with Japanese", "location": "middle column"}, {"text": "Greater East Asia War: Pictorial. A continuation of the Silver Jubilee. Formal monthly illustrated magazine with the Tokyo rich main luminousing...", "language": "English", "location": "middle column"}, {"text": "Showa 8, 1944 (Showa 18), no. 28, 20 pp. including covers. [Trans: The Greater East Asia War: Pictorial] A long format monthly illustrated magazine...", "language": "English", "location": "right column"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 5}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg", "extracted_data": {"title": "T≈çky≈ç nichi nichi shinbunsha sen'y≈ç inkan Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æÂ∞ÇÁî®Âç∞Èëë", "subtitle": "A large format monthly illustrated magazine devoted to the news of Japan's war in greater East Asia", "publication_date": "early 2000s", "normalized_date": {"normalized": null, "end_date": null, "circa": false, "uncertain": true, "original": "early 2000s"}, "format": "magazine", "language": "eng", "original_script_title": "Latin alphabet with Japanese characters", "other_identifiers": "Total issues held: 19. Cataloged July, 2019.", "subjects": [{"heading": "Japan's war in greater East Asia", "type": "topical", "source": "claude_analysis"}, {"heading": "Front cover: Admiral Soemu Toyoda", "type": "topical", "source": "claude_analysis"}, {"heading": "Combined Fleet", "type": "topical", "source": "claude_analysis"}, {"heading": "Burma front", "type": "topical", "source": "claude_analysis"}, {"heading": "Admiral Mineichi Koga", "type": "topical", "source": "claude_analysis"}, {"heading": "Utzigawa123 via Ebay", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This appears to be a cataloging or descriptive note about a Japanese illustrated magazine from the early 2000s", "source": "image_analysis"}, {"text": "The text mentions this magazine includes photographs of Japan's war and covers various advertisements", "source": "image_analysis"}, {"text": "Contains references to Japanese military figures including Admiral Soemu Toyoda and Admiral Mineichi Koga", "source": "image_analysis"}, {"text": "The magazine was purchased from Utzigawa123 via Ebay", "source": "image_analysis"}, {"text": "Text appears to be rotated 90 degrees in the image", "source": "image_analysis"}, {"text": "This is a verso or back page with publication/acquisition information", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.2, "publication": 0.195, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.44525}, "overall_confidence": 0.44525, "claude_factors": {"text_clarity": "high", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æÂ∞ÇÁî®Âç∞Èëë", "language": "Japanese", "location": "body text"}, {"text": "T≈çky≈ç nichi nichi shinbunsha sen'y≈ç inkan Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æÂ∞ÇÁî®Âç∞Èëë. A large format monthly illustrated magazine devoted to the news of Japan's war in greater East Asia. Includes a day by day summary of the month's news. Photographs are b&w only. Rear covers are advertisements. Contents: front cover: Admiral Soemu Toyoda, commander of the Combined Fleet, standing on the bridge, India! Burma front. Scenes in Bagainville. Death of Admiral Mineichi Koga, commander of the combined fleet. Loyang Condition: Excellent. Disbound, with four small holes punctured along edge, purchased from Utzigawa123 via Ebay in the early 2000s.", "language": "English", "location": "body text"}, {"text": "++++++++ Total issues held: 19. Cataloged July, 2019.", "language": "English", "location": "cataloging note"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 6}], "collection_analysis": {"total_items": 6, "successful_extractions": 6, "common_characteristics": {"primary_language": "eng", "language_distribution": {"japanese with english annotations": 1, "chi": 1, "eng": 2, "jpn": 1, "english with japanese/chinese romanization": 1}, "primary_format": "periodical", "format_distribution": {"periodical": 1, "pamphlet": 1, "note": 1, "periodical|pictorial magazine": 1, "book": 1, "magazine": 1}, "publishers": {"Multiple publishers referenced": 1}}, "quality_assessment": {"average_confidence": 0.43026388888888883, "high_confidence_items": 0, "low_confidence_items": 6, "confidence_range": [0.38558333333333333, 0.48425]}, "recommendations": ["More than 30% of items have low confidence - consider manual review", "Multiple languages detected - verify language coding", "6 items contain CJK characters - verify romanization"]}, "batch_confidence": 0.43026388888888883, "processing_timestamp": "2025-12-23T14:08:22.795815"}, "individual_extractions": [{"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "extraction_confidence": 0.48425, "extracted_fields": ["title", "publication_place", "publication_date", "normalized_date", "format", "extent", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "extraction_confidence": 0.39449999999999996, "extracted_fields": ["title", "creator", "format", "extent", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "extraction_confidence": 0.42575, "extracted_fields": ["title", "format", "extent", "dimensions", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "extraction_confidence": 0.38558333333333333, "extracted_fields": ["title", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "extraction_confidence": 0.44625, "extracted_fields": ["title", "publisher", "publication_place", "publication_date", "normalized_date", "format", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg", "extraction_confidence": 0.44525, "extracted_fields": ["title", "subtitle", "publication_date", "normalized_date", "format", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}], "external_api_results": [{"worldcat": [], "loc": [], "alma": [], "best_match": null}]};
        const metadataData = {"workflow_type": "collection_images_to_marc", "collection_name": "JP-API-FIX-TEST", "processing_result": {"approach": "collection", "records_generated": 1, "review_required": true, "groupings": {"approach": "collection", "total_items": 6, "groups": [{"type": "collection", "items": ["The Shina Jihen Gah≈ç (The China Incident Pictorial)", "Ê±üÂüé", "Bathroom", "ÂåóÊîØ‰∫ãÂ§âÁîªÂ†±", "Bibliography or reference work containing entries about Japanese puppet regime and related topics", "T≈çky≈ç nichi nichi shinbunsha sen'y≈ç inkan Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æÂ∞ÇÁî®Âç∞Èëë"], "record_type": "collection"}]}}, "collection_data": {"total_items": 6, "source_images": ["examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg"], "provenance": "Extracted from 6 images using marcsnarc"}, "batch_analysis_summary": {"total_images": 6, "successful_analyses": 6, "batch_confidence": 0.43026388888888883}, "processing_timestamp": "2025-12-23T14:08:23.299431"};
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize images array from gallery
            const thumbnails = document.querySelectorAll('.thumbnail');
            currentImages = Array.from(thumbnails).map(img => ({
                src: img.src,
                alt: img.alt
            }));
            
            // Initialize JSON trees
            if (analysisData && Object.keys(analysisData).length > 0) {
                renderJsonTree('analysis-tree', analysisData);
            }
            if (metadataData && Object.keys(metadataData).length > 0) {
                renderJsonTree('metadata-tree', metadataData);
            }
        });
        
        // Modal functions
        function openModal(index) {
            currentImageIndex = index;
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const counter = document.getElementById('modalCounter');
            
            if (currentImages[index]) {
                modalImage.src = currentImages[index].src;
                modalImage.alt = currentImages[index].alt;
                counter.textContent = `${index + 1} of ${currentImages.length}`;
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function changeImage(direction) {
            currentImageIndex = (currentImageIndex + direction + currentImages.length) % currentImages.length;
            openModal(currentImageIndex);
        }
        
        // Keyboard controls
        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'block') {
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft') changeImage(-1);
                if (e.key === 'ArrowRight') changeImage(1);
            }
        });
        
        // Close modal on background click
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        // JSON Tree rendering functions
        function renderJsonTree(containerId, data) {
            const container = document.getElementById(containerId);
            if (!container || !data) return;
            
            container.innerHTML = '';
            const tree = createTreeElement(data, '', 0);
            container.appendChild(tree);
        }
        
        function createTreeElement(value, key, level) {
            const wrapper = document.createElement('div');
            wrapper.style.marginLeft = `${level * 20}px`;
            wrapper.style.marginBottom = '3px';
            
            if (value && typeof value === 'object' && !Array.isArray(value)) {
                // Object
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                Object.entries(value).forEach(([childKey, childValue]) => {
                    children.appendChild(createTreeElement(childValue, childKey, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìÇ ${key} {${Object.keys(value).length}}</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else if (Array.isArray(value)) {
                // Array
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                value.forEach((item, index) => {
                    children.appendChild(createTreeElement(item, `[${index}]`, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìñ ${key} [${value.length}]</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else {
                // Primitive value
                const element = document.createElement('div');
                const valueStr = value === null ? 'null' : String(value);
                const valueType = typeof value;
                let color = '#4a5568';
                let icon = 'üìÑ';
                
                if (valueType === 'string') { color = '#38a169'; icon = 'üìù'; }
                else if (valueType === 'number') { color = '#d69e2e'; icon = 'üî¢'; }
                else if (valueType === 'boolean') { color = '#9f7aea'; icon = '‚úÖ'; }
                else if (value === null) { color = '#a0aec0'; icon = '‚ùå'; }
                
                element.innerHTML = `<span style="color: #2d3748; font-weight: 600;">${icon} ${key}:</span> <span style="color: ${color};">${valueType === 'string' ? '"' + valueStr + '"' : valueStr}</span>`;
                wrapper.appendChild(element);
            }
            
            return wrapper;
        }
        
        function expandAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñ∂')) {
                    span.parentElement.click();
                }
            });
        }
        
        function collapseAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñº')) {
                    span.parentElement.click();
                }
            });
        }
    </script>
</body>
</html>