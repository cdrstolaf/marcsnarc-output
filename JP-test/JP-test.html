<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>JP-test - MARC Records</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; line-height: 1.6; background: #fafafa; }
        
        /* Header */
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 2em; font-weight: 300; }
        .header p { margin: 10px 0 0; opacity: 0.9; }
        
        /* Image Gallery */
        .image-gallery { display: flex; gap: 15px; overflow-x: auto; padding: 20px 0; margin-bottom: 30px; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .thumbnail-container { flex-shrink: 0; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .thumbnail-container:hover { transform: scale(1.02); box-shadow: 0 4px 15px rgba(0,0,0,0.15); }
        .thumbnail { width: 200px; height: 300px; object-fit: cover; border-radius: 8px; border: 3px solid #e0e0e0; transition: border-color 0.2s ease; }
        .thumbnail-container:hover .thumbnail { border-color: #667eea; }
        .thumbnail-label { text-align: center; margin-top: 8px; font-size: 0.85em; color: #666; font-weight: 500; word-break: break-word; max-width: 200px; }
        .no-images { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 90vw; max-height: 90vh; }
        .modal-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .modal-close { position: absolute; top: 15px; right: 20px; color: white; font-size: 30px; font-weight: bold; cursor: pointer; z-index: 1001; width: 40px; height: 40px; border-radius: 50%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .modal-close:hover { background: rgba(255,0,0,0.7); }
        .modal-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.5); color: white; border: none; padding: 15px 20px; font-size: 18px; cursor: pointer; border-radius: 5px; transition: background 0.2s ease; }
        .modal-nav:hover { background: rgba(0,0,0,0.8); }
        .modal-prev { left: 20px; }
        .modal-next { right: 20px; }
        .modal-counter { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: white; background: rgba(0,0,0,0.7); padding: 8px 16px; border-radius: 20px; font-size: 14px; }
        
        /* MARC Records */
        .records-section h2 { color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; margin: 30px 0 20px; }
        .marc-record { background: white; border: none; margin-bottom: 25px; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .marc-record h3 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .confidence { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); padding: 6px 12px; border-radius: 20px; display: inline-block; margin-bottom: 15px; color: #2c5530; font-weight: 500; font-size: 0.9em; }
        .review-flag { background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); border: none; color: #d63031; padding: 6px 12px; border-radius: 20px; margin-bottom: 15px; font-weight: 500; font-size: 0.9em; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 5px rgba(0,0,0,0.05); }
        th, td { padding: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #f0f0f0; }
        th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; width: 100px; }
        .subfield-code { font-weight: bold; color: #667eea; background: #f8f9ff; padding: 2px 4px; border-radius: 3px; margin-right: 5px; }
        .no-records { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* External API Results */
        .api-results-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .api-results-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .api-summary { background: #f8f9ff; border: 1px solid #e0e6ff; border-radius: 6px; padding: 12px; margin-bottom: 20px; }
        .api-summary p { margin: 0; color: #333; font-size: 0.95em; }
        .api-source { margin-bottom: 20px; }
        .api-source h3 { color: #667eea; margin-bottom: 10px; font-size: 1.1em; }
        .api-matches { background: #f8f9ff; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .api-match { background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 10px; margin-bottom: 10px; }
        .api-match:last-child { margin-bottom: 0; }
        .match-title { font-weight: 600; color: #333; margin-bottom: 5px; }
        .match-author { color: #666; margin-bottom: 5px; }
        .match-details { font-size: 0.9em; color: #888; }
        .no-matches { text-align: center; padding: 20px; color: #999; font-style: italic; }
        .api-no-results { }
        .search-details { background: #f8f9fa; border-radius: 6px; padding: 15px; margin-top: 15px; }
        .search-details h4 { margin-top: 0; color: #495057; }
        .search-details ul { margin: 10px 0; padding-left: 20px; }
        .search-details li { margin-bottom: 5px; color: #6c757d; }
        .search-details em { color: #6c757d; }
        .authority-result { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 0.85em; margin-right: 10px; }
        .authority-valid { background: #d4edda; color: #155724; }
        .authority-invalid { background: #f8d7da; color: #721c24; }
        
        /* JSON Tree View */
        .json-tree-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .json-tree-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .tree-container { border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; background: #fafafa; max-height: 600px; overflow-y: auto; font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono", monospace; }
        .expand-all-btn, .collapse-all-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; margin-right: 10px; margin-bottom: 15px; font-size: 0.9em; transition: transform 0.2s ease; }
        .expand-all-btn:hover, .collapse-all-btn:hover { transform: translateY(-1px); }
        
        /* Footer */
        .footer { text-align: center; padding: 20px; color: #666; font-size: 0.9em; background: white; border-radius: 10px; margin-top: 30px; }
        .footer a { color: #667eea; text-decoration: none; font-weight: 500; }
        .footer a:hover { text-decoration: underline; }
        
        /* Responsive */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .thumbnail { width: 150px; height: 225px; }
            .thumbnail-label { max-width: 150px; }
            .modal-nav { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>JP-test</h1>
        <p>üìö MARC Records generated by marcsnarc on 2025-12-23 16:33:09</p>
    </div>
    
    <div class='image-gallery'>

                <div class='thumbnail-container' onclick='openModal(0)'>
                    <img src='img_PXL_20251212_165802824.webp' alt='PXL_20251212_165802824.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165802824.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(1)'>
                    <img src='img_PXL_20251212_165807773.webp' alt='PXL_20251212_165807773.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165807773.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(2)'>
                    <img src='img_PXL_20251212_165816342.webp' alt='PXL_20251212_165816342.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165816342.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(3)'>
                    <img src='img_PXL_20251212_165825246.webp' alt='PXL_20251212_165825246.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165825246.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(4)'>
                    <img src='img_PXL_20251212_165855357.webp' alt='PXL_20251212_165855357.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165855357.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(5)'>
                    <img src='img_PXL_20251212_165928834.webp' alt='PXL_20251212_165928834.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165928834.jpg</div>
                </div>
                </div>

    
    <!-- Modal for image viewing -->
    <div id="imageModal" class="modal">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <button class="modal-nav modal-prev" onclick="changeImage(-1)">‚Äπ</button>
        <button class="modal-nav modal-next" onclick="changeImage(1)">‚Ä∫</button>
        <div class="modal-content">
            <img id="modalImage" class="modal-image" src="" alt="">
        </div>
        <div class="modal-counter" id="modalCounter"></div>
    </div>
    
    <div class="records-section">
        <h2>üìã MARC Records</h2>
        <div class='marc-record'>
<h3>Record 1</h3>
<div class='confidence'>Confidence: 0.54</div>
<div class='review-flag'>‚ö†Ô∏è Review Required</div>
<table><tr><th>LDR</th><td>00000nam a200000 Ki 500</td></tr><tr><th>001</th><td>msn20251223223308</td></tr><tr><th>003</th><td>DLC</td></tr><tr><th>005</th><td>20251223223308.0</td></tr><tr><th>008</th><td>251223m19392019            o     00und und d</td></tr><tr><th>040</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>DLC <span class="subfield-code">‚Ä°b</span>eng <span class="subfield-code">‚Ä°c</span>DLC <span class="subfield-code">‚Ä°e</span>rda </td></tr><tr><th>245</th><td><strong>00</strong> <span class="subfield-code">‚Ä°a</span>JP-test </td></tr><tr><th>264</th><td><strong>_1</strong> <span class="subfield-code">‚Ä°c</span>1939 </td></tr><tr><th>300</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>6 items (various formats) </td></tr><tr><th>520</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection consists of 5 books, 1 other items. Items date from 1939 to 2019. </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection-level record for 6 items </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Provenance: Extracted from 6 images using marcsnarc </td></tr><tr><th>561</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Extracted from 6 images using marcsnarc </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Textbooks </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Cutout animation films </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Southern brown bandicoot </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Paper Product </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Puzzles and games </td></tr><tr><th>999</th><td><strong>__</strong> <span class="subfield-code">‚Ä°i</span>Generated by marcsnarc on 2025-12-23 <span class="subfield-code">‚Ä°s</span>marcsnarc </td></tr></table></div>

    </div>
    
    <div class="api-results-section">
<h2>üåê External API Results</h2>
<div class="api-summary">
<p><strong>Search Summary:</strong> 2 item(s) searched across WorldCat, Library of Congress, and Alma catalogs</p>
</div>
<div class="api-source"><h3>Record 1</h3>
<div class="api-source">
<h3>üèõÔ∏è Library of Congress Authority Validation</h3>
<div class="api-matches">
<div class="api-match">
<div class="match-title">subject_authority: Text</div>
<span class="authority-result authority-valid">‚úÖ Valid</span>
<div class="match-details">Authorized form: Textbooks</div>
</div>
<div class="api-match">
<div class="match-title">subject_authority: Paper</div>
<span class="authority-result authority-valid">‚úÖ Valid</span>
<div class="match-details">Authorized form: Cutout animation films</div>
</div>
<div class="api-match">
<div class="match-title">subject_authority: Brown</div>
<span class="authority-result authority-valid">‚úÖ Valid</span>
<div class="match-details">Authorized form: Southern brown bandicoot</div>
</div>
</div>
</div>
</div>
<div class="api-source"><h3>Record 2</h3>
<div class="api-source">
<h3>üèõÔ∏è Library of Congress Authority Validation</h3>
<div class="api-matches">
<div class="api-match">
<div class="match-title">subject_authority: Text</div>
<span class="authority-result authority-valid">‚úÖ Valid</span>
<div class="match-details">Authorized form: Textbooks</div>
</div>
<div class="api-match">
<div class="match-title">subject_authority: Paper</div>
<span class="authority-result authority-valid">‚úÖ Valid</span>
<div class="match-details">Authorized form: Cutout animation films</div>
</div>
<div class="api-match">
<div class="match-title">subject_authority: Brown</div>
<span class="authority-result authority-valid">‚úÖ Valid</span>
<div class="match-details">Authorized form: Southern brown bandicoot</div>
</div>
</div>
</div>
</div>
</div>

    
    
            <div class='json-tree-section'>
                <h2>üìä Analysis Data</h2>
                <div class='tree-container' id='analysis-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("analysis-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("analysis-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
            <div class='json-tree-section'>
                <h2>üìã Processing Metadata</h2>
                <div class='tree-container' id='metadata-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("metadata-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("metadata-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
    
    <div class="footer">
        Generated with <a href="https://github.com/anthropics/marcsnarc">marcsnarc</a> - AI-powered MARC cataloging
    </div>
    
    <script>
        // Global variables for modal and JSON data
        let currentImages = [];
        let currentImageIndex = 0;
        const analysisData = {"collection_analysis": {"item_count": 6, "formats": {"format_counts": {"book": 5, "text": 1}, "unique_formats": "{'text', 'book'}", "books": 5, "serials": 0, "ephemera": 0, "other": 1, "primary_format": "book"}, "creators": {"creator_counts": {"Guinea, Draft": 1}, "unique_creators": "{'Guinea, Draft'}", "items_with_creators": 1, "items_without_creators": 5, "dominant_creator": ["Guinea, Draft", 1]}, "dates": {"date_range": [1939, 2019], "earliest_date": 1939, "latest_date": 2019, "date_span": 80, "items_with_dates": 3, "date_counts": {"1939": 1, "1944": 1, "2019": 1}}, "languages": {"language_counts": {"und": 6}, "unique_languages": "{'und'}", "primary_language": "und", "multilingual": false}, "subjects": {"subject_counts": {"Photograph": 1, "Text": 4, "Paper": 4, "Brown": 3, "Number": 2, "Blue": 1, "Paper Product": 3, "Orange": 1, "Office Supplies": 1, "Military Person": 1, "Soldier": 1, "Military Uniform": 1, "Marines": 1, "Uniform": 1}, "unique_subjects": "{'Military Person', 'Photograph', 'Text', 'Blue', 'Paper', 'Brown', 'Paper Product', 'Orange', 'Office Supplies', 'Military Uniform', 'Number', 'Soldier', 'Marines', 'Uniform'}", "items_with_subjects": 6, "common_subjects": [["Text", 4], ["Paper", 4], ["Brown", 3], ["Paper Product", 3], ["Number", 2]], "subject_coherence": 2.261904761904762}, "provenance": {"collection_provenance": "Extracted from 6 images using marcsnarc", "item_provenances": {}, "consistency_score": 1.0, "has_provenance": true}, "identifiers": {"items_with_isbn": 0, "items_with_issn": 0, "items_with_oclc": 0, "items_with_lccn": 0, "identifier_coverage": 0.0}, "physical_characteristics": {"extent_variety": 0, "dimension_variety": 0, "physical_coherence": 1.0}, "format_diversity": 2, "creator_diversity": 1, "has_books_serials": true, "shared_provenance": true, "temporal_coherence": 0.2, "workflow_type": "collection_images_to_marc", "collection_name": "JP-test", "processing_timestamp": "2025-12-23T16:33:09.559793", "total_records": 1, "approach": "collection"}, "batch_analysis": {"collection_name": "JP-test", "total_images": 6, "successful_analyses": 6, "failed_analyses": 0, "individual_results": [{"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "extracted_data": {"title": "Osaka mai nichi, Tokyo nichi nichi", "creator": {}, "publication_date": "1939", "language": "und", "subjects": [{"heading": "Photograph", "type": "topical", "source": "google_vision_labels", "confidence": 0.9880674}, {"heading": "Text", "type": "topical", "source": "google_vision_labels", "confidence": 0.95225686}, {"heading": "Paper", "type": "topical", "source": "google_vision_labels", "confidence": 0.9384071}, {"heading": "Brown", "type": "topical", "source": "google_vision_labels", "confidence": 0.925735}, {"heading": "Number", "type": "topical", "source": "google_vision_labels", "confidence": 0.9151796}], "format": "book", "isbn": "", "raw_text": "Osaka mai nichi, Tokyo nichi nichi\nTitle: Shina jihen gah≈ç [The China Incident Pictorial]\nPublisher: Osaka mai nichi Shimbun sha, Tokyo nichi nichi Shimbun\nsha\nThe Shina Jihen Gaho is a large format b&w photo illustrated magazine devoted to the war in China,\nissued every ten to fifteen days. Front covers are full page photos, and the interior pages include some\nphotos printed across a two-page spread. Photos are sometimes ambro tinted. Includes substantial\narticles and a day by day summary of war news as well. Photos include many scenes of daily life in China,\nin addition to photos of Japanese military and civilian leaders, Chinese collaborators, soldiers in the field,\netc. Inside front cover is often a map. Rear cover is a large advertisement. 30-32 pp. including covers.\nNote: The first three issues bear an alternate title: Hokushi jihen gah≈ç [North China\nIncident Pictorial]\nCondition: Generally very good, but covers are brittle and tear easily. Purchased in the early 2000s from\nUtagawa123 via Ebay, for ca. $15 per issue.\nHoldings:\n[1937]\nShowa 12, August 3rd, no. 1 Cover: Soldiers in the trench, using a periscope.\nShowa 12, August 30, no. 3. Special issue on the war in Shanghai. Cover: Japanese sniper on a rooftop.\nShowa 12, October 21, no. 7. Cover: a soldier climbs through a hole in a brick wall.\n[1938]\nShowa 13, February 11, no. 18. Cover: Policeman directing traffic at an intersection in the snow.\nShowa 13, February 21, no. 19. Cover: Japanese officer and Chinese child salute each other.\nShowa 13, March 11, no. 21. Cover: Japanese bugler sounding reveille.\nShowa 13, September 1, no. 38. Cover: Young woman in Peking doing hand embroidery.\n[1939]\nShowa 14, March 5, no. 54. Cover: Two men saw a log into planks.\nShowa 14, April 5, no, 56, Cover: A group of army supply wagons drawn by mules cross a rapid stream.\nShowa 14, April 20, no. 57. Special issue on the Nanchang campaign. Cover: Soldiers wearing headbands\nof the 'imperial renewal corps' put up propaganda posters about 'peace in East Asia.'\nShowa 14, July 5, no. 62, Special issue on commencing the third year of the holy war, and the campaign\nfor Swatow. Cover: Landing craft at Swatow with air support.", "notes": [{"text": "Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION", "source": "google_vision"}], "extraction_source": "google_vision", "title_source": "google_vision", "creator_source": "google_vision", "publication_source": "google_vision"}, "confidence_scores": {"title": 0.7804983637333334, "creator": 0.7804983637333334, "publication": 0.7804983637333334, "format": 0.7804983637333334, "language": 0.7804983637333334, "overall": 0.7804983637333334}, "overall_confidence": 0.7804983637333334, "processing_notes": ["Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION"], "review_required": false}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "extracted_data": {"title": "", "creator": {}, "publication_date": "", "language": "und", "subjects": [{"heading": "Text", "type": "topical", "source": "google_vision_labels", "confidence": 0.9505441}], "format": "book", "isbn": "", "raw_text": "ÈÖíÂÜ∑„ÅÆÁîü„Åæ\nÁÑ°Êïµ„ÅÆÁöáËªç\nÁÑ°Êïµ„ÅÆÂø†Âãá\n‰∏ÄÂ∫¶„ÅÆÁÅ´ÂÖ•„Çå„ÇÇ„Åõ„Åö„Å´\nÁ¥îÁîü„ÅÆ„ÅæÂÖÖÂàÜÂÆåÂÇô„Åó\nÂºäÁç®Âæó„ÅÆÂÜ∑ËîµÂ∫´„Åß\nË≤ØËîµ„Åó„Åü„ÇÇ„ÅÆ„Åß„Åô„Åã„Çâ\nÁµ∂Â∞ç„Å´Ë≥™„ÅÆÊá∏Âøµ„ÅØ„ÅÇ\n„Çä„Åæ„Åõ„Çì\nÂæ°Âá∫ÂæÅ„ÅÆ„ÅäÁ•ù„Å≤„Å´\nÂæ°‰∏≠ÂÖÉ„ÅÆÂæ°Á•ùÂÑÄ„Å´\n‰Ωï„Çà„Çä„ÅÆË¥àÁâ©„Åß„Åô\nÂæ°‰∏≠ÂÖÉÁî®„Å´„ÅØÁæé„Åó„ÅÑÂåñÁ≤ßÂáΩÂÖ•„ÅÆÂêÑÁ®Æ\nÁôæË≤®Â∫ó‰∏ÄÊµÅÈÖíÂ∫ó„Å´Âæ°Â∫ß„ÅÑ„Åæ„Åô\nÈÖí„ÅÆ\n‰∏çË®±Ë§áË£Ω\nÊò≠ÂíåÂçÅ‰∫åÂπ¥‰∏ÉÊúàÂªø‰πùÊó•Âç∞Âà∑\nÊò≠ÂíåÂçÅ‰∫åÂπ¥ÂÖ´ÊúàÊó•ÁôºË°å\n„ÄîÂÆöÂÉπË≤≥ÊãæÈå¢„Äï\nÂ§ßÈò™Â∫úÂ∏ÉÂ∏ÇÂ∞èÈò™Áî∫‰∏≠Â∞èÈò™ÂÖ´‰∏âÂÖ≠\nÁü≥Âéü\nÁôºË°åË±°Âç∞Âà∑‰∫∫\nÂ§ßÈò™Â∏ÇÂåóÂçÄÂ†ÇÂ≥∂‰∏ä‰∫å‰∏ÅÁõÆ‰∏âÂ§ß\nÁôºË°åÊâÄ\nÂç∞Âà∑Ê†™Âºè‰ºöÁ§æÂ§ßÈò™ÊØéÊó•Êñ∞ËÅûÁ§æ\nÂ§ßÈò™Â∏ÇÂåóÈ¢®Â†ÇÂ≥∂ Â§ßÈò™ÊØéÊó•Êñ∞ËÅûÁ§æ\nÊù±‰∫¨Â∏Ç‰∏∏„ÉéÂÜÖ Êù±‰∫¨ Êñ∞ËÅûÁ§æ\nÈáÄÊûóËã•ÁÅò", "notes": [{"text": "Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION", "source": "google_vision"}], "extraction_source": "google_vision", "title_source": "google_vision", "creator_source": "google_vision", "publication_source": "google_vision"}, "confidence_scores": {"title": 0.5138672755714285, "creator": 0.5138672755714285, "publication": 0.5138672755714285, "format": 0.5138672755714285, "language": 0.5138672755714285, "overall": 0.5138672755714285}, "overall_confidence": 0.5138672755714285, "processing_notes": ["Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION"], "review_required": true}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "extracted_data": {"title": "", "creator": {}, "publication_date": "", "language": "und", "subjects": [{"heading": "Blue", "type": "topical", "source": "google_vision_labels", "confidence": 0.988218}, {"heading": "Paper Product", "type": "topical", "source": "google_vision_labels", "confidence": 0.92649895}, {"heading": "Paper", "type": "topical", "source": "google_vision_labels", "confidence": 0.91267544}, {"heading": "Orange", "type": "topical", "source": "google_vision_labels", "confidence": 0.88566923}, {"heading": "Office Supplies", "type": "topical", "source": "google_vision_labels", "confidence": 0.79593533}], "format": "text", "isbn": "", "raw_text": "Badman I", "notes": [{"text": "Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION", "source": "google_vision"}], "extraction_source": "google_vision", "title_source": "google_vision", "creator_source": "google_vision", "publication_source": "google_vision"}, "confidence_scores": {"title": 0.38397449999999994, "creator": 0.38397449999999994, "publication": 0.38397449999999994, "format": 0.38397449999999994, "language": 0.38397449999999994, "overall": 0.38397449999999994}, "overall_confidence": 0.38397449999999994, "processing_notes": ["Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION"], "review_required": true}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "extracted_data": {"title": "ÂèØË®±ÈÉ®‰ª§Âè∏ËªçÂ±ØÈßêÈÇ£ÊîØ,ÂèØË®±ÁúÅËªçÈô∏", "creator": {}, "publication_date": "", "language": "und", "subjects": [{"heading": "Military Person", "type": "topical", "source": "google_vision_labels", "confidence": 0.9500629}, {"heading": "Soldier", "type": "topical", "source": "google_vision_labels", "confidence": 0.9070003}, {"heading": "Military Uniform", "type": "topical", "source": "google_vision_labels", "confidence": 0.88634664}, {"heading": "Marines", "type": "topical", "source": "google_vision_labels", "confidence": 0.87266743}, {"heading": "Uniform", "type": "topical", "source": "google_vision_labels", "confidence": 0.87067235}], "format": "book", "isbn": "", "raw_text": "Â†±ÁîªÂèò‰∫ãÊîØÂåó\nÂèØË®±ÈÉ®‰ª§Âè∏ËªçÂ±ØÈßêÈÇ£ÊîØ,ÂèØË®±ÁúÅËªçÈô∏\nG\nÊò≠ÂíåÂçÅ‰∫åÂπ¥ÂÖ´Êúà‰∏âÊó•ÁôºË°å\nÂÆöÂÉπ ‰∏ÄÈÉ®Èáë„ÄÅ‰∫åÂçÅ1Èå¢\nÁôºË°åÊâÄ Â§ß Èò™ÊØèÊó•Êñ∞ËÅûÁ§æ\nÊù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æ", "notes": [{"text": "Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION", "source": "google_vision"}], "extraction_source": "google_vision", "title_source": "google_vision", "creator_source": "google_vision", "publication_source": "google_vision"}, "confidence_scores": {"title": 0.5609915877999999, "creator": 0.5609915877999999, "publication": 0.5609915877999999, "format": 0.5609915877999999, "language": 0.5609915877999999, "overall": 0.5609915877999999}, "overall_confidence": 0.5609915877999999, "processing_notes": ["Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION"], "review_required": true}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "extracted_data": {"title": "Showa 14, August 5, no. 64. Anglo-Japanese talks in Tokyo. Cover: Firecrackers go off behind a palm tree", "creator": {"name": "Guinea, Draft", "type": "personal", "source": "google_vision"}, "publication_date": "1944", "language": "und", "subjects": [{"heading": "Paper", "type": "topical", "source": "google_vision_labels", "confidence": 0.9554043}, {"heading": "Text", "type": "topical", "source": "google_vision_labels", "confidence": 0.94651103}, {"heading": "Brown", "type": "topical", "source": "google_vision_labels", "confidence": 0.92268074}, {"heading": "Paper Product", "type": "topical", "source": "google_vision_labels", "confidence": 0.90446234}, {"heading": "Number", "type": "topical", "source": "google_vision_labels", "confidence": 0.8457631}], "format": "book", "isbn": "", "raw_text": "Showa 14, August 5, no. 64. Anglo-Japanese talks in Tokyo. Cover: Firecrackers go off behind a palm tree\nto celebrate establishment of a new government on Hainan island.\nShowa 14, November 5, no. 70. Cover: On the Jiangxi battlefront. Dawn at Jiulingshan.\n[1940]\nShowa 15, April 5, no. 80. Special issue on the formation of a new Chinese national government under\nWang Jingwei in Nanjing. Cover: celebratory arch in Shanghai.\nShowa 15, April 20, no. 81. Special section: The war in Europe. Cover: Japanese ambassador Abe on the\ndeck of the Kagoshima-maru on his way to Nanjing.\nShowa 15, December 8, no. 101. Now a monthly. Cover: naval exercise in the central China sea. Section\non Japan in French Indo-China. Rear cover torn.\n[1943]\n(Note new title)\nSuko Kiyoshi, ed., Dai t≈ça sens≈ç gah≈ç ≈åsaka : ≈åsaka mainichi\nshimbunsha, September 8, 1943 (Showa 18), no. 22. 20 pp. including covers. [Trans: The\nGreater East Asia War Pictorial] A continuation of the Shina jihen gah≈ç . Published jointly\nwith the T≈çky≈ç nichi nichi shimbunsha. A large format monthly illustrated magazine\ndevoted to the news of Japan's war in greater East Asia. Includes a day by day summary of the month's\nnews. Photographs are b&w only. Rear covers are advertisements. Contents: Special issue on Burmese\nindependence. Front cover: Ba Maw, head of the Japanese puppet regime in Burma after its declaration\nof independence. Other articles feature the fighting in the Solomon Islands, and the elimination of the\nInternational Concession in Shanghai. Condition: Excellent. Purchased from Utagawa123 via Ebay in the\nearly 2000s.\nSuko Kiyoshi, ed., Dai t≈ça sens≈ç gah≈ç, Osaka Osaka mainichi\nshimbunsha, October 8, 1943 (Showa 18), no. 23. 20 pp. including covers. [Trans: The\nGreater East Asia War Pictorial] A continuation of the Shina jihen gah≈ç . Published jointly\nwith the T≈çky≈ç nichi nichi shimbunshat. A large format monthly illustrated magazine\ndevoted to the news of Japan's war in greater East Asia. Includes a day by day summary of the month's\nnews. Photographs are b&w only. Rear covers are advertisements. Contents: Front cover: Japanese\npilot in flight gear holding up a puppy. Articles: Fighting in New Guinea, Draft constitution for the\nPhilippines. Our forces occupy Kiska Island in the Aleutians. Life of aboriginal peoples in New Guinea.\nSoldiers at leisure, Italian surrender. Repatriation of Western internees on the Teia Maru. Condition:\nExcellent. Purchased from Utagawa123 via Ebay in the early 2000s,\n[1944]\nSuko Kiyoshi È†àÂè§Ê∏Ö, ed., Dai t√≥a senso gah≈ç Â§ßÊù±‰∫ûÊà∞Áà≠Áï´Â†±, Osaka Â§ßÈò™Osaka mainichi\nshimbunsha, June 8, 1944 (Showa 19), no. 31. 16 pp. including covers. [Trans: The Greater\nEast Asia War Pictorial] A continuation of the Shina jihen gah≈ç . Published jointly with the", "notes": [{"text": "Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION", "source": "google_vision"}], "extraction_source": "google_vision", "title_source": "google_vision", "creator_source": "google_vision", "publication_source": "google_vision"}, "confidence_scores": {"title": 0.8727527034000001, "creator": 0.8727527034000001, "publication": 0.8727527034000001, "format": 0.8727527034000001, "language": 0.8727527034000001, "overall": 0.8727527034000001}, "overall_confidence": 0.8727527034000001, "processing_notes": ["Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION"], "review_required": false}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg", "extracted_data": {"title": "Toyoda, commander of the Combined Fleet, standing on the bridge. India-Burma front. Scenes in", "creator": {}, "publication_date": "2019", "language": "und", "subjects": [{"heading": "Text", "type": "topical", "source": "google_vision_labels", "confidence": 0.9506143}, {"heading": "Paper", "type": "topical", "source": "google_vision_labels", "confidence": 0.92738056}, {"heading": "Brown", "type": "topical", "source": "google_vision_labels", "confidence": 0.9156698}, {"heading": "Paper Product", "type": "topical", "source": "google_vision_labels", "confidence": 0.8921102}], "format": "book", "isbn": "", "raw_text": "T≈çky≈ç nichi nichi shimbunsha\n. A large format monthly illustrated magazine devoted to\nthe news of Japan's war in greater East Asia. Includes a day by day summary of the month's news.\nPhotographs are b&w only. Rear covers are advertisements. Contents: Front cover: Admiral Soemu\nToyoda, commander of the Combined Fleet, standing on the bridge. India-Burma front. Scenes in\nBougainville. Death of Admiral Mineichi Koga, commander of the combined fleet. Loyang. Condition:\nExcellent. Disbound, with four small holes punched along edge. Purchased from Utagawa123 via Ebay in\nthe early 2000s.\n+++\n+++\nTotal issues held: 19. Catalogued July, 2019.", "notes": [{"text": "Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION", "source": "google_vision"}], "extraction_source": "google_vision", "title_source": "google_vision", "creator_source": "google_vision", "publication_source": "google_vision"}, "confidence_scores": {"title": 0.7028412944000001, "creator": 0.7028412944000001, "publication": 0.7028412944000001, "format": 0.7028412944000001, "language": 0.7028412944000001, "overall": 0.7028412944000001}, "overall_confidence": 0.7028412944000001, "processing_notes": ["Processed with Google Vision API using features: TEXT_DETECTION, DOCUMENT_TEXT_DETECTION, LABEL_DETECTION"], "review_required": false}], "collection_analysis": {"total_items": 6, "successful_items": 6, "confidence_distribution": {"high": 3, "medium": 3, "low": 0}, "language_distribution": {}, "format_distribution": {}}, "batch_confidence": 0.6358209541507936, "processing_timestamp": "2025-12-23T16:33:07.076447", "processing_summary": {"successful": 6, "failed": 0, "avg_confidence": 0.6358209541507936}}, "individual_extractions": [{"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "extraction_confidence": 0.7804983637333334, "extracted_fields": ["title", "creator", "publication_date", "language", "subjects", "format", "isbn", "raw_text", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "extraction_confidence": 0.5138672755714285, "extracted_fields": ["title", "creator", "publication_date", "language", "subjects", "format", "isbn", "raw_text", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "extraction_confidence": 0.38397449999999994, "extracted_fields": ["title", "creator", "publication_date", "language", "subjects", "format", "isbn", "raw_text", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "extraction_confidence": 0.5609915877999999, "extracted_fields": ["title", "creator", "publication_date", "language", "subjects", "format", "isbn", "raw_text", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "extraction_confidence": 0.8727527034000001, "extracted_fields": ["title", "creator", "publication_date", "language", "subjects", "format", "isbn", "raw_text", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg", "extraction_confidence": 0.7028412944000001, "extracted_fields": ["title", "creator", "publication_date", "language", "subjects", "format", "isbn", "raw_text", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}], "external_api_results": [{"worldcat": [], "loc": [{"type": "subject_authority", "term": "Text", "valid": true, "authorized_form": "Textbooks", "validation_method": "dc.subject"}, {"type": "subject_authority", "term": "Paper", "valid": true, "authorized_form": "Cutout animation films", "validation_method": "dc.subject"}, {"type": "subject_authority", "term": "Brown", "valid": true, "authorized_form": "Southern brown bandicoot", "validation_method": "dc.subject"}], "alma": [], "best_match": null}]};
        const metadataData = {"workflow_type": "collection_images_to_marc", "collection_name": "JP-test", "processing_result": {"approach": "collection", "records_generated": 1, "review_required": true, "groupings": {"approach": "collection", "total_items": 6, "groups": [{"type": "collection", "items": ["Osaka mai nichi, Tokyo nichi nichi", "", "", "ÂèØË®±ÈÉ®‰ª§Âè∏ËªçÂ±ØÈßêÈÇ£ÊîØ,ÂèØË®±ÁúÅËªçÈô∏", "Showa 14, August 5, no. 64. Anglo-Japanese talks in Tokyo. Cover: Firecrackers go off behind a palm tree", "Toyoda, commander of the Combined Fleet, standing on the bridge. India-Burma front. Scenes in"], "record_type": "collection"}]}}, "collection_data": {"total_items": 6, "source_images": ["examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg"], "provenance": "Extracted from 6 images using marcsnarc"}, "batch_analysis_summary": {"total_images": 6, "successful_analyses": 6, "batch_confidence": 0.6358209541507936}, "processing_timestamp": "2025-12-23T16:33:09.559817"};
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize images array from gallery
            const thumbnails = document.querySelectorAll('.thumbnail');
            currentImages = Array.from(thumbnails).map(img => ({
                src: img.src,
                alt: img.alt
            }));
            
            // Initialize JSON trees
            if (analysisData && Object.keys(analysisData).length > 0) {
                renderJsonTree('analysis-tree', analysisData);
            }
            if (metadataData && Object.keys(metadataData).length > 0) {
                renderJsonTree('metadata-tree', metadataData);
            }
        });
        
        // Modal functions
        function openModal(index) {
            currentImageIndex = index;
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const counter = document.getElementById('modalCounter');
            
            if (currentImages[index]) {
                modalImage.src = currentImages[index].src;
                modalImage.alt = currentImages[index].alt;
                counter.textContent = `${index + 1} of ${currentImages.length}`;
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function changeImage(direction) {
            currentImageIndex = (currentImageIndex + direction + currentImages.length) % currentImages.length;
            openModal(currentImageIndex);
        }
        
        // Keyboard controls
        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'block') {
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft') changeImage(-1);
                if (e.key === 'ArrowRight') changeImage(1);
            }
        });
        
        // Close modal on background click
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        // JSON Tree rendering functions
        function renderJsonTree(containerId, data) {
            const container = document.getElementById(containerId);
            if (!container || !data) return;
            
            container.innerHTML = '';
            const tree = createTreeElement(data, '', 0);
            container.appendChild(tree);
        }
        
        function createTreeElement(value, key, level) {
            const wrapper = document.createElement('div');
            wrapper.style.marginLeft = `${level * 20}px`;
            wrapper.style.marginBottom = '3px';
            
            if (value && typeof value === 'object' && !Array.isArray(value)) {
                // Object
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                Object.entries(value).forEach(([childKey, childValue]) => {
                    children.appendChild(createTreeElement(childValue, childKey, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìÇ ${key} {${Object.keys(value).length}}</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else if (Array.isArray(value)) {
                // Array
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                value.forEach((item, index) => {
                    children.appendChild(createTreeElement(item, `[${index}]`, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìñ ${key} [${value.length}]</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else {
                // Primitive value
                const element = document.createElement('div');
                const valueStr = value === null ? 'null' : String(value);
                const valueType = typeof value;
                let color = '#4a5568';
                let icon = 'üìÑ';
                
                if (valueType === 'string') { color = '#38a169'; icon = 'üìù'; }
                else if (valueType === 'number') { color = '#d69e2e'; icon = 'üî¢'; }
                else if (valueType === 'boolean') { color = '#9f7aea'; icon = '‚úÖ'; }
                else if (value === null) { color = '#a0aec0'; icon = '‚ùå'; }
                
                element.innerHTML = `<span style="color: #2d3748; font-weight: 600;">${icon} ${key}:</span> <span style="color: ${color};">${valueType === 'string' ? '"' + valueStr + '"' : valueStr}</span>`;
                wrapper.appendChild(element);
            }
            
            return wrapper;
        }
        
        function expandAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñ∂')) {
                    span.parentElement.click();
                }
            });
        }
        
        function collapseAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñº')) {
                    span.parentElement.click();
                }
            });
        }
    </script>
</body>
</html>