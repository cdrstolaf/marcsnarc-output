<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>JP-test - MARC Records</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; line-height: 1.6; background: #fafafa; }
        
        /* Header */
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 2em; font-weight: 300; }
        .header p { margin: 10px 0 0; opacity: 0.9; }
        
        /* Image Gallery */
        .image-gallery { display: flex; gap: 15px; overflow-x: auto; padding: 20px 0; margin-bottom: 30px; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .thumbnail-container { flex-shrink: 0; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .thumbnail-container:hover { transform: scale(1.02); box-shadow: 0 4px 15px rgba(0,0,0,0.15); }
        .thumbnail { width: 200px; height: 300px; object-fit: cover; border-radius: 8px; border: 3px solid #e0e0e0; transition: border-color 0.2s ease; }
        .thumbnail-container:hover .thumbnail { border-color: #667eea; }
        .thumbnail-label { text-align: center; margin-top: 8px; font-size: 0.85em; color: #666; font-weight: 500; word-break: break-word; max-width: 200px; }
        .no-images { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 90vw; max-height: 90vh; }
        .modal-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .modal-close { position: absolute; top: 15px; right: 20px; color: white; font-size: 30px; font-weight: bold; cursor: pointer; z-index: 1001; width: 40px; height: 40px; border-radius: 50%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .modal-close:hover { background: rgba(255,0,0,0.7); }
        .modal-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.5); color: white; border: none; padding: 15px 20px; font-size: 18px; cursor: pointer; border-radius: 5px; transition: background 0.2s ease; }
        .modal-nav:hover { background: rgba(0,0,0,0.8); }
        .modal-prev { left: 20px; }
        .modal-next { right: 20px; }
        .modal-counter { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: white; background: rgba(0,0,0,0.7); padding: 8px 16px; border-radius: 20px; font-size: 14px; }
        
        /* MARC Records */
        .records-section h2 { color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; margin: 30px 0 20px; }
        .marc-record { background: white; border: none; margin-bottom: 25px; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .marc-record h3 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .confidence { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); padding: 6px 12px; border-radius: 20px; display: inline-block; margin-bottom: 15px; color: #2c5530; font-weight: 500; font-size: 0.9em; }
        .review-flag { background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); border: none; color: #d63031; padding: 6px 12px; border-radius: 20px; margin-bottom: 15px; font-weight: 500; font-size: 0.9em; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 5px rgba(0,0,0,0.05); }
        th, td { padding: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #f0f0f0; }
        th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; width: 100px; }
        .subfield-code { font-weight: bold; color: #667eea; background: #f8f9ff; padding: 2px 4px; border-radius: 3px; margin-right: 5px; }
        .no-records { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* External API Results */
        .api-results-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .api-results-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .api-summary { background: #f8f9ff; border: 1px solid #e0e6ff; border-radius: 6px; padding: 12px; margin-bottom: 20px; }
        .api-summary p { margin: 0; color: #333; font-size: 0.95em; }
        .api-source { margin-bottom: 20px; }
        .api-source h3 { color: #667eea; margin-bottom: 10px; font-size: 1.1em; }
        .api-matches { background: #f8f9ff; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .api-match { background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 10px; margin-bottom: 10px; }
        .api-match:last-child { margin-bottom: 0; }
        .match-title { font-weight: 600; color: #333; margin-bottom: 5px; }
        .match-author { color: #666; margin-bottom: 5px; }
        .match-details { font-size: 0.9em; color: #888; }
        .no-matches { text-align: center; padding: 20px; color: #999; font-style: italic; }
        .api-no-results { }
        .search-details { background: #f8f9fa; border-radius: 6px; padding: 15px; margin-top: 15px; }
        .search-details h4 { margin-top: 0; color: #495057; }
        .search-details ul { margin: 10px 0; padding-left: 20px; }
        .search-details li { margin-bottom: 5px; color: #6c757d; }
        .search-details em { color: #6c757d; }
        .authority-result { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 0.85em; margin-right: 10px; }
        .authority-valid { background: #d4edda; color: #155724; }
        .authority-invalid { background: #f8d7da; color: #721c24; }
        
        /* JSON Tree View */
        .json-tree-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .json-tree-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .tree-container { border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; background: #fafafa; max-height: 600px; overflow-y: auto; font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono", monospace; }
        .expand-all-btn, .collapse-all-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; margin-right: 10px; margin-bottom: 15px; font-size: 0.9em; transition: transform 0.2s ease; }
        .expand-all-btn:hover, .collapse-all-btn:hover { transform: translateY(-1px); }
        
        /* Footer */
        .footer { text-align: center; padding: 20px; color: #666; font-size: 0.9em; background: white; border-radius: 10px; margin-top: 30px; }
        .footer a { color: #667eea; text-decoration: none; font-weight: 500; }
        .footer a:hover { text-decoration: underline; }
        
        /* Responsive */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .thumbnail { width: 150px; height: 225px; }
            .thumbnail-label { max-width: 150px; }
            .modal-nav { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>JP-test</h1>
        <p>üìö MARC Records generated by marcsnarc on 2025-12-23 13:43:56</p>
    </div>
    
    <div class='image-gallery'>

                <div class='thumbnail-container' onclick='openModal(0)'>
                    <img src='img_PXL_20251212_165802824.webp' alt='PXL_20251212_165802824.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165802824.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(1)'>
                    <img src='img_PXL_20251212_165807773.webp' alt='PXL_20251212_165807773.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165807773.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(2)'>
                    <img src='img_PXL_20251212_165816342.webp' alt='PXL_20251212_165816342.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165816342.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(3)'>
                    <img src='img_PXL_20251212_165825246.webp' alt='PXL_20251212_165825246.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165825246.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(4)'>
                    <img src='img_PXL_20251212_165855357.webp' alt='PXL_20251212_165855357.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165855357.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(5)'>
                    <img src='img_PXL_20251212_165928834.webp' alt='PXL_20251212_165928834.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165928834.jpg</div>
                </div>
                </div>

    
    <!-- Modal for image viewing -->
    <div id="imageModal" class="modal">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <button class="modal-nav modal-prev" onclick="changeImage(-1)">‚Äπ</button>
        <button class="modal-nav modal-next" onclick="changeImage(1)">‚Ä∫</button>
        <div class="modal-content">
            <img id="modalImage" class="modal-image" src="" alt="">
        </div>
        <div class="modal-counter" id="modalCounter"></div>
    </div>
    
    <div class="records-section">
        <h2>üìã MARC Records</h2>
        <div class='marc-record'>
<h3>Record 1</h3>
<div class='confidence'>Confidence: 0.47</div>
<div class='review-flag'>‚ö†Ô∏è Review Required</div>
<table><tr><th>LDR</th><td>00000nam a200000 Ki 500</td></tr><tr><th>001</th><td>msn20251223194356</td></tr><tr><th>003</th><td>DLC</td></tr><tr><th>005</th><td>20251223194356.0</td></tr><tr><th>008</th><td>251223m19371938            o     00eng und d</td></tr><tr><th>040</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>DLC <span class="subfield-code">‚Ä°b</span>eng <span class="subfield-code">‚Ä°c</span>DLC <span class="subfield-code">‚Ä°e</span>rda </td></tr><tr><th>245</th><td><strong>00</strong> <span class="subfield-code">‚Ä°a</span>JP-test </td></tr><tr><th>264</th><td><strong>_1</strong> <span class="subfield-code">‚Ä°c</span>1937 </td></tr><tr><th>300</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>6 items (various formats) </td></tr><tr><th>520</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection consists of 2 books, 4 other items. Items date from 1937 to 1938. </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection-level record for 6 items </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Provenance: Extracted from 6 images using marcsnarc </td></tr><tr><th>561</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Extracted from 6 images using marcsnarc </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Sino-Japanese War </td></tr><tr><th>999</th><td><strong>__</strong> <span class="subfield-code">‚Ä°i</span>Generated by marcsnarc on 2025-12-23 <span class="subfield-code">‚Ä°s</span>marcsnarc </td></tr></table></div>

    </div>
    
    <div class="api-results-section">
<h2>üåê External API Results</h2>
<div class="api-summary">
<p><strong>Search Summary:</strong> 2 item(s) searched across WorldCat, Library of Congress, and Alma catalogs</p>
</div>
<div class="api-source"><h3>Record 1</h3>
<div class="api-source">
<h3>üèõÔ∏è Library of Congress Authority Validation</h3>
<div class="api-matches">
<div class="api-match">
<div class="match-title">subject_authority: Sino-Japanese War</div>
<span class="authority-result authority-invalid">‚ùå Not found</span>
</div>
</div>
</div>
</div>
<div class="api-source"><h3>Record 2</h3>
<div class="api-source">
<h3>üèõÔ∏è Library of Congress Authority Validation</h3>
<div class="api-matches">
<div class="api-match">
<div class="match-title">subject_authority: Sino-Japanese War</div>
<span class="authority-result authority-invalid">‚ùå Not found</span>
</div>
</div>
</div>
</div>
</div>

    
    
            <div class='json-tree-section'>
                <h2>üìä Analysis Data</h2>
                <div class='tree-container' id='analysis-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("analysis-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("analysis-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
            <div class='json-tree-section'>
                <h2>üìã Processing Metadata</h2>
                <div class='tree-container' id='metadata-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("metadata-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("metadata-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
    
    <div class="footer">
        Generated with <a href="https://github.com/anthropics/marcsnarc">marcsnarc</a> - AI-powered MARC cataloging
    </div>
    
    <script>
        // Global variables for modal and JSON data
        let currentImages = [];
        let currentImageIndex = 0;
        const analysisData = {"collection_analysis": {"item_count": 6, "formats": {"format_counts": {"book": 1, "pamphlet": 1, "note|ephemera": 1, "periodical|pictorial magazine": 1, "printed bibliography page": 1, "magazine": 1}, "unique_formats": "{'note|ephemera', 'magazine', 'book', 'printed bibliography page', 'pamphlet', 'periodical|pictorial magazine'}", "books": 2, "serials": 0, "ephemera": 0, "other": 4, "primary_format": "book"}, "creators": {"creator_counts": {"Ê∫Ä‰∫ïË™†": 1, "ÊúùÊó•Êñ∞ËÅûÁ§æ": 1, "Multiple authors referenced": 1}, "unique_creators": "{'Multiple authors referenced', 'ÊúùÊó•Êñ∞ËÅûÁ§æ', 'Ê∫Ä‰∫ïË™†'}", "items_with_creators": 3, "items_without_creators": 3, "dominant_creator": ["Ê∫Ä‰∫ïË™†", 1]}, "dates": {"date_range": [1937, 1938], "earliest_date": 1937, "latest_date": 1938, "date_span": 1, "items_with_dates": 2, "date_counts": {"1937": 1, "1938": 1}}, "languages": {"language_counts": {"eng": 2, "jpn": 2, "english with japanese/chinese romanization": 1, "english, japanese": 1}, "unique_languages": "{'english, japanese', 'eng', 'english with japanese/chinese romanization', 'jpn'}", "primary_language": "eng", "multilingual": true}, "subjects": {"subject_counts": {"Sino-Japanese War": 2, "China-Japan conflict": 1, "Military history": 1, "War photography": 1, "Japanese propaganda": 1, "1937-1939 period": 1, "Manchuria": 1, "Travel guide": 1, "Geography": 1, "Historical Japan": 1, "North China Incident": 1, "Military photography": 1, "War correspondence": 1, "Historical pictorial": 1, "1930s Japan": 1, "Japanese puppet regimes": 1, "Burma during World War II": 1, "Chinese national government": 1, "Osaka mainichi": 1, "East Asia War": 1, "International relations - China and Japan": 1, "Japan's war in greater East Asia": 1, "monthly illustrated magazine": 1, "Admiral Soemu Toyoda": 1, "Combined Fleet": 1, "India Burma front": 1, "Admiral Mineichi Koga": 1, "Loyang Condition": 1, "Uzigawa123": 1}, "unique_subjects": "{'Travel guide', 'Geography', 'India Burma front', 'Loyang Condition', 'East Asia War', 'Admiral Soemu Toyoda', 'Historical pictorial', 'International relations - China and Japan', 'War photography', 'Combined Fleet', 'Japanese puppet regimes', 'monthly illustrated magazine', 'Uzigawa123', 'Military history', 'War correspondence', 'Military photography', 'Japanese propaganda', 'Osaka mainichi', 'Burma during World War II', 'Manchuria', \"Japan's war in greater East Asia\", 'North China Incident', 'Chinese national government', '1937-1939 period', 'Admiral Mineichi Koga', 'Sino-Japanese War', '1930s Japan', 'Historical Japan', 'China-Japan conflict'}", "items_with_subjects": 5, "common_subjects": [["Sino-Japanese War", 2], ["China-Japan conflict", 1], ["Military history", 1], ["War photography", 1], ["Japanese propaganda", 1]], "subject_coherence": 2.5172413793103448}, "provenance": {"collection_provenance": "Extracted from 6 images using marcsnarc", "item_provenances": {}, "consistency_score": 1.0, "has_provenance": true}, "identifiers": {"items_with_isbn": 0, "items_with_issn": 0, "items_with_oclc": 0, "items_with_lccn": 0, "identifier_coverage": 0.0}, "physical_characteristics": {"extent_variety": 4, "dimension_variety": 4, "physical_coherence": 0.33333333333333337}, "format_diversity": 6, "creator_diversity": 3, "has_books_serials": true, "shared_provenance": true, "temporal_coherence": 1.0, "workflow_type": "collection_images_to_marc", "collection_name": "JP-test", "processing_timestamp": "2025-12-23T13:43:56.497696", "total_records": 1, "approach": "collection"}, "batch_analysis": {"collection_name": "JP-test", "total_images": 6, "successful_analyses": 6, "failed_analyses": 0, "individual_results": [{"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "extracted_data": {"title": "The Shina Jihen Gaho", "subtitle": "The China Incident Pictorial", "publication_place": "Tokyo", "publication_date": "1937-1939", "normalized_date": {"normalized": "1937", "end_date": "1939", "circa": false, "uncertain": false, "original": "1937-1939"}, "format": "book", "language": "eng", "original_script_title": "Latin script with Japanese romanization references", "subjects": [{"heading": "Sino-Japanese War", "type": "topical", "source": "claude_analysis"}, {"heading": "China-Japan conflict", "type": "topical", "source": "claude_analysis"}, {"heading": "Military history", "type": "topical", "source": "claude_analysis"}, {"heading": "War photography", "type": "topical", "source": "claude_analysis"}, {"heading": "Japanese propaganda", "type": "topical", "source": "claude_analysis"}, {"heading": "1937-1939 period", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Reference work cataloging entries for 'The Shina Jihen Gaho' (The China Incident Pictorial)", "source": "image_analysis"}, {"text": "Contains multiple dated entries from 1937-1939", "source": "image_analysis"}, {"text": "Entries reference covers featuring soldiers, military personnel, and war scenes", "source": "image_analysis"}, {"text": "Mentions Chinese collaborators, soldiers, daily life in China during the conflict", "source": "image_analysis"}, {"text": "References Shanghai, North China, Peking, and other locations", "source": "image_analysis"}, {"text": "Includes entries about Japanese military activities and occupation", "source": "image_analysis"}, {"text": "Contains references to covers showing military equipment, civilians, and battle scenes", "source": "image_analysis"}, {"text": "Publication appears to be a serial/periodical issued during the Sino-Japanese War", "source": "image_analysis"}, {"text": "Text suggests this is a catalog or finding aid for a collection of these pictorial magazines", "source": "image_analysis"}, {"text": "Multiple entries describe different cover images and issues from the series", "source": "image_analysis"}, {"text": "References include both descriptive content and issue numbering (e.g., 'Showa 12', 'Showa 13', 'Showa 14')", "source": "image_analysis"}, {"text": "Mentions special issues and campaign-related content", "source": "image_analysis"}, {"text": "Contains romanized Japanese titles: ÊîØÈÇ£‰∫ãÂ§âÁîªÂ†± (Shina Jihen Gaho)", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.2, "publication": 0.39, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.48425}, "overall_confidence": 0.48425, "claude_factors": {"text_clarity": "high", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Osaka mei nichi, Tokyo nichi nichi", "language": "Japanese romanization", "location": "publisher information"}, {"text": "ÊîØÈÇ£‰∫ãÂ§âÁîªÂ†±, Shina Jihen gaho", "language": "Japanese/Chinese characters with romanization", "location": "title"}, {"text": "ÊîØÈÇ£‰∫ãÂ§â, ≈åsaka mai nichi Shinbun sha", "language": "Japanese characters with romanization", "location": "publisher/title information"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 1}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "extracted_data": {"title": "Ê∫ÄÊ¥≤Ê°àÂÜÖ", "subtitle": "Ê∫ÄÊ¥≤Ê°àÂÜÖ„ÅÆË∂£Êó®„ÄÅÊ∫ÄÊ¥≤Ê°àÂÜÖ„ÅÆÊ¶ÇË™¨", "creator": {"name": "Ê∫Ä‰∫ïË™†", "type": "personal", "source": "claude_analysis", "romanization": "Mitsui Makoto"}, "format": "pamphlet", "extent": "Single page or pamphlet cover visible", "dimensions": "Approximately A4 or similar size", "language": "jpn", "original_script_title": "Japanese (Kanji and Kana)", "subjects": [{"heading": "Manchuria", "type": "topical", "source": "claude_analysis"}, {"heading": "Travel guide", "type": "topical", "source": "claude_analysis"}, {"heading": "Geography", "type": "topical", "source": "claude_analysis"}, {"heading": "Historical Japan", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Image appears to be rotated 90 degrees counterclockwise", "source": "image_analysis"}, {"text": "Document shows signs of age with discoloration and foxing", "source": "image_analysis"}, {"text": "Contains photographic or illustrated content showing architectural structures and landscapes", "source": "image_analysis"}, {"text": "Small text header visible at top with what appears to be publication or catalog information", "source": "image_analysis"}, {"text": "Appears to be a guide or informational pamphlet about Manchuria (Mansh≈´)", "source": "image_analysis"}, {"text": "Historical document likely from Japanese colonial period", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.0, "format": 0.26, "language": 0.5850000000000001, "overall": 0.40725}, "overall_confidence": 0.40725, "claude_factors": {"text_clarity": "medium", "completeness": "low", "language_certainty": "high"}, "original_text_regions": [{"text": "Ê∫ÄÊ¥≤Ê°àÂÜÖ", "language": "Japanese", "location": "title"}, {"text": "Ê∫ÄÊ¥≤Ê°àÂÜÖ„ÅÆË∂£Êó®\nÊ∫ÄÊ¥≤Ê°àÂÜÖ„ÅÆÊ¶ÇË™¨", "language": "Japanese", "location": "subtitle area"}, {"text": "Ê∫Ä‰∫ïË™†", "language": "Japanese", "location": "left margin/author attribution"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Bibliographic information appears incomplete in image", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 2}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "extracted_data": {"format": "note|ephemera", "extent": "1 adhesive note", "dimensions": "approximately 3x3 inches or 76x76mm (standard Post-it note size)", "language": "eng", "original_script_title": "Latin", "notes": [{"text": "This appears to be a light blue adhesive note (Post-it style) with handwritten text", "source": "image_analysis"}, {"text": "The handwritten text appears to read 'Bathroom' written vertically", "source": "image_analysis"}, {"text": "The note is photographed on a wooden surface", "source": "image_analysis"}, {"text": "This is not a formal bibliographic item but rather an ephemeral document or reminder note", "source": "image_analysis"}, {"text": "The item lacks traditional publication information as it is a handwritten note", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.45499999999999996, "creator": 0.2, "publication": 0.0, "format": 0.5850000000000001, "language": 0.5850000000000001, "overall": 0.33275}, "overall_confidence": 0.33275, "claude_factors": {"text_clarity": "medium", "completeness": "high", "language_certainty": "high"}, "original_text_regions": [{"text": "Bathroom", "language": "English", "location": "center of note, written vertically"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No title could be extracted from image", "No creator/author information found"], "review_required": true, "sequence_number": 3}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "extracted_data": {"title": "ÂåóÊîØ‰∫ãÂ§âÁï´Â†±", "creator": {"name": "ÊúùÊó•Êñ∞ËÅûÁ§æ", "type": "corporate", "source": "claude_analysis", "romanization": "Asahi Shinbunsha"}, "publisher": "ÊúùÊó•Êñ∞ËÅûÁ§æ", "publication_place": "Japan", "publication_date": "Êò≠ÂíåÂçÅ‰∏âÂπ¥ (1938)", "normalized_date": {"normalized": "1938", "end_date": null, "circa": false, "uncertain": false, "original": "Êò≠ÂíåÂçÅ‰∏âÂπ¥ (1938)"}, "format": "periodical|pictorial magazine", "extent": "Single issue, approximately 1 fascicle", "dimensions": "Appears to be standard magazine size, approximately A4 or similar", "language": "jpn", "original_script_title": "Traditional Chinese characters/Japanese kanji", "other_identifiers": "Á¨¨‰∏ÄËºØ (Volume/Issue 1)", "subjects": [{"heading": "Sino-Japanese War", "type": "topical", "source": "claude_analysis"}, {"heading": "North China Incident", "type": "topical", "source": "claude_analysis"}, {"heading": "Military photography", "type": "topical", "source": "claude_analysis"}, {"heading": "War correspondence", "type": "topical", "source": "claude_analysis"}, {"heading": "Historical pictorial", "type": "topical", "source": "claude_analysis"}, {"heading": "1930s Japan", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Historic war pictorial publication from the Asahi Newspaper Company", "source": "image_analysis"}, {"text": "Cover shows soldiers in combat position wearing helmets", "source": "image_analysis"}, {"text": "Title translates to 'North China Incident Pictorial'", "source": "image_analysis"}, {"text": "Features military photography from the Second Sino-Japanese War", "source": "image_analysis"}, {"text": "Publication appears to be from the Showa 13 (1938) period", "source": "image_analysis"}, {"text": "Visible aging and foxing on the paper", "source": "image_analysis"}, {"text": "This appears to be propaganda or documentary material from wartime Japan", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.45499999999999996, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.5275}, "overall_confidence": 0.5275, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "ÂåóÊîØ‰∫ãËÆäÁï´Â†±", "language": "Japanese with Chinese characters", "location": "header/masthead"}, {"text": "Êò≠ÂíåÂçÅ‰∏âÂπ¥", "language": "Japanese", "location": "left margin"}, {"text": "Á¨¨‰∏ÄËºØ", "language": "Japanese", "location": "left margin"}, {"text": "ÊúùÊó•Êñ∞ËÅûÁ§æ", "language": "Japanese", "location": "below masthead"}], "processing_notes": ["Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 4}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "extracted_data": {"title": "Bibliography or Reference Page", "creator": {"name": "Multiple authors referenced", "type": "corporate", "source": "claude_analysis"}, "publisher": "Multiple publishers referenced", "publication_place": "Multiple locations including Tokyo, Nanjing, Shanghai, Showa", "publication_date": "1940s-2000s", "normalized_date": {"normalized": null, "end_date": null, "circa": false, "uncertain": true, "original": "1940s-2000s"}, "format": "printed bibliography page", "extent": "Single page", "dimensions": "Standard letter size (approximately 8.5 x 11 inches)", "language": "english with japanese/chinese romanization", "original_script_title": "Latin script with romanized Japanese and Chinese titles", "other_identifiers": "Entry numbers visible: [1930], [1943], [1944]", "subjects": [{"heading": "Japanese puppet regimes", "type": "topical", "source": "claude_analysis"}, {"heading": "Burma during World War II", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese national government", "type": "topical", "source": "claude_analysis"}, {"heading": "Osaka mainichi", "type": "topical", "source": "claude_analysis"}, {"heading": "East Asia War", "type": "topical", "source": "claude_analysis"}, {"heading": "International relations - China and Japan", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This appears to be a bibliography or reference page from an academic work", "source": "image_analysis"}, {"text": "Multiple entries reference works about Japanese occupation and puppet governments in Asia during WWII era", "source": "image_analysis"}, {"text": "Entries include both English and romanized Japanese/Chinese titles", "source": "image_analysis"}, {"text": "References span from Showa 14-19 (1939-1944) to early 2000s publications", "source": "image_analysis"}, {"text": "Contains detailed bibliographic information including publishers, dates, and page numbers", "source": "image_analysis"}, {"text": "Multiple references to 'Dai toa senso' (Greater East Asia War)", "source": "image_analysis"}, {"text": "References to Osaka mainichi newspaper", "source": "image_analysis"}, {"text": "Mentions of Tokyo, Nanjing, Shanghai as publication places", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.45499999999999996, "format": 0.5850000000000001, "language": 0.5850000000000001, "overall": 0.5469999999999999}, "overall_confidence": 0.5469999999999999, "claude_factors": {"text_clarity": "medium", "completeness": "high", "language_certainty": "high"}, "original_text_regions": [{"text": "Dai toa senso pito", "language": "Romanized Japanese", "location": "bibliography entries"}, {"text": "Osaka mainichi", "language": "Romanized Japanese", "location": "bibliography entries"}, {"text": "Cover of Hierarchies in Kyoto: K≈çwer hierachies no, no behind a paint tree to celebrate establishment of a new government in China", "language": "English", "location": "entry description Showa 14, August 15, no. 64"}, {"text": "Greater East Asia War Pictorial: A continuation of the Shina jihen gaho", "language": "English with romanized Japanese", "location": "bibliography entry"}], "processing_notes": ["Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 5}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg", "extracted_data": {"title": "T≈çky≈ç nichi nichi shinbunsha kisoku Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æË¶èÂâá", "subtitle": "A large format monthly illustrated magazine devoted to the news of Japan's war in greater East Asia", "publication_date": "early 2000s", "normalized_date": {"normalized": null, "end_date": null, "circa": false, "uncertain": true, "original": "early 2000s"}, "format": "magazine", "language": "english, japanese", "original_script_title": "Latin, Japanese (Kanji)", "other_identifiers": "Total issues held: 19. Cataloged July, 2019.", "subjects": [{"heading": "Japan's war in greater East Asia", "type": "topical", "source": "claude_analysis"}, {"heading": "monthly illustrated magazine", "type": "topical", "source": "claude_analysis"}, {"heading": "Admiral Soemu Toyoda", "type": "topical", "source": "claude_analysis"}, {"heading": "Combined Fleet", "type": "topical", "source": "claude_analysis"}, {"heading": "India Burma front", "type": "topical", "source": "claude_analysis"}, {"heading": "Admiral Mineichi Koga", "type": "topical", "source": "claude_analysis"}, {"heading": "Loyang Condition", "type": "topical", "source": "claude_analysis"}, {"heading": "Uzigawa123", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document appears to be a catalog record or bibliographic description", "source": "image_analysis"}, {"text": "Text is oriented vertically on the page, reading from top to bottom", "source": "image_analysis"}, {"text": "Contains both English and Japanese text (Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æË¶èÂâá)", "source": "image_analysis"}, {"text": "References photographs covering advertisements and contents from cover", "source": "image_analysis"}, {"text": "Mentions rear covers are advertisements", "source": "image_analysis"}, {"text": "Reference to 'Combined Fleet' commander", "source": "image_analysis"}, {"text": "Mentions 'India Burma front' and 'Scenes in'", "source": "image_analysis"}, {"text": "Reference to commander 'Admiral Mineichi Koga'", "source": "image_analysis"}, {"text": "Death mentioned for Admiral Mineichi Koga", "source": "image_analysis"}, {"text": "Reference to 'combined fleet, Loyang Condition'", "source": "image_analysis"}, {"text": "Document purchased from 'Uzigawa123' via Ebay", "source": "image_analysis"}, {"text": "Additional notation: '+++++' appears near bottom", "source": "image_analysis"}, {"text": "Cataloging date: July 2019", "source": "image_analysis"}, {"text": "Total issues held: 19", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.2, "publication": 0.15166666666666667, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.38558333333333333}, "overall_confidence": 0.38558333333333333, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "T≈çky≈ç nichi nichi shinbunsha kisoku Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æË¶èÂâá. A large format monthly illustrated magazine devoted to the news of Japan's war in greater East Asia. Includes a day by day summary of the month's news. Photographs are u&w only. Rear covers are advertisements. Contents: front cover; Admiral Soemu Toyoda, commander of the Combined Fleet, standing on the bridge, India Burma front, Scenes in Bogainville, Death of Admiral Mineichi Koga, commander of the combined fleet, Loyang Condition. Excellent. Disbound, with four small holes punched along edge, purchased from Uzigawa123 via Ebay in the early 2000s.", "language": "English and Japanese", "location": "body text"}, {"text": "+++++ Total issues held: 19. Cataloged July, 2019.", "language": "English", "location": "bottom text"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 6}], "collection_analysis": {"total_items": 6, "successful_extractions": 6, "common_characteristics": {"primary_language": "eng", "language_distribution": {"eng": 2, "jpn": 2, "english with japanese/chinese romanization": 1, "english, japanese": 1}, "primary_format": "book", "format_distribution": {"book": 1, "pamphlet": 1, "note|ephemera": 1, "periodical|pictorial magazine": 1, "printed bibliography page": 1, "magazine": 1}, "publishers": {"ÊúùÊó•Êñ∞ËÅûÁ§æ": 1, "Multiple publishers referenced": 1}}, "quality_assessment": {"average_confidence": 0.44738888888888884, "high_confidence_items": 0, "low_confidence_items": 4, "confidence_range": [0.33275, 0.5469999999999999]}, "recommendations": ["More than 30% of items have low confidence - consider manual review", "Multiple languages detected - verify language coding", "6 items contain CJK characters - verify romanization"]}, "batch_confidence": 0.44738888888888884, "processing_timestamp": "2025-12-23T13:43:55.525618"}, "individual_extractions": [{"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "extraction_confidence": 0.48425, "extracted_fields": ["title", "subtitle", "publication_place", "publication_date", "normalized_date", "format", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "extraction_confidence": 0.40725, "extracted_fields": ["title", "subtitle", "creator", "format", "extent", "dimensions", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "extraction_confidence": 0.33275, "extracted_fields": ["format", "extent", "dimensions", "language", "original_script_title", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "extraction_confidence": 0.5275, "extracted_fields": ["title", "creator", "publisher", "publication_place", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "extraction_confidence": 0.5469999999999999, "extracted_fields": ["title", "creator", "publisher", "publication_place", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg", "extraction_confidence": 0.38558333333333333, "extracted_fields": ["title", "subtitle", "publication_date", "normalized_date", "format", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}], "external_api_results": [{"worldcat": [], "loc": [{"type": "subject_authority", "term": "Sino-Japanese War", "valid": false}], "alma": [], "best_match": null}]};
        const metadataData = {"workflow_type": "collection_images_to_marc", "collection_name": "JP-test", "processing_result": {"approach": "collection", "records_generated": 1, "review_required": true, "groupings": {"approach": "collection", "total_items": 6, "groups": [{"type": "collection", "items": ["The Shina Jihen Gaho", "Ê∫ÄÊ¥≤Ê°àÂÜÖ", "Untitled", "ÂåóÊîØ‰∫ãÂ§âÁï´Â†±", "Bibliography or Reference Page", "T≈çky≈ç nichi nichi shinbunsha kisoku Êù±‰∫¨Êó•Êó•Êñ∞ËÅûÁ§æË¶èÂâá"], "record_type": "collection"}]}}, "collection_data": {"total_items": 6, "source_images": ["examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg"], "provenance": "Extracted from 6 images using marcsnarc"}, "batch_analysis_summary": {"total_images": 6, "successful_analyses": 6, "batch_confidence": 0.44738888888888884}, "processing_timestamp": "2025-12-23T13:43:56.497718"};
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize images array from gallery
            const thumbnails = document.querySelectorAll('.thumbnail');
            currentImages = Array.from(thumbnails).map(img => ({
                src: img.src,
                alt: img.alt
            }));
            
            // Initialize JSON trees
            if (analysisData && Object.keys(analysisData).length > 0) {
                renderJsonTree('analysis-tree', analysisData);
            }
            if (metadataData && Object.keys(metadataData).length > 0) {
                renderJsonTree('metadata-tree', metadataData);
            }
        });
        
        // Modal functions
        function openModal(index) {
            currentImageIndex = index;
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const counter = document.getElementById('modalCounter');
            
            if (currentImages[index]) {
                modalImage.src = currentImages[index].src;
                modalImage.alt = currentImages[index].alt;
                counter.textContent = `${index + 1} of ${currentImages.length}`;
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function changeImage(direction) {
            currentImageIndex = (currentImageIndex + direction + currentImages.length) % currentImages.length;
            openModal(currentImageIndex);
        }
        
        // Keyboard controls
        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'block') {
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft') changeImage(-1);
                if (e.key === 'ArrowRight') changeImage(1);
            }
        });
        
        // Close modal on background click
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        // JSON Tree rendering functions
        function renderJsonTree(containerId, data) {
            const container = document.getElementById(containerId);
            if (!container || !data) return;
            
            container.innerHTML = '';
            const tree = createTreeElement(data, '', 0);
            container.appendChild(tree);
        }
        
        function createTreeElement(value, key, level) {
            const wrapper = document.createElement('div');
            wrapper.style.marginLeft = `${level * 20}px`;
            wrapper.style.marginBottom = '3px';
            
            if (value && typeof value === 'object' && !Array.isArray(value)) {
                // Object
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                Object.entries(value).forEach(([childKey, childValue]) => {
                    children.appendChild(createTreeElement(childValue, childKey, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìÇ ${key} {${Object.keys(value).length}}</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else if (Array.isArray(value)) {
                // Array
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                value.forEach((item, index) => {
                    children.appendChild(createTreeElement(item, `[${index}]`, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìñ ${key} [${value.length}]</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else {
                // Primitive value
                const element = document.createElement('div');
                const valueStr = value === null ? 'null' : String(value);
                const valueType = typeof value;
                let color = '#4a5568';
                let icon = 'üìÑ';
                
                if (valueType === 'string') { color = '#38a169'; icon = 'üìù'; }
                else if (valueType === 'number') { color = '#d69e2e'; icon = 'üî¢'; }
                else if (valueType === 'boolean') { color = '#9f7aea'; icon = '‚úÖ'; }
                else if (value === null) { color = '#a0aec0'; icon = '‚ùå'; }
                
                element.innerHTML = `<span style="color: #2d3748; font-weight: 600;">${icon} ${key}:</span> <span style="color: ${color};">${valueType === 'string' ? '"' + valueStr + '"' : valueStr}</span>`;
                wrapper.appendChild(element);
            }
            
            return wrapper;
        }
        
        function expandAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñ∂')) {
                    span.parentElement.click();
                }
            });
        }
        
        function collapseAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñº')) {
                    span.parentElement.click();
                }
            });
        }
    </script>
</body>
</html>