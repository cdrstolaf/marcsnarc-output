<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>JP-test - MARC Records</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; line-height: 1.6; background: #fafafa; }
        
        /* Header */
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 2em; font-weight: 300; }
        .header p { margin: 10px 0 0; opacity: 0.9; }
        
        /* Image Gallery */
        .image-gallery { display: flex; gap: 15px; overflow-x: auto; padding: 20px 0; margin-bottom: 30px; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .thumbnail-container { flex-shrink: 0; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .thumbnail-container:hover { transform: scale(1.02); box-shadow: 0 4px 15px rgba(0,0,0,0.15); }
        .thumbnail { width: 200px; height: 300px; object-fit: cover; border-radius: 8px; border: 3px solid #e0e0e0; transition: border-color 0.2s ease; }
        .thumbnail-container:hover .thumbnail { border-color: #667eea; }
        .thumbnail-label { text-align: center; margin-top: 8px; font-size: 0.85em; color: #666; font-weight: 500; word-break: break-word; max-width: 200px; }
        .no-images { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 90vw; max-height: 90vh; }
        .modal-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .modal-close { position: absolute; top: 15px; right: 20px; color: white; font-size: 30px; font-weight: bold; cursor: pointer; z-index: 1001; width: 40px; height: 40px; border-radius: 50%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .modal-close:hover { background: rgba(255,0,0,0.7); }
        .modal-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.5); color: white; border: none; padding: 15px 20px; font-size: 18px; cursor: pointer; border-radius: 5px; transition: background 0.2s ease; }
        .modal-nav:hover { background: rgba(0,0,0,0.8); }
        .modal-prev { left: 20px; }
        .modal-next { right: 20px; }
        .modal-counter { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: white; background: rgba(0,0,0,0.7); padding: 8px 16px; border-radius: 20px; font-size: 14px; }
        
        /* MARC Records */
        .records-section h2 { color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; margin: 30px 0 20px; }
        .marc-record { background: white; border: none; margin-bottom: 25px; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .marc-record h3 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .confidence { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); padding: 6px 12px; border-radius: 20px; display: inline-block; margin-bottom: 15px; color: #2c5530; font-weight: 500; font-size: 0.9em; }
        .review-flag { background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); border: none; color: #d63031; padding: 6px 12px; border-radius: 20px; margin-bottom: 15px; font-weight: 500; font-size: 0.9em; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 5px rgba(0,0,0,0.05); }
        th, td { padding: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #f0f0f0; }
        th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; width: 100px; }
        .subfield-code { font-weight: bold; color: #667eea; background: #f8f9ff; padding: 2px 4px; border-radius: 3px; margin-right: 5px; }
        .no-records { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* JSON Tree View */
        .json-tree-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .json-tree-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .tree-container { border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; background: #fafafa; max-height: 600px; overflow-y: auto; font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono", monospace; }
        .expand-all-btn, .collapse-all-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; margin-right: 10px; margin-bottom: 15px; font-size: 0.9em; transition: transform 0.2s ease; }
        .expand-all-btn:hover, .collapse-all-btn:hover { transform: translateY(-1px); }
        
        /* Footer */
        .footer { text-align: center; padding: 20px; color: #666; font-size: 0.9em; background: white; border-radius: 10px; margin-top: 30px; }
        .footer a { color: #667eea; text-decoration: none; font-weight: 500; }
        .footer a:hover { text-decoration: underline; }
        
        /* Responsive */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .thumbnail { width: 150px; height: 225px; }
            .thumbnail-label { max-width: 150px; }
            .modal-nav { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>JP-test</h1>
        <p>üìö MARC Records generated by marcsnarc on 2025-12-22 16:27:54</p>
    </div>
    
    <div class='image-gallery'>

                <div class='thumbnail-container' onclick='openModal(0)'>
                    <img src='img_PXL_20251212_165802824.webp' alt='PXL_20251212_165802824.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165802824.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(1)'>
                    <img src='img_PXL_20251212_165807773.webp' alt='PXL_20251212_165807773.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165807773.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(2)'>
                    <img src='img_PXL_20251212_165816342.webp' alt='PXL_20251212_165816342.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165816342.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(3)'>
                    <img src='img_PXL_20251212_165825246.webp' alt='PXL_20251212_165825246.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165825246.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(4)'>
                    <img src='img_PXL_20251212_165928834.webp' alt='PXL_20251212_165928834.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_165928834.jpg</div>
                </div>
                </div>

    
    <!-- Modal for image viewing -->
    <div id="imageModal" class="modal">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <button class="modal-nav modal-prev" onclick="changeImage(-1)">‚Äπ</button>
        <button class="modal-nav modal-next" onclick="changeImage(1)">‚Ä∫</button>
        <div class="modal-content">
            <img id="modalImage" class="modal-image" src="" alt="">
        </div>
        <div class="modal-counter" id="modalCounter"></div>
    </div>
    
    <div class="records-section">
        <h2>üìã MARC Records</h2>
        <div class='marc-record'>
<h3>Record 1</h3>
<div class='confidence'>Confidence: 0.57</div>
<div class='review-flag'>‚ö†Ô∏è Review Required</div>
<table><tr><th>LDR</th><td>00000nam a200000 Ki 500</td></tr><tr><th>001</th><td>msn20251222222754</td></tr><tr><th>003</th><td>DLC</td></tr><tr><th>005</th><td>20251222222754.0</td></tr><tr><th>008</th><td>251222m19372019            o     00und und d</td></tr><tr><th>040</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>DLC <span class="subfield-code">‚Ä°b</span>eng <span class="subfield-code">‚Ä°c</span>DLC <span class="subfield-code">‚Ä°e</span>rda </td></tr><tr><th>245</th><td><strong>00</strong> <span class="subfield-code">‚Ä°a</span>JP-test </td></tr><tr><th>264</th><td><strong>_1</strong> <span class="subfield-code">‚Ä°c</span>1937 </td></tr><tr><th>300</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>5 items (various formats) </td></tr><tr><th>520</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection consists of 4 books, 1 other items. Items date from 1937 to 2019. </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection-level record for 5 items </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Provenance: Extracted from 6 images using marcsnarc </td></tr><tr><th>561</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Extracted from 6 images using marcsnarc </td></tr><tr><th>999</th><td><strong>__</strong> <span class="subfield-code">‚Ä°i</span>Generated by marcsnarc on 2025-12-22 <span class="subfield-code">‚Ä°s</span>marcsnarc </td></tr></table></div>

    </div>
    
    
            <div class='json-tree-section'>
                <h2>üìä Analysis Data</h2>
                <div class='tree-container' id='analysis-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("analysis-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("analysis-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
            <div class='json-tree-section'>
                <h2>üìã Processing Metadata</h2>
                <div class='tree-container' id='metadata-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("metadata-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("metadata-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
    
    <div class="footer">
        Generated with <a href="https://github.com/anthropics/marcsnarc">marcsnarc</a> - AI-powered MARC cataloging
    </div>
    
    <script>
        // Global variables for modal and JSON data
        let currentImages = [];
        let currentImageIndex = 0;
        const analysisData = {"collection_analysis": {"item_count": 5, "formats": {"format_counts": {"book": 2, "pamphlet": 2, "note": 1}, "unique_formats": "{'pamphlet', 'note', 'book'}", "books": 4, "serials": 0, "ephemera": 0, "other": 1, "primary_format": "book"}, "creators": {"creator_counts": {}, "unique_creators": "set()", "items_with_creators": 0, "items_without_creators": 5, "dominant_creator": null}, "dates": {"date_range": [1937, 2019], "earliest_date": 1937, "latest_date": 2019, "date_span": 82, "items_with_dates": 2, "date_counts": {"1937": 1, "2019": 1}}, "languages": {"language_counts": {"english, japanese, chinese": 1, "jpn": 1, "eng": 1, "english with chinese and japanese script": 1, "english with japanese references": 1}, "unique_languages": "{'jpn', 'english, japanese, chinese', 'english with japanese references', 'eng', 'english with chinese and japanese script'}", "primary_language": "english, japanese, chinese", "multilingual": true}, "subjects": {"subject_counts": {"Sino-Japanese War": 1, "China Incident": 1, "Military history": 1, "Propaganda": 1, "Photography": 1, "Japanese expansion": 1, "World War II precursor": 1, "Manchuria": 1, "Geography": 1, "Dance": 1, "Music": 1, "Painting": 1, "Japanese colonial materials": 1, "signage": 1, "directional note": 1, "facilities": 1, "Japanese government": 1, "Chinese history": 1, "East Asian studies": 1, "Burma/Myanmar": 1, "International relations": 1, "Bibliography": 1, "Japanese magazines": 1, "Japanese news": 1, "Admiral Seemu": 1, "Combined Fleet": 1, "Burma front": 1, "Koga commander": 1, "Indian Ocean": 1, "East Asia war": 1, "Greater East Asia": 1}, "unique_subjects": "{'Dance', 'Combined Fleet', 'Japanese government', 'signage', 'facilities', 'East Asia war', 'Painting', 'International relations', 'Manchuria', 'Bibliography', 'Chinese history', 'Propaganda', 'Japanese colonial materials', 'World War II precursor', 'Burma front', 'Geography', 'Sino-Japanese War', 'Japanese expansion', 'Music', 'Koga commander', 'directional note', 'Photography', 'China Incident', 'Japanese news', 'Burma/Myanmar', 'Japanese magazines', 'Military history', 'Admiral Seemu', 'Indian Ocean', 'Greater East Asia', 'East Asian studies'}", "items_with_subjects": 5, "common_subjects": [["Sino-Japanese War", 1], ["China Incident", 1], ["Military history", 1], ["Propaganda", 1], ["Photography", 1]], "subject_coherence": 3.1}, "provenance": {"collection_provenance": "Extracted from 6 images using marcsnarc", "item_provenances": {}, "consistency_score": 1.0, "has_provenance": true}, "identifiers": {"items_with_isbn": 0, "items_with_issn": 0, "items_with_oclc": 0, "items_with_lccn": 0, "identifier_coverage": 0.0}, "physical_characteristics": {"extent_variety": 4, "dimension_variety": 3, "physical_coherence": 0.30000000000000004}, "format_diversity": 3, "creator_diversity": 0, "has_books_serials": true, "shared_provenance": true, "temporal_coherence": 0.2, "workflow_type": "collection_images_to_marc", "collection_name": "JP-test", "processing_timestamp": "2025-12-22T16:27:54.279799", "total_records": 1, "approach": "collection"}, "batch_analysis": {"collection_name": "JP-test", "total_images": 6, "successful_analyses": 5, "failed_analyses": 1, "individual_results": [{"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "extracted_data": {"title": "The Shina Jihen Gaho", "subtitle": "The China Incident Pictorial", "publication_place": "Osaka, Japan; Tokyo, Japan", "publication_date": "1937-1939", "normalized_date": {"normalized": "1937", "end_date": "1939", "circa": false, "uncertain": false, "original": "1937-1939"}, "format": "book", "extent": "Multiple issues/volumes", "language": "english, japanese, chinese", "original_script_title": "Mixed - includes Japanese and Chinese characters", "subjects": [{"heading": "Sino-Japanese War", "type": "topical", "source": "claude_analysis"}, {"heading": "China Incident", "type": "topical", "source": "claude_analysis"}, {"heading": "Military history", "type": "topical", "source": "claude_analysis"}, {"heading": "Propaganda", "type": "topical", "source": "claude_analysis"}, {"heading": "Photography", "type": "topical", "source": "claude_analysis"}, {"heading": "Japanese expansion", "type": "topical", "source": "claude_analysis"}, {"heading": "World War II precursor", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This appears to be a bibliographic catalog entry or index page", "source": "image_analysis"}, {"text": "References multiple issues/covers from 1937-1939", "source": "image_analysis"}, {"text": "Includes detailed descriptions of cover images featuring military scenes, soldiers, and war-related imagery", "source": "image_analysis"}, {"text": "Multiple entries reference specific issue numbers (e.g., no. 1, no. 5, no. 11, no. 12, etc.)", "source": "image_analysis"}, {"text": "Mentions various subjects including: soldiers in trenches, Japanese officers, Chinese children, military equipment, battlefields, and campaign imagery", "source": "image_analysis"}, {"text": "Published during the Second Sino-Japanese War period", "source": "image_analysis"}, {"text": "Contains references to specific dates such as 'February 11', 'March 11', 'August 12', 'October 21', 'September 13'", "source": "image_analysis"}, {"text": "Trilingual publication with Japanese title ÊîØÈÇ£‰∫ãÂ§âÁîªÂ†± (Shina Jihen Gaho)", "source": "image_analysis"}, {"text": "Publication locations include both Osaka and Tokyo", "source": "image_analysis"}, {"text": "Contains detailed physical descriptions of photographic covers and illustrated content", "source": "image_analysis"}, {"text": "References Hokushi Jihen (North China Incident) as alternate title", "source": "image_analysis"}, {"text": "Mentions purchase information from eBay for $25 per issue", "source": "image_analysis"}, {"text": "Notes indicate this was a large format boxed photo-illustrated magazine", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.2, "publication": 0.39, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.48425}, "overall_confidence": 0.48425, "claude_factors": {"text_clarity": "high", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Shina Jihen Gaho ÊîØÈÇ£‰∫ãÂ§âÁîªÂ†±", "language": "Japanese/Chinese", "location": "title entry"}, {"text": "ÊîØÈÇ£‰∫ãÂ§âÁîªÂ†± (Hokushi Jihen Gaho) (North China)", "language": "Japanese/Chinese", "location": "alternate title entry"}, {"text": "Osaka and Osaka mai nichi, Tokyo nichi nichi", "language": "English", "location": "publication information"}, {"text": "Publisher: Â§ßÈò™ÊØéÊó•Êñ∞ËÅûÁ§æ Osaka mai nichi Shinbun sha ÊØéÊó•Êñ∞ËÅûÁ§æ Tokyo mai nichi Shinbun sha", "language": "Japanese/English", "location": "publisher information"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 1}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "extracted_data": {"title": "Ê∫ÄÊ¥≤Âú∞ÁêÜ", "subtitle": "Ê∫ÄÊ¥≤„ÅÆËàûË∏ä„Å®Èü≥Ê•Ω / Ê∫ÄÊ¥≤„ÅÆËàûË∏ä„Å®ÁµµÁîª", "creator": {"name": "Unknown", "type": "personal", "source": "claude_analysis"}, "format": "pamphlet", "extent": "Single sheet or pamphlet page", "dimensions": "Approximately standard pamphlet size", "language": "jpn", "original_script_title": "Japanese (Kanji with some Katakana)", "subjects": [{"heading": "Manchuria", "type": "topical", "source": "claude_analysis"}, {"heading": "Geography", "type": "topical", "source": "claude_analysis"}, {"heading": "Dance", "type": "topical", "source": "claude_analysis"}, {"heading": "Music", "type": "topical", "source": "claude_analysis"}, {"heading": "Painting", "type": "topical", "source": "claude_analysis"}, {"heading": "Japanese colonial materials", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Image is photographed rotated 90 degrees clockwise", "source": "image_analysis"}, {"text": "Contains photographs of what appear to be buildings and landscapes in Manchuria", "source": "image_analysis"}, {"text": "Shows signs of aging with visible foxing and discoloration", "source": "image_analysis"}, {"text": "Text appears to be part of an educational or promotional material about Manchuria", "source": "image_analysis"}, {"text": "Header contains additional text that is partially legible", "source": "image_analysis"}, {"text": "Material likely dates from Japanese occupation period of Manchuria (1930s-1940s)", "source": "image_analysis"}, {"text": "Vertical text reading from right to left in traditional Japanese style", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.0, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.4365}, "overall_confidence": 0.4365, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Ê∫ÄÊ¥≤Âú∞ÁêÜ", "language": "Japanese", "location": "title page"}, {"text": "Ê∫ÄÊ¥≤„ÅÆËàûË∏ä„Å®Èü≥Ê•Ω / Ê∫ÄÊ¥≤„ÅÆËàûË∏ä„Å®ÁµµÁîª", "language": "Japanese", "location": "title page"}, {"text": "ÊÅ©‰∫ïÂçäËóè", "language": "Japanese", "location": "left margin"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 2}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "extracted_data": {"title": "Bathroom", "format": "note", "extent": "Single note/sticky note", "dimensions": "Approximately 4x5 inches (standard sticky note size)", "language": "eng", "original_script_title": "Latin", "subjects": [{"heading": "signage", "type": "topical", "source": "claude_analysis"}, {"heading": "directional note", "type": "topical", "source": "claude_analysis"}, {"heading": "facilities", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Handwritten text on blue sticky note", "source": "image_analysis"}, {"text": "Written in cursive/script handwriting", "source": "image_analysis"}, {"text": "Appears to be a temporary directional or informational sign", "source": "image_analysis"}, {"text": "Note is placed on what appears to be a wooden surface (possibly a door or wall)", "source": "image_analysis"}, {"text": "This is not a formal bibliographic item but rather an ephemeral manuscript note", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.2, "publication": 0.0, "format": 0.5850000000000001, "language": 0.5850000000000001, "overall": 0.42575}, "overall_confidence": 0.42575, "claude_factors": {"text_clarity": "high", "completeness": "high", "language_certainty": "high"}, "original_text_regions": [{"text": "Bathroom", "language": "English", "location": "center of note"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 3}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg", "sequence_number": 4, "error": "Failed to analyze image examples/Japanese Prints in OCLC/PXL_20251212_165855357.jpg: Claude API analysis failed: Error code: 400 - {'type': 'error', 'error': {'type': 'invalid_request_error', 'message': 'messages.0.content.1.image.source.base64: image exceeds 5 MB maximum: 5812260 bytes > 5242880 bytes'}, 'request_id': 'req_011CWNWi8pnVKiyyC4m626e4'}", "overall_confidence": 0.0, "extracted_data": null}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "extracted_data": {"title": "Bibliography/Reference list page", "format": "book", "extent": "Single page from a larger work", "dimensions": "Approximately standard book page size", "language": "english with chinese and japanese script", "original_script_title": "Mixed: Latin script with Chinese characters (Êº¢Â≠ó) and Japanese", "other_identifiers": "Entry numbers [1930], [1943], [1944] visible in bibliography", "subjects": [{"heading": "Japanese government", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese history", "type": "topical", "source": "claude_analysis"}, {"heading": "East Asian studies", "type": "topical", "source": "claude_analysis"}, {"heading": "Burma/Myanmar", "type": "topical", "source": "claude_analysis"}, {"heading": "International relations", "type": "topical", "source": "claude_analysis"}, {"heading": "Bibliography", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This appears to be a bibliography or reference list page from an academic work", "source": "image_analysis"}, {"text": "Contains entries with mixed English and Chinese/Japanese characters", "source": "image_analysis"}, {"text": "Multiple entries reference works published in Showa period (Êò≠Âíå)", "source": "image_analysis"}, {"text": "References include publications from Tokyo, Shanghai, Nanjing", "source": "image_analysis"}, {"text": "Dates visible include 1930s-1940s publications", "source": "image_analysis"}, {"text": "Contains romanized Chinese names like 'Osaka Kyoshi'", "source": "image_analysis"}, {"text": "References include government documents and academic publications", "source": "image_analysis"}, {"text": "One entry mentions 'Cover exercises in the central China sea Section'", "source": "image_analysis"}, {"text": "Multiple entries reference Osaka-related publications", "source": "image_analysis"}, {"text": "Entry [1944] references 'Ida enso ombi' publication from Ulaghaii", "source": "image_analysis"}, {"text": "Several entries show 'Doi toa senso ombi' (Â§ßÊù±‰∫úÊà¶‰∫âÁßòË©±) titles", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.2, "publication": 0.0, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.35525}, "overall_confidence": 0.35525, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Â§ßÈò™ÁµåÊ∏àÊ≥ïÁßëÂ§ßÂ≠∏ÈóúË•øÁµåÊ∏àÁ†îÁ©∂ÊâÄ", "language": "Japanese", "location": "bibliography entry"}, {"text": "Osaka Â§ßÈò™: Osaka mainichi", "language": "Mixed Japanese-English", "location": "bibliography entry"}, {"text": "Doi toa senso ombi Â§ßÊù±‰∫úÊà¶‰∫âÁßòË©±", "language": "Japanese with romanization", "location": "bibliography entry"}, {"text": "Showa Êò≠Âíå (era designation)", "language": "Japanese", "location": "multiple bibliography entries"}, {"text": "Greater East Asia War Pictorial", "language": "English", "location": "bibliography entry"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 5}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg", "extracted_data": {"title": "T≈çky≈ç nichi nichi shinbunsha shinbun zasshi shinch≈ç", "creator": {"name": "Unknown", "type": "corporate", "source": "claude_analysis", "romanization": "T≈çky≈ç nichi nichi shinbunsha"}, "publication_date": "July 2019", "normalized_date": {"normalized": "2019", "end_date": null, "circa": false, "uncertain": false, "original": "July 2019"}, "format": "pamphlet", "language": "english with japanese references", "original_script_title": "Latin script with Japanese (Êù±‰∫¨Êó•Êñ∞ËÅûÁ§æ) mentioned", "other_identifiers": "Total issues held: 19. Cataloged July, 2019.", "subjects": [{"heading": "Japanese magazines", "type": "topical", "source": "claude_analysis"}, {"heading": "Japanese news", "type": "topical", "source": "claude_analysis"}, {"heading": "Admiral Seemu", "type": "topical", "source": "claude_analysis"}, {"heading": "Combined Fleet", "type": "topical", "source": "claude_analysis"}, {"heading": "Burma front", "type": "topical", "source": "claude_analysis"}, {"heading": "Koga commander", "type": "topical", "source": "claude_analysis"}, {"heading": "Indian Ocean", "type": "topical", "source": "claude_analysis"}, {"heading": "East Asia war", "type": "topical", "source": "claude_analysis"}, {"heading": "Greater East Asia", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This appears to be a catalog record or acquisition note for a Japanese illustrated magazine", "source": "image_analysis"}, {"text": "The text describes contents related to WWII Japanese naval and military operations", "source": "image_analysis"}, {"text": "References to Admiral Seemu (possibly referring to a specific naval commander)", "source": "image_analysis"}, {"text": "Mentions Combined Fleet, Burma front operations, and Indian Ocean campaigns", "source": "image_analysis"}, {"text": "Contains information about a commander of the Combined Fleet named Koga", "source": "image_analysis"}, {"text": "Material purchased from Utagawa123 via Ebay", "source": "image_analysis"}, {"text": "Text oriented vertically on page", "source": "image_analysis"}, {"text": "Holdings description indicating periodical/serial nature", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.675, "publication": 0.195, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.5640000000000001}, "overall_confidence": 0.5640000000000001, "claude_factors": {"text_clarity": "high", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "T≈çky≈ç nichi nichi shinbunsha Êù±‰∫¨Êó•Êñ∞ËÅûÁ§æ. A large format monthly illustrated magazine devoted to the news of Japan's war in greater East Asia. Includes a day by day summary of the month's news. Photographs are u&w only. Rear covers are advertisements. Contents: front cover: Admiral Seemu Toyoda, commander of the Combined Fleet, standing on the bridge, Indian Burma front. Scenes in Baganinville. Death of Admiral Mineichi Koga, commander of the combined fleet. Lotying Condition. Excellent. Disbound, with four small holes punched along edge, purchased from Utagawa123 via Ebay in the early 2000s. +++++ Total issues held: 19. Cataloged July, 2019.", "language": "English", "location": "verso or back page"}], "processing_notes": ["Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 6}], "collection_analysis": {"total_items": 6, "successful_extractions": 5, "common_characteristics": {"primary_language": "english, japanese, chinese", "language_distribution": {"english, japanese, chinese": 1, "jpn": 1, "eng": 1, "english with chinese and japanese script": 1, "english with japanese references": 1}, "primary_format": "book", "format_distribution": {"book": 2, "pamphlet": 2, "note": 1}}, "quality_assessment": {"average_confidence": 0.45315000000000005, "high_confidence_items": 0, "low_confidence_items": 4, "confidence_range": [0.35525, 0.5640000000000001]}, "recommendations": ["More than 30% of items have low confidence - consider manual review", "Multiple languages detected - verify language coding", "5 items contain CJK characters - verify romanization"]}, "batch_confidence": 0.37762500000000004, "processing_timestamp": "2025-12-22T16:27:54.277997"}, "individual_extractions": [{"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "extraction_confidence": 0.48425, "extracted_fields": ["title", "subtitle", "publication_place", "publication_date", "normalized_date", "format", "extent", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "extraction_confidence": 0.4365, "extracted_fields": ["title", "subtitle", "creator", "format", "extent", "dimensions", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "extraction_confidence": 0.42575, "extracted_fields": ["title", "format", "extent", "dimensions", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "extraction_confidence": 0.35525, "extracted_fields": ["title", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg", "extraction_confidence": 0.5640000000000001, "extracted_fields": ["title", "creator", "publication_date", "normalized_date", "format", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}]};
        const metadataData = {"workflow_type": "collection_images_to_marc", "collection_name": "JP-test", "processing_result": {"approach": "collection", "records_generated": 1, "review_required": true, "groupings": {"approach": "collection", "total_items": 5, "groups": [{"type": "collection", "items": ["The Shina Jihen Gaho", "Ê∫ÄÊ¥≤Âú∞ÁêÜ", "Bathroom", "Bibliography/Reference list page", "T≈çky≈ç nichi nichi shinbunsha shinbun zasshi shinch≈ç"], "record_type": "collection"}]}}, "collection_data": {"total_items": 5, "source_images": ["examples/Japanese Prints in OCLC/PXL_20251212_165807773.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165928834.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165802824.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165816342.jpg", "examples/Japanese Prints in OCLC/PXL_20251212_165825246.jpg"], "provenance": "Extracted from 6 images using marcsnarc"}, "batch_analysis_summary": {"total_images": 6, "successful_analyses": 5, "batch_confidence": 0.37762500000000004}, "processing_timestamp": "2025-12-22T16:27:54.279813"};
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize images array from gallery
            const thumbnails = document.querySelectorAll('.thumbnail');
            currentImages = Array.from(thumbnails).map(img => ({
                src: img.src,
                alt: img.alt
            }));
            
            // Initialize JSON trees
            if (analysisData && Object.keys(analysisData).length > 0) {
                renderJsonTree('analysis-tree', analysisData);
            }
            if (metadataData && Object.keys(metadataData).length > 0) {
                renderJsonTree('metadata-tree', metadataData);
            }
        });
        
        // Modal functions
        function openModal(index) {
            currentImageIndex = index;
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const counter = document.getElementById('modalCounter');
            
            if (currentImages[index]) {
                modalImage.src = currentImages[index].src;
                modalImage.alt = currentImages[index].alt;
                counter.textContent = `${index + 1} of ${currentImages.length}`;
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function changeImage(direction) {
            currentImageIndex = (currentImageIndex + direction + currentImages.length) % currentImages.length;
            openModal(currentImageIndex);
        }
        
        // Keyboard controls
        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'block') {
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft') changeImage(-1);
                if (e.key === 'ArrowRight') changeImage(1);
            }
        });
        
        // Close modal on background click
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        // JSON Tree rendering functions
        function renderJsonTree(containerId, data) {
            const container = document.getElementById(containerId);
            if (!container || !data) return;
            
            container.innerHTML = '';
            const tree = createTreeElement(data, '', 0);
            container.appendChild(tree);
        }
        
        function createTreeElement(value, key, level) {
            const wrapper = document.createElement('div');
            wrapper.style.marginLeft = `${level * 20}px`;
            wrapper.style.marginBottom = '3px';
            
            if (value && typeof value === 'object' && !Array.isArray(value)) {
                // Object
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                Object.entries(value).forEach(([childKey, childValue]) => {
                    children.appendChild(createTreeElement(childValue, childKey, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìÇ ${key} {${Object.keys(value).length}}</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else if (Array.isArray(value)) {
                // Array
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                value.forEach((item, index) => {
                    children.appendChild(createTreeElement(item, `[${index}]`, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìñ ${key} [${value.length}]</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else {
                // Primitive value
                const element = document.createElement('div');
                const valueStr = value === null ? 'null' : String(value);
                const valueType = typeof value;
                let color = '#4a5568';
                let icon = 'üìÑ';
                
                if (valueType === 'string') { color = '#38a169'; icon = 'üìù'; }
                else if (valueType === 'number') { color = '#d69e2e'; icon = 'üî¢'; }
                else if (valueType === 'boolean') { color = '#9f7aea'; icon = '‚úÖ'; }
                else if (value === null) { color = '#a0aec0'; icon = '‚ùå'; }
                
                element.innerHTML = `<span style="color: #2d3748; font-weight: 600;">${icon} ${key}:</span> <span style="color: ${color};">${valueType === 'string' ? '"' + valueStr + '"' : valueStr}</span>`;
                wrapper.appendChild(element);
            }
            
            return wrapper;
        }
        
        function expandAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñ∂')) {
                    span.parentElement.click();
                }
            });
        }
        
        function collapseAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñº')) {
                    span.parentElement.click();
                }
            });
        }
    </script>
</body>
</html>