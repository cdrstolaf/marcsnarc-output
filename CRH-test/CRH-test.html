<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>CRH-test - MARC Records</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; line-height: 1.6; background: #fafafa; }
        
        /* Header */
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 2em; font-weight: 300; }
        .header p { margin: 10px 0 0; opacity: 0.9; }
        
        /* Image Gallery */
        .image-gallery { display: flex; gap: 15px; overflow-x: auto; padding: 20px 0; margin-bottom: 30px; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .thumbnail-container { flex-shrink: 0; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .thumbnail-container:hover { transform: scale(1.02); box-shadow: 0 4px 15px rgba(0,0,0,0.15); }
        .thumbnail { width: 200px; height: 300px; object-fit: cover; border-radius: 8px; border: 3px solid #e0e0e0; transition: border-color 0.2s ease; }
        .thumbnail-container:hover .thumbnail { border-color: #667eea; }
        .thumbnail-label { text-align: center; margin-top: 8px; font-size: 0.85em; color: #666; font-weight: 500; word-break: break-word; max-width: 200px; }
        .no-images { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 90vw; max-height: 90vh; }
        .modal-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .modal-close { position: absolute; top: 15px; right: 20px; color: white; font-size: 30px; font-weight: bold; cursor: pointer; z-index: 1001; width: 40px; height: 40px; border-radius: 50%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .modal-close:hover { background: rgba(255,0,0,0.7); }
        .modal-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.5); color: white; border: none; padding: 15px 20px; font-size: 18px; cursor: pointer; border-radius: 5px; transition: background 0.2s ease; }
        .modal-nav:hover { background: rgba(0,0,0,0.8); }
        .modal-prev { left: 20px; }
        .modal-next { right: 20px; }
        .modal-counter { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: white; background: rgba(0,0,0,0.7); padding: 8px 16px; border-radius: 20px; font-size: 14px; }
        
        /* MARC Records */
        .records-section h2 { color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; margin: 30px 0 20px; }
        .marc-record { background: white; border: none; margin-bottom: 25px; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .marc-record h3 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .confidence { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); padding: 6px 12px; border-radius: 20px; display: inline-block; margin-bottom: 15px; color: #2c5530; font-weight: 500; font-size: 0.9em; }
        .review-flag { background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); border: none; color: #d63031; padding: 6px 12px; border-radius: 20px; margin-bottom: 15px; font-weight: 500; font-size: 0.9em; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 5px rgba(0,0,0,0.05); }
        th, td { padding: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #f0f0f0; }
        th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; width: 100px; }
        .subfield-code { font-weight: bold; color: #667eea; background: #f8f9ff; padding: 2px 4px; border-radius: 3px; margin-right: 5px; }
        .no-records { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* External API Results */
        .api-results-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .api-results-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .api-source { margin-bottom: 20px; }
        .api-source h3 { color: #667eea; margin-bottom: 10px; font-size: 1.1em; }
        .api-matches { background: #f8f9ff; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .api-match { background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 10px; margin-bottom: 10px; }
        .api-match:last-child { margin-bottom: 0; }
        .match-title { font-weight: 600; color: #333; margin-bottom: 5px; }
        .match-author { color: #666; margin-bottom: 5px; }
        .match-details { font-size: 0.9em; color: #888; }
        .no-matches { text-align: center; padding: 20px; color: #999; font-style: italic; }
        .authority-result { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 0.85em; margin-right: 10px; }
        .authority-valid { background: #d4edda; color: #155724; }
        .authority-invalid { background: #f8d7da; color: #721c24; }
        
        /* JSON Tree View */
        .json-tree-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .json-tree-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .tree-container { border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; background: #fafafa; max-height: 600px; overflow-y: auto; font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono", monospace; }
        .expand-all-btn, .collapse-all-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; margin-right: 10px; margin-bottom: 15px; font-size: 0.9em; transition: transform 0.2s ease; }
        .expand-all-btn:hover, .collapse-all-btn:hover { transform: translateY(-1px); }
        
        /* Footer */
        .footer { text-align: center; padding: 20px; color: #666; font-size: 0.9em; background: white; border-radius: 10px; margin-top: 30px; }
        .footer a { color: #667eea; text-decoration: none; font-weight: 500; }
        .footer a:hover { text-decoration: underline; }
        
        /* Responsive */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .thumbnail { width: 150px; height: 225px; }
            .thumbnail-label { max-width: 150px; }
            .modal-nav { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CRH-test</h1>
        <p>üìö MARC Records generated by marcsnarc on 2025-12-23 09:29:51</p>
    </div>
    
    <div class='image-gallery'>

                <div class='thumbnail-container' onclick='openModal(0)'>
                    <img src='img_PXL_20251212_164209737.webp' alt='PXL_20251212_164209737.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164209737.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(1)'>
                    <img src='img_PXL_20251212_164253582.webp' alt='PXL_20251212_164253582.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164253582.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(2)'>
                    <img src='img_PXL_20251212_164339517.webp' alt='PXL_20251212_164339517.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164339517.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(3)'>
                    <img src='img_PXL_20251212_164450342.webp' alt='PXL_20251212_164450342.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164450342.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(4)'>
                    <img src='img_PXL_20251212_164650783.webp' alt='PXL_20251212_164650783.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164650783.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(5)'>
                    <img src='img_PXL_20251212_164821071.webp' alt='PXL_20251212_164821071.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164821071.jpg</div>
                </div>
                </div>

    
    <!-- Modal for image viewing -->
    <div id="imageModal" class="modal">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <button class="modal-nav modal-prev" onclick="changeImage(-1)">‚Äπ</button>
        <button class="modal-nav modal-next" onclick="changeImage(1)">‚Ä∫</button>
        <div class="modal-content">
            <img id="modalImage" class="modal-image" src="" alt="">
        </div>
        <div class="modal-counter" id="modalCounter"></div>
    </div>
    
    <div class="records-section">
        <h2>üìã MARC Records</h2>
        <div class='marc-record'>
<h3>Record 1</h3>
<div class='confidence'>Confidence: 0.47</div>
<div class='review-flag'>‚ö†Ô∏è Review Required</div>
<table><tr><th>LDR</th><td>00000nam a200000 Ki 500</td></tr><tr><th>001</th><td>msn20251223152951</td></tr><tr><th>003</th><td>DLC</td></tr><tr><th>005</th><td>20251223152951.0</td></tr><tr><th>008</th><td>251223m19661967            o     00chi und d</td></tr><tr><th>040</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>DLC <span class="subfield-code">‚Ä°b</span>eng <span class="subfield-code">‚Ä°c</span>DLC <span class="subfield-code">‚Ä°e</span>rda </td></tr><tr><th>245</th><td><strong>00</strong> <span class="subfield-code">‚Ä°a</span>CRH-test </td></tr><tr><th>264</th><td><strong>_1</strong> <span class="subfield-code">‚Ä°c</span>1966 </td></tr><tr><th>300</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>6 items (various formats) </td></tr><tr><th>520</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection consists of 2 books, 4 other items. Items date from 1966 to 1967. </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection-level record for 6 items </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Provenance: Extracted from 6 images using marcsnarc </td></tr><tr><th>561</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Extracted from 6 images using marcsnarc </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Cultural Revolution </td></tr><tr><th>999</th><td><strong>__</strong> <span class="subfield-code">‚Ä°i</span>Generated by marcsnarc on 2025-12-23 <span class="subfield-code">‚Ä°s</span>marcsnarc </td></tr></table></div>

    </div>
    
    <div class="api-results-section">
<h2>üåê External API Results</h2>
<div class="api-source"><h3>Record 1</h3>
</div>
<div class="api-source"><h3>Record 2</h3>
</div>
</div>

    
    
            <div class='json-tree-section'>
                <h2>üìä Analysis Data</h2>
                <div class='tree-container' id='analysis-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("analysis-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("analysis-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
            <div class='json-tree-section'>
                <h2>üìã Processing Metadata</h2>
                <div class='tree-container' id='metadata-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("metadata-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("metadata-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
    
    <div class="footer">
        Generated with <a href="https://github.com/anthropics/marcsnarc">marcsnarc</a> - AI-powered MARC cataloging
    </div>
    
    <script>
        // Global variables for modal and JSON data
        let currentImages = [];
        let currentImageIndex = 0;
        const analysisData = {"collection_analysis": {"item_count": 6, "formats": {"format_counts": {"archival collection": 1, "manuscript|handbills": 1, "pamphlet": 2, "manuscript": 2}, "unique_formats": "{'pamphlet', 'manuscript|handbills', 'manuscript', 'archival collection'}", "books": 2, "serials": 0, "ephemera": 0, "other": 4, "primary_format": "pamphlet"}, "creators": {"creator_counts": {"Èü©Ë•øÂπ≥": 1, "Red Guards from 'Anti-revisionist Commune' (Âèç‰øÆÂÖ¨Á§æ)": 1, "‰∫∫Ê∞ëÊó•Êä• (Renmin Ribao / People's Daily)": 1}, "unique_creators": "{'Èü©Ë•øÂπ≥', \"‰∫∫Ê∞ëÊó•Êä• (Renmin Ribao / People's Daily)\", \"Red Guards from 'Anti-revisionist Commune' (Âèç‰øÆÂÖ¨Á§æ)\"}", "items_with_creators": 3, "items_without_creators": 3, "dominant_creator": ["Èü©Ë•øÂπ≥", 1]}, "dates": {"date_range": [1966, 1967], "earliest_date": 1966, "latest_date": 1967, "date_span": 1, "items_with_dates": 3, "date_counts": {"1966": 2, "1967": 1}}, "languages": {"language_counts": {"english (descriptive label); chinese (collection materials)": 1, "chi": 5}, "unique_languages": "{'english (descriptive label); chinese (collection materials)', 'chi'}", "primary_language": "chi", "multilingual": true}, "subjects": {"subject_counts": {"Chinese Cultural Revolution": 1, "handbills": 1, "guard groups": 1, "Red Guard": 1, "ephemera": 1, "Cultural Revolution": 3, "Railroad Elementary School": 1, "No. 27 revolutionary railroad middle school": 1, "Chinese revolutionary history": 1, "Educational materials": 1, "Property Law": 1, "Property Rights Law": 1, "Chinese law": 1, "Legal advocacy": 1, "Anti-corruption": 1, "Red Guards": 1, "Censorship": 1, "Books and songs ban": 1, "Anti-revisionist movement": 1, "Ouyang Hai (Ê¨ßÈò≥Êµ∑)": 1, "Chairman Mao study materials": 1, "People's Liberation Army (PLA)": 1, "Revolutionary youth": 1, "Mao Zedong thought": 1, "Chinese propaganda": 1, "Chinese manuscript": 1, "Personal correspondence or document": 1}, "unique_subjects": "{'Chinese propaganda', 'Books and songs ban', 'guard groups', 'Chinese manuscript', 'Mao Zedong thought', 'Anti-revisionist movement', 'Property Law', 'Personal correspondence or document', 'Red Guards', 'Revolutionary youth', 'Censorship', 'Anti-corruption', 'Ouyang Hai (Ê¨ßÈò≥Êµ∑)', 'ephemera', 'handbills', 'Property Rights Law', 'Legal advocacy', 'Railroad Elementary School', \"People's Liberation Army (PLA)\", 'Educational materials', 'Chairman Mao study materials', 'Chinese Cultural Revolution', 'Chinese law', 'Cultural Revolution', 'Chinese revolutionary history', 'No. 27 revolutionary railroad middle school', 'Red Guard'}", "items_with_subjects": 6, "common_subjects": [["Cultural Revolution", 3], ["Chinese Cultural Revolution", 1], ["handbills", 1], ["guard groups", 1], ["Red Guard", 1]], "subject_coherence": 2.435185185185185}, "provenance": {"collection_provenance": "Extracted from 6 images using marcsnarc", "item_provenances": {}, "consistency_score": 1.0, "has_provenance": true}, "identifiers": {"items_with_isbn": 0, "items_with_issn": 0, "items_with_oclc": 0, "items_with_lccn": 0, "identifier_coverage": 0.0}, "physical_characteristics": {"extent_variety": 6, "dimension_variety": 2, "physical_coherence": 0.33333333333333337}, "format_diversity": 4, "creator_diversity": 3, "has_books_serials": true, "shared_provenance": true, "temporal_coherence": 1.0, "workflow_type": "collection_images_to_marc", "collection_name": "CRH-test", "processing_timestamp": "2025-12-23T09:29:51.583514", "total_records": 1, "approach": "collection"}, "batch_analysis": {"collection_name": "CRH-test", "total_images": 6, "successful_analyses": 6, "failed_analyses": 0, "individual_results": [{"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164209737.jpg", "extracted_data": {"title": "Archived Box 5 Chinese Cultural Revolution handbills, plus printed miscellany", "publication_date": "1960s-1970s", "normalized_date": {"normalized": null, "end_date": null, "circa": false, "uncertain": true, "original": "1960s-1970s"}, "format": "archival collection", "extent": "1 box", "language": "english (descriptive label); chinese (collection materials)", "original_script_title": "Latin script on label; Chinese script in collection", "other_identifiers": "RWB collection; Arranged chronologically", "subjects": [{"heading": "Chinese Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "handbills", "type": "topical", "source": "claude_analysis"}, {"heading": "guard groups", "type": "topical", "source": "claude_analysis"}, {"heading": "Red Guard", "type": "topical", "source": "claude_analysis"}, {"heading": "ephemera", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Archival collection label describing contents", "source": "image_analysis"}, {"text": "Contains handbills from Cultural Revolution period", "source": "image_analysis"}, {"text": "Items organized chronologically", "source": "image_analysis"}, {"text": "Includes handbills from 1960s-1970s period", "source": "image_analysis"}, {"text": "Yellow sticky note with handwritten text visible: 'Cultural Revolution handbills handbills Dec.-1975 #3 in 4.20'", "source": "image_analysis"}, {"text": "Label mentions specific groups including 'Red Guard' and various revolutionary organizations", "source": "image_analysis"}, {"text": "Collection includes printed miscellany beyond handbills", "source": "image_analysis"}, {"text": "Reference to 'People's Daily of Liberation Daily' and other newspapers", "source": "image_analysis"}, {"text": "Materials described as being from local and led guard groups", "source": "image_analysis"}, {"text": "Label notes items are 'spokesmen of a revolutionary'", "source": "image_analysis"}, {"text": "RWB collection designation suggests institutional archival holding", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.2, "publication": 0.15166666666666667, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.38558333333333333}, "overall_confidence": 0.38558333333333333, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Archived Box 5 Chinese Cultural Revolution handbills, plus printed miscellany\n\nRWB collection\n\nArranged chronologically\n\nA    Handbills, leaflets, newspaper extras\n\nNB. The nearly items listed below were all acquired in Hofbei in the late 80s. They are a mixture of posters and printed pieces. While & Gong Zin group numbers; Nos. 1, 2, and 3...such as proposals to change local place names, front local led guard groups, and all items are unbound spokesmen of a revolutionary minority. Some items are labels or headings that represent a selection from a larger folder...These leaflets represent a selection that only ephemeral \"These leaflets represent a slightly fragmented in relation to ephemeral revolutionary organizations with their radion on brief existences. I have put only public activities, not and whether the group represented were long-lasting or not ephemeral. These leaflets represent a slightly fragmented in relation to one brief existences.\" at a People's Daily of Liberation Daily --RWB, 2021-12-30", "language": "English", "location": "archival label"}, {"text": "Cultural Revolution handbills handbills Dec.-1975 #3 in 4.20", "language": "English", "location": "yellow sticky note"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 1}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164650783.jpg", "extracted_data": {"title": "Railroad Revision - Handbills", "subtitle": "Three page leaflet from Railroad Elementary - #27 middle school", "publication_place": "China", "publication_date": "1966-67", "normalized_date": {"normalized": "1966", "end_date": null, "circa": false, "uncertain": false, "original": "1966-67"}, "format": "manuscript|handbills", "extent": "Multiple pages - handwritten manuscript and printed leaflet", "language": "chi", "original_script_title": "Simplified Chinese characters", "other_identifiers": "Item #: 1736.7.7", "subjects": [{"heading": "Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "Railroad Elementary School", "type": "topical", "source": "claude_analysis"}, {"heading": "No. 27 revolutionary railroad middle school", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese revolutionary history", "type": "topical", "source": "claude_analysis"}, {"heading": "Educational materials", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Yellow sticky note indicates: '1736.7.7, Railroad Revision - Handbills, Three page leaflet from Railroad to the #27 middle school'", "source": "image_analysis"}, {"text": "Dated '3.1.67.12.24'", "source": "image_analysis"}, {"text": "Contains handwritten manuscript pages in blue ink with simplified Chinese characters", "source": "image_analysis"}, {"text": "Accompanied by English language descriptive text about railroad school conflict during Cultural Revolution period", "source": "image_analysis"}, {"text": "Reference to September 1966 events", "source": "image_analysis"}, {"text": "Mentions Mao Zedong zhiyi (quotations)", "source": "image_analysis"}, {"text": "Materials related to conflict between No. 27 railroad middle school and Railroad Elementary School", "source": "image_analysis"}, {"text": "Document discusses revolutionary committees and party organizations", "source": "image_analysis"}, {"text": "Text mentions Wu Fenglan and other individuals involved in revolutionary activities", "source": "image_analysis"}, {"text": "Page numbered with circled '1' visible", "source": "image_analysis"}, {"text": "Materials stored in plastic protective sleeve", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.2, "publication": 0.30333333333333334, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.41591666666666666}, "overall_confidence": 0.41591666666666666, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "1736.7.7\nRailroad Revision - Handbills\nThree page leaflet from Railroad to the #27 middle school\n3.1.67.12.24", "language": "English", "location": "yellow sticky note"}, {"text": "[Extensive handwritten Chinese text visible on manuscript page]", "language": "Chinese (Simplified)", "location": "manuscript page"}, {"text": "1966-67. Three page leaflet from red guards of the No. 27 revolutionary railroad middle school in conflict with the railroad elementary school.\nHeadline: ÈìÅË∑ØÁ†∏ÁÉÇÔºÅÔºÅ\n(Trans: 'Specially target three!'\nPublished: ‰∏Ä‰∫å.‰∫åÂõõÈìÅË∑ØÈù©ÂëΩÂ∞èÈÄ†ÂèçÊÄªÂÖµ Iz qi coming to zhong Mao Zedong zhiyi", "language": "English with Chinese", "location": "descriptive sheet"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 2}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164821071.jpg", "extracted_data": {"title": "ÂΩªÂ∫ïÊã•Êä§„ÄäÁâ©ÊùÉÊ≥ï„Äã", "subtitle": "‰∫åÂçÅ‰∏ÉÂπ¥ÂëêÂñäÔºåÁâ©ÊùÉÂèçËÖêÁªàÊî∂Á°ïÊûú", "creator": {"name": "Èü©Ë•øÂπ≥", "type": "personal", "source": "claude_analysis", "romanization": "Han Xiping"}, "format": "pamphlet", "extent": "Single sheet, multi-column text", "language": "chi", "original_script_title": "Chinese characters (Simplified)", "subjects": [{"heading": "Property Law", "type": "topical", "source": "claude_analysis"}, {"heading": "Property Rights Law", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese law", "type": "topical", "source": "claude_analysis"}, {"heading": "Legal advocacy", "type": "topical", "source": "claude_analysis"}, {"heading": "Anti-corruption", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document appears to be a personal advocacy or opinion piece", "source": "image_analysis"}, {"text": "Yellow sticky note with handwritten text in Chinese attached", "source": "image_analysis"}, {"text": "Text discusses property rights law in China", "source": "image_analysis"}, {"text": "References '27 years of advocacy' in relation to property rights reform", "source": "image_analysis"}, {"text": "Contains dense Chinese text in multiple columns", "source": "image_analysis"}, {"text": "Document appears to be a photocopy or printed sheet", "source": "image_analysis"}, {"text": "Handwritten note visible on yellow sticky note", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.0, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.4365}, "overall_confidence": 0.4365, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "ÂΩªÂ∫ïÊã•Êä§„ÄäÁâ©ÊùÉÊ≥ï„Äã‚Äî‚Äî‰∫åÂçÅ‰∏ÉÂπ¥ÂëêÂñäÔºåÁâ©ÊùÉÂèçËÖêÁªàÊî∂Á°ïÊûú", "language": "Chinese (Simplified)", "location": "title"}, {"text": "Èü©Ë•øÂπ≥", "language": "Chinese (Simplified)", "location": "author byline (left side)"}, {"text": "Handwritten note on yellow sticky (partially legible)", "language": "Chinese (Simplified)", "location": "sticky note overlay"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 3}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164339517.jpg", "extracted_data": {"title": "Urgent appeal to ban some books and songs, from red guards in the 'Anti-revisionist Commune'", "creator": {"name": "Red Guards from 'Anti-revisionist Commune' (Âèç‰øÆÂÖ¨Á§æ)", "type": "corporate", "source": "claude_analysis", "romanization": "Fanxiu Gongshe"}, "publication_place": "Huangniujing (ÈªÑÁâõ‰∫ï), Fuxin (ÈòúÊñ∞)", "publication_date": "1967 (based on contextual information mentioning 1958 as reference point)", "normalized_date": {"normalized": "1967", "end_date": null, "circa": true, "uncertain": false, "original": "1967 (based on contextual information mentioning 1958 as reference point)"}, "format": "manuscript", "extent": "Multiple pages, appears to be a handwritten document with typed explanatory sheet", "language": "chi", "original_script_title": "Simplified Chinese characters", "other_identifiers": "42 (as marked on yellow note); 67.66.8.27 (cataloging number)", "subjects": [{"heading": "Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "Red Guards", "type": "topical", "source": "claude_analysis"}, {"heading": "Censorship", "type": "topical", "source": "claude_analysis"}, {"heading": "Books and songs ban", "type": "topical", "source": "claude_analysis"}, {"heading": "Anti-revisionist movement", "type": "topical", "source": "claude_analysis"}, {"heading": "Ouyang Hai (Ê¨ßÈò≥Êµ∑)", "type": "topical", "source": "claude_analysis"}, {"heading": "Chairman Mao study materials", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document appears to be preserved in archival plastic sleeve", "source": "image_analysis"}, {"text": "Yellow sticky note indicates: 'Cultural Revolution materials Urgent appeal to ban some books & songs from Red Guards in 'H.L.' anti-revisionist Commune'", "source": "image_analysis"}, {"text": "Includes English explanatory sheet describing context of the appeal", "source": "image_analysis"}, {"text": "Document originates from Huangniujing Commune, Fuxin County", "source": "image_analysis"}, {"text": "References burning of books deemed 'black books' under influence of Beijing Party committee", "source": "image_analysis"}, {"text": "Mentions concern about banning Ouyang Hai study materials and songs borrowed from commune", "source": "image_analysis"}, {"text": "Context indicates this was during period when red guards proposed banning works they deemed ideologically incorrect", "source": "image_analysis"}, {"text": "Document notes villagers may face consequences if banned materials found in their possession", "source": "image_analysis"}, {"text": "References Chairman Mao and related study materials being caught in the ban", "source": "image_analysis"}, {"text": "Warning about staple in plastic sleeve to avoid cuts", "source": "image_analysis"}, {"text": "Handwritten Chinese text appears to be original petition or appeal document", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.30333333333333334, "format": 0.5850000000000001, "language": 0.5850000000000001, "overall": 0.5166666666666666}, "overall_confidence": 0.5166666666666666, "claude_factors": {"text_clarity": "medium", "completeness": "high", "language_certainty": "high"}, "original_text_regions": [{"text": "67.66.8.27 Urgent appeal to ban some books and songs, from red guards in the 'Anti-revisionist Commune' Âèç‰øÆÂÖ¨Á§æÁ∫¢Âç´ÂÖµÂëºÂêÅ!!!", "language": "English and Chinese", "location": "catalog description sheet"}, {"text": "Âèç‰øÆÂÖ¨Á§æ", "language": "Chinese (Simplified)", "location": "catalog sheet (Anti-revisionist Commune)"}, {"text": "ÈªÑÁâõ‰∫ïÂÖ¨Á§æ", "language": "Chinese (Simplified)", "location": "catalog sheet (Huangniujing Commune)"}, {"text": "Ê¨ßÈò≥Êµ∑", "language": "Chinese (Simplified)", "location": "catalog sheet (Ouyang Hai)"}, {"text": "ÂÆâÂÆöÂØπÂè∂!!! [handwritten Chinese text continues on main document page]", "language": "Chinese (Simplified)", "location": "manuscript body"}, {"text": "42", "language": "Number", "location": "yellow sticky note"}], "processing_notes": ["Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 4}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164450342.jpg", "extracted_data": {"title": "Èù©ÂëΩÈùíÂ∞ëÂπ¥Ë¶ÅÂêëËß£ÊîæÂÜõÂ≠¶‰π†", "subtitle": "‰∫∫Ê∞ëÊó•Êä•ÂÖ´Êúà‰∫åÂçÅÂÖ´Êó•Á§æËÆ∫", "creator": {"name": "‰∫∫Ê∞ëÊó•Êä• (Renmin Ribao / People's Daily)", "type": "corporate", "source": "claude_analysis", "romanization": "Renmin Ribao"}, "publisher": "‰∫∫Ê∞ëÊó•Êä• (People's Daily)", "publication_place": "‰∏≠ÂõΩ (China)", "publication_date": "1966-08-28", "normalized_date": {"normalized": "1966", "end_date": null, "circa": false, "uncertain": false, "original": "1966-08-28"}, "format": "pamphlet", "extent": "Single sheet, printed on one side", "dimensions": "Appears to be approximately A4 or similar size", "language": "chi", "original_script_title": "Simplified Chinese", "other_identifiers": "ID: 1986079.3.28 (as noted on yellow sticky note)", "subjects": [{"heading": "Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "People's Liberation Army (PLA)", "type": "topical", "source": "claude_analysis"}, {"heading": "Revolutionary youth", "type": "topical", "source": "claude_analysis"}, {"heading": "Mao Zedong thought", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese propaganda", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This is a Cultural Revolution era editorial from People's Daily dated August 28, 1966", "source": "image_analysis"}, {"text": "Document includes a prominent quotation box at top with Maoist slogans about reading Mao's books, listening to his words, following his instructions, and being a good soldier", "source": "image_analysis"}, {"text": "Yellow sticky note indicates archival cataloging information mentioning 'Cultural Revolution and rebels' and 'Peoples Daily editorial from August 1966'", "source": "image_analysis"}, {"text": "White label provides English description noting the year is 1966, mentions Liu Biao's directive and references to PLA heroes", "source": "image_analysis"}, {"text": "Text is printed in red ink on cream/beige colored paper", "source": "image_analysis"}, {"text": "Document appears to be in protective plastic sleeve for archival preservation", "source": "image_analysis"}, {"text": "Typical propaganda document from height of Cultural Revolution period", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.675, "publication": 0.5850000000000001, "format": 0.5850000000000001, "language": 0.5850000000000001, "overall": 0.6615}, "overall_confidence": 0.6615, "claude_factors": {"text_clarity": "high", "completeness": "high", "language_certainty": "high"}, "original_text_regions": [{"text": "ËØªÊØõ‰∏ªÂ∏≠ÁöÑ‰π¶ÔºåÂê¨ÊØõ‰∏ªÂ∏≠ÁöÑËØùÔºåÁÖßÊØõ‰∏ªÂ∏≠ÁöÑÊåáÁ§∫Âäû‰∫ãÔºåÂÅöÊØõ‰∏ªÂ∏≠ÁöÑÂ•ΩÊàòÂ£´„ÄÇ", "language": "Simplified Chinese", "location": "top quotation box"}, {"text": "Èù©ÂëΩÈùíÂ∞ëÂπ¥Ë¶ÅÂêëËß£ÊîæÂÜõÂ≠¶‰π†", "language": "Simplified Chinese", "location": "main title"}, {"text": "(‰∫∫Ê∞ëÊó•Êä•ÂÖ´Êúà‰∫åÂçÅÂÖ´Êó•Á§æËÆ∫)", "language": "Simplified Chinese", "location": "subtitle"}, {"text": "1966. 8.28\nCultural Revolution and rebels\nPeoples Daily editorial from August 1966", "language": "English", "location": "yellow sticky note annotation"}], "processing_notes": ["Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 5}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164253582.jpg", "extracted_data": {"title": "ÂÖ´‰∏Ä", "format": "manuscript", "extent": "1 sheet", "dimensions": "Approximately A4 or similar size", "language": "chi", "original_script_title": "Traditional Chinese characters", "other_identifiers": "1998.2.3 (visible on document)", "subjects": [{"heading": "Chinese manuscript", "type": "topical", "source": "claude_analysis"}, {"heading": "Personal correspondence or document", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document appears to be a handwritten Chinese manuscript with traditional characters", "source": "image_analysis"}, {"text": "Contains vertical text written from right to left in traditional format", "source": "image_analysis"}, {"text": "Accompanied by a yellow sticky note with handwritten text in Latin script mentioning 'Hung-Yuan Rare Book Collection' and what appears to be catalog information", "source": "image_analysis"}, {"text": "A white printed sheet is also present containing English text about 'DINGXIN WU' and appears to be descriptive or cataloging information referencing 'Biographical Dictionary' and 'Guoyu Dictionary'", "source": "image_analysis"}, {"text": "Document shows signs of age with some discoloration", "source": "image_analysis"}, {"text": "Paper clip attached to the manuscript sheet", "source": "image_analysis"}, {"text": "Items appear to be archival materials being cataloged or processed", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.45499999999999996, "creator": 0.2, "publication": 0.0, "format": 0.26, "language": 0.5850000000000001, "overall": 0.284}, "overall_confidence": 0.284, "claude_factors": {"text_clarity": "medium", "completeness": "low", "language_certainty": "high"}, "original_text_regions": [{"text": "ÂÖ´‰∏Ä", "language": "Chinese", "location": "top right of manuscript"}, {"text": "1998.2.3", "language": "Arabic numerals", "location": "upper portion of manuscript"}, {"text": "Hung-Yuan Rare Book Collection / Ê¥™ÈüªÈõ®ËóèÂñÑÊú¨ / Hung-Yuan Chang Shen Ben", "language": "English and Chinese", "location": "yellow sticky note"}, {"text": "DINGXIN WU... [partial English text visible on white sheet regarding biographical information]", "language": "English", "location": "white descriptive sheet"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Bibliographic information appears incomplete in image", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 6}], "collection_analysis": {"total_items": 6, "successful_extractions": 6, "common_characteristics": {"primary_language": "chi", "language_distribution": {"english (descriptive label); chinese (collection materials)": 1, "chi": 5}, "primary_format": "pamphlet", "format_distribution": {"archival collection": 1, "manuscript|handbills": 1, "pamphlet": 2, "manuscript": 2}, "publishers": {"‰∫∫Ê∞ëÊó•Êä• (People's Daily)": 1}}, "quality_assessment": {"average_confidence": 0.45002777777777775, "high_confidence_items": 0, "low_confidence_items": 4, "confidence_range": [0.284, 0.6615]}, "recommendations": ["More than 30% of items have low confidence - consider manual review", "Multiple languages detected - verify language coding", "6 items contain CJK characters - verify romanization"]}, "batch_confidence": 0.45002777777777775, "processing_timestamp": "2025-12-23T09:29:51.493150"}, "individual_extractions": [{"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164209737.jpg", "extraction_confidence": 0.38558333333333333, "extracted_fields": ["title", "publication_date", "normalized_date", "format", "extent", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164650783.jpg", "extraction_confidence": 0.41591666666666666, "extracted_fields": ["title", "subtitle", "publication_place", "publication_date", "normalized_date", "format", "extent", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164821071.jpg", "extraction_confidence": 0.4365, "extracted_fields": ["title", "subtitle", "creator", "format", "extent", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164339517.jpg", "extraction_confidence": 0.5166666666666666, "extracted_fields": ["title", "creator", "publication_place", "publication_date", "normalized_date", "format", "extent", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164450342.jpg", "extraction_confidence": 0.6615, "extracted_fields": ["title", "subtitle", "creator", "publisher", "publication_place", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164253582.jpg", "extraction_confidence": 0.284, "extracted_fields": ["title", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}], "external_api_results": [{"worldcat": [], "loc": [], "alma": [], "best_match": null}]};
        const metadataData = {"workflow_type": "collection_images_to_marc", "collection_name": "CRH-test", "processing_result": {"approach": "collection", "records_generated": 1, "review_required": true, "groupings": {"approach": "collection", "total_items": 6, "groups": [{"type": "collection", "items": ["Archived Box 5 Chinese Cultural Revolution handbills, plus printed miscellany", "Railroad Revision - Handbills", "ÂΩªÂ∫ïÊã•Êä§„ÄäÁâ©ÊùÉÊ≥ï„Äã", "Urgent appeal to ban some books and songs, from red guards in the 'Anti-revisionist Commune'", "Èù©ÂëΩÈùíÂ∞ëÂπ¥Ë¶ÅÂêëËß£ÊîæÂÜõÂ≠¶‰π†", "ÂÖ´‰∏Ä"], "record_type": "collection"}]}}, "collection_data": {"total_items": 6, "source_images": ["examples/Cultural Revolution Handbills/PXL_20251212_164209737.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164650783.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164821071.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164339517.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164450342.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164253582.jpg"], "provenance": "Extracted from 6 images using marcsnarc"}, "batch_analysis_summary": {"total_images": 6, "successful_analyses": 6, "batch_confidence": 0.45002777777777775}, "processing_timestamp": "2025-12-23T09:29:51.583528"};
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize images array from gallery
            const thumbnails = document.querySelectorAll('.thumbnail');
            currentImages = Array.from(thumbnails).map(img => ({
                src: img.src,
                alt: img.alt
            }));
            
            // Initialize JSON trees
            if (analysisData && Object.keys(analysisData).length > 0) {
                renderJsonTree('analysis-tree', analysisData);
            }
            if (metadataData && Object.keys(metadataData).length > 0) {
                renderJsonTree('metadata-tree', metadataData);
            }
        });
        
        // Modal functions
        function openModal(index) {
            currentImageIndex = index;
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const counter = document.getElementById('modalCounter');
            
            if (currentImages[index]) {
                modalImage.src = currentImages[index].src;
                modalImage.alt = currentImages[index].alt;
                counter.textContent = `${index + 1} of ${currentImages.length}`;
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function changeImage(direction) {
            currentImageIndex = (currentImageIndex + direction + currentImages.length) % currentImages.length;
            openModal(currentImageIndex);
        }
        
        // Keyboard controls
        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'block') {
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft') changeImage(-1);
                if (e.key === 'ArrowRight') changeImage(1);
            }
        });
        
        // Close modal on background click
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        // JSON Tree rendering functions
        function renderJsonTree(containerId, data) {
            const container = document.getElementById(containerId);
            if (!container || !data) return;
            
            container.innerHTML = '';
            const tree = createTreeElement(data, '', 0);
            container.appendChild(tree);
        }
        
        function createTreeElement(value, key, level) {
            const wrapper = document.createElement('div');
            wrapper.style.marginLeft = `${level * 20}px`;
            wrapper.style.marginBottom = '3px';
            
            if (value && typeof value === 'object' && !Array.isArray(value)) {
                // Object
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                Object.entries(value).forEach(([childKey, childValue]) => {
                    children.appendChild(createTreeElement(childValue, childKey, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìÇ ${key} {${Object.keys(value).length}}</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else if (Array.isArray(value)) {
                // Array
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                value.forEach((item, index) => {
                    children.appendChild(createTreeElement(item, `[${index}]`, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìñ ${key} [${value.length}]</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else {
                // Primitive value
                const element = document.createElement('div');
                const valueStr = value === null ? 'null' : String(value);
                const valueType = typeof value;
                let color = '#4a5568';
                let icon = 'üìÑ';
                
                if (valueType === 'string') { color = '#38a169'; icon = 'üìù'; }
                else if (valueType === 'number') { color = '#d69e2e'; icon = 'üî¢'; }
                else if (valueType === 'boolean') { color = '#9f7aea'; icon = '‚úÖ'; }
                else if (value === null) { color = '#a0aec0'; icon = '‚ùå'; }
                
                element.innerHTML = `<span style="color: #2d3748; font-weight: 600;">${icon} ${key}:</span> <span style="color: ${color};">${valueType === 'string' ? '"' + valueStr + '"' : valueStr}</span>`;
                wrapper.appendChild(element);
            }
            
            return wrapper;
        }
        
        function expandAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñ∂')) {
                    span.parentElement.click();
                }
            });
        }
        
        function collapseAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñº')) {
                    span.parentElement.click();
                }
            });
        }
    </script>
</body>
</html>