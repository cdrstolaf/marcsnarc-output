<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>CRH-test - MARC Records</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; line-height: 1.6; background: #fafafa; }
        
        /* Header */
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 2em; font-weight: 300; }
        .header p { margin: 10px 0 0; opacity: 0.9; }
        
        /* Image Gallery */
        .image-gallery { display: flex; gap: 15px; overflow-x: auto; padding: 20px 0; margin-bottom: 30px; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .thumbnail-container { flex-shrink: 0; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .thumbnail-container:hover { transform: scale(1.02); box-shadow: 0 4px 15px rgba(0,0,0,0.15); }
        .thumbnail { width: 200px; height: 300px; object-fit: cover; border-radius: 8px; border: 3px solid #e0e0e0; transition: border-color 0.2s ease; }
        .thumbnail-container:hover .thumbnail { border-color: #667eea; }
        .thumbnail-label { text-align: center; margin-top: 8px; font-size: 0.85em; color: #666; font-weight: 500; word-break: break-word; max-width: 200px; }
        .no-images { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 90vw; max-height: 90vh; }
        .modal-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .modal-close { position: absolute; top: 15px; right: 20px; color: white; font-size: 30px; font-weight: bold; cursor: pointer; z-index: 1001; width: 40px; height: 40px; border-radius: 50%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .modal-close:hover { background: rgba(255,0,0,0.7); }
        .modal-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.5); color: white; border: none; padding: 15px 20px; font-size: 18px; cursor: pointer; border-radius: 5px; transition: background 0.2s ease; }
        .modal-nav:hover { background: rgba(0,0,0,0.8); }
        .modal-prev { left: 20px; }
        .modal-next { right: 20px; }
        .modal-counter { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: white; background: rgba(0,0,0,0.7); padding: 8px 16px; border-radius: 20px; font-size: 14px; }
        
        /* MARC Records */
        .records-section h2 { color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; margin: 30px 0 20px; }
        .marc-record { background: white; border: none; margin-bottom: 25px; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .marc-record h3 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .confidence { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); padding: 6px 12px; border-radius: 20px; display: inline-block; margin-bottom: 15px; color: #2c5530; font-weight: 500; font-size: 0.9em; }
        .review-flag { background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); border: none; color: #d63031; padding: 6px 12px; border-radius: 20px; margin-bottom: 15px; font-weight: 500; font-size: 0.9em; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 5px rgba(0,0,0,0.05); }
        th, td { padding: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #f0f0f0; }
        th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; width: 100px; }
        .subfield-code { font-weight: bold; color: #667eea; background: #f8f9ff; padding: 2px 4px; border-radius: 3px; margin-right: 5px; }
        .no-records { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* External API Results */
        .api-results-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .api-results-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .api-summary { background: #f8f9ff; border: 1px solid #e0e6ff; border-radius: 6px; padding: 12px; margin-bottom: 20px; }
        .api-summary p { margin: 0; color: #333; font-size: 0.95em; }
        .api-source { margin-bottom: 20px; }
        .api-source h3 { color: #667eea; margin-bottom: 10px; font-size: 1.1em; }
        .api-matches { background: #f8f9ff; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .api-match { background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 10px; margin-bottom: 10px; }
        .api-match:last-child { margin-bottom: 0; }
        .match-title { font-weight: 600; color: #333; margin-bottom: 5px; }
        .match-author { color: #666; margin-bottom: 5px; }
        .match-details { font-size: 0.9em; color: #888; }
        .no-matches { text-align: center; padding: 20px; color: #999; font-style: italic; }
        .api-no-results { }
        .search-details { background: #f8f9fa; border-radius: 6px; padding: 15px; margin-top: 15px; }
        .search-details h4 { margin-top: 0; color: #495057; }
        .search-details ul { margin: 10px 0; padding-left: 20px; }
        .search-details li { margin-bottom: 5px; color: #6c757d; }
        .search-details em { color: #6c757d; }
        .authority-result { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 0.85em; margin-right: 10px; }
        .authority-valid { background: #d4edda; color: #155724; }
        .authority-invalid { background: #f8d7da; color: #721c24; }
        
        /* JSON Tree View */
        .json-tree-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .json-tree-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .tree-container { border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; background: #fafafa; max-height: 600px; overflow-y: auto; font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono", monospace; }
        .expand-all-btn, .collapse-all-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; margin-right: 10px; margin-bottom: 15px; font-size: 0.9em; transition: transform 0.2s ease; }
        .expand-all-btn:hover, .collapse-all-btn:hover { transform: translateY(-1px); }
        
        /* Footer */
        .footer { text-align: center; padding: 20px; color: #666; font-size: 0.9em; background: white; border-radius: 10px; margin-top: 30px; }
        .footer a { color: #667eea; text-decoration: none; font-weight: 500; }
        .footer a:hover { text-decoration: underline; }
        
        /* Responsive */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .thumbnail { width: 150px; height: 225px; }
            .thumbnail-label { max-width: 150px; }
            .modal-nav { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CRH-test</h1>
        <p>üìö MARC Records generated by marcsnarc on 2025-12-23 13:47:10</p>
    </div>
    
    <div class='image-gallery'>

                <div class='thumbnail-container' onclick='openModal(0)'>
                    <img src='img_PXL_20251212_164209737.webp' alt='PXL_20251212_164209737.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164209737.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(1)'>
                    <img src='img_PXL_20251212_164253582.webp' alt='PXL_20251212_164253582.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164253582.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(2)'>
                    <img src='img_PXL_20251212_164339517.webp' alt='PXL_20251212_164339517.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164339517.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(3)'>
                    <img src='img_PXL_20251212_164450342.webp' alt='PXL_20251212_164450342.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164450342.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(4)'>
                    <img src='img_PXL_20251212_164650783.webp' alt='PXL_20251212_164650783.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164650783.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(5)'>
                    <img src='img_PXL_20251212_164821071.webp' alt='PXL_20251212_164821071.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164821071.jpg</div>
                </div>
                </div>

    
    <!-- Modal for image viewing -->
    <div id="imageModal" class="modal">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <button class="modal-nav modal-prev" onclick="changeImage(-1)">‚Äπ</button>
        <button class="modal-nav modal-next" onclick="changeImage(1)">‚Ä∫</button>
        <div class="modal-content">
            <img id="modalImage" class="modal-image" src="" alt="">
        </div>
        <div class="modal-counter" id="modalCounter"></div>
    </div>
    
    <div class="records-section">
        <h2>üìã MARC Records</h2>
        <div class='marc-record'>
<h3>Record 1</h3>
<div class='confidence'>Confidence: 0.47</div>
<div class='review-flag'>‚ö†Ô∏è Review Required</div>
<table><tr><th>LDR</th><td>00000nam a200000 Ki 500</td></tr><tr><th>001</th><td>msn20251223194710</td></tr><tr><th>003</th><td>DLC</td></tr><tr><th>005</th><td>20251223194710.0</td></tr><tr><th>008</th><td>251223s1966                o     00chi und d</td></tr><tr><th>040</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>DLC <span class="subfield-code">‚Ä°b</span>eng <span class="subfield-code">‚Ä°c</span>DLC <span class="subfield-code">‚Ä°e</span>rda </td></tr><tr><th>245</th><td><strong>00</strong> <span class="subfield-code">‚Ä°a</span>CRH-test </td></tr><tr><th>264</th><td><strong>_1</strong> <span class="subfield-code">‚Ä°c</span>1966 </td></tr><tr><th>300</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>6 items (various formats) </td></tr><tr><th>520</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection consists of 2 books, 4 other items. Items date from 1966 to 1966. </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection-level record for 6 items </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Provenance: Extracted from 6 images using marcsnarc </td></tr><tr><th>561</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Extracted from 6 images using marcsnarc </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Cultural Revolution </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Political propaganda </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Red Guards </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Chinese political movements </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Mao Zedong thought </td></tr><tr><th>999</th><td><strong>__</strong> <span class="subfield-code">‚Ä°i</span>Generated by marcsnarc on 2025-12-23 <span class="subfield-code">‚Ä°s</span>marcsnarc </td></tr></table></div>

    </div>
    
    <div class="api-results-section">
<h2>üåê External API Results</h2>
<div class="api-summary">
<p><strong>Search Summary:</strong> 2 item(s) searched across WorldCat, Library of Congress, and Alma catalogs</p>
</div>
<div class="api-source"><h3>Record 1</h3>
<div class="api-source">
<h3>üèõÔ∏è Library of Congress Authority Validation</h3>
<div class="api-matches">
<div class="api-match">
<div class="match-title">subject_authority: Cultural Revolution</div>
<span class="authority-result authority-invalid">‚ùå Not found</span>
</div>
<div class="api-match">
<div class="match-title">subject_authority: Political propaganda</div>
<span class="authority-result authority-invalid">‚ùå Not found</span>
</div>
<div class="api-match">
<div class="match-title">subject_authority: Red Guards</div>
<span class="authority-result authority-invalid">‚ùå Not found</span>
</div>
</div>
</div>
</div>
<div class="api-source"><h3>Record 2</h3>
<div class="api-source">
<h3>üèõÔ∏è Library of Congress Authority Validation</h3>
<div class="api-matches">
<div class="api-match">
<div class="match-title">subject_authority: Cultural Revolution</div>
<span class="authority-result authority-invalid">‚ùå Not found</span>
</div>
<div class="api-match">
<div class="match-title">subject_authority: Political propaganda</div>
<span class="authority-result authority-invalid">‚ùå Not found</span>
</div>
<div class="api-match">
<div class="match-title">subject_authority: Red Guards</div>
<span class="authority-result authority-invalid">‚ùå Not found</span>
</div>
</div>
</div>
</div>
</div>

    
    
            <div class='json-tree-section'>
                <h2>üìä Analysis Data</h2>
                <div class='tree-container' id='analysis-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("analysis-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("analysis-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
            <div class='json-tree-section'>
                <h2>üìã Processing Metadata</h2>
                <div class='tree-container' id='metadata-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("metadata-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("metadata-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
    
    <div class="footer">
        Generated with <a href="https://github.com/anthropics/marcsnarc">marcsnarc</a> - AI-powered MARC cataloging
    </div>
    
    <script>
        // Global variables for modal and JSON data
        let currentImages = [];
        let currentImageIndex = 0;
        const analysisData = {"collection_analysis": {"item_count": 6, "formats": {"format_counts": {"archival collection|pamphlet collection": 1, "manuscript": 3, "book": 1, "pamphlet": 1}, "unique_formats": "{'archival collection|pamphlet collection', 'book', 'manuscript', 'pamphlet'}", "books": 2, "serials": 0, "ephemera": 0, "other": 4, "primary_format": "manuscript"}, "creators": {"creator_counts": {"Pupils of No.27 revolutionary railroad middle school": 1, "Unable to determine clearly from visible text": 1, "Red Guards of 'Anti-revisionist Commune'": 1, "‰∫∫Ê∞ëÊó•Êä•": 1, "Êú™ËÉΩÂæûÂúñÂÉèÂÆåÂÖ®Á¢∫ÂÆö": 1}, "unique_creators": "{'Êú™ËÉΩÂæûÂúñÂÉèÂÆåÂÖ®Á¢∫ÂÆö', '‰∫∫Ê∞ëÊó•Êä•', 'Unable to determine clearly from visible text', 'Pupils of No.27 revolutionary railroad middle school', \"Red Guards of 'Anti-revisionist Commune'\"}", "items_with_creators": 5, "items_without_creators": 1, "dominant_creator": ["Pupils of No.27 revolutionary railroad middle school", 1]}, "dates": {"date_range": [1966, 1966], "earliest_date": 1966, "latest_date": 1966, "date_span": 0, "items_with_dates": 3, "date_counts": {"1966": 3}}, "languages": {"language_counts": {"english (description), chinese (likely collection contents)": 1, "chi": 5}, "unique_languages": "{'english (description), chinese (likely collection contents)', 'chi'}", "primary_language": "chi", "multilingual": true}, "subjects": {"subject_counts": {"Chinese Cultural Revolution": 1, "Handbills": 1, "Red guard groups": 1, "Spokespersons": 1, "Revolutionary committees": 1, "Ephemera": 1, "1960s China": 1, "1970s China": 1, "Political propaganda": 2, "Cultural Revolution": 3, "Red Guards": 2, "Railroad workers": 1, "Revolutionary propaganda": 1, "Chinese political movements": 2, "Elementary school conflict": 1, "Mao Zedong thought": 2, "Ancient Greek philosophy": 1, "Cynic philosophy": 1, "Philosophy history": 1, "Censorship": 1, "Anti-revisionism": 1, "Banned books and songs": 1, "Ouyang Hai": 1, "Guan Huanqing": 1, "Fuxiu gongshe (capitalist black books)": 1, "Huangnianjing Commune": 1, "People's Liberation Army": 1, "Youth education": 1, "China-Western cultural relations": 1, "Cultural history": 1, "Sino-Western relations": 1}, "unique_subjects": "{'Mao Zedong thought', 'Political propaganda', 'Guan Huanqing', 'Handbills', 'Elementary school conflict', 'Revolutionary propaganda', 'Banned books and songs', 'Railroad workers', 'Fuxiu gongshe (capitalist black books)', 'Cynic philosophy', 'Sino-Western relations', 'Red guard groups', '1960s China', 'Youth education', 'China-Western cultural relations', 'Anti-revisionism', 'Huangnianjing Commune', 'Red Guards', 'Revolutionary committees', 'Chinese Cultural Revolution', 'Chinese political movements', 'Cultural history', 'Censorship', '1970s China', 'Ephemera', 'Ouyang Hai', 'Cultural Revolution', 'Ancient Greek philosophy', 'Spokespersons', 'Philosophy history', \"People's Liberation Army\"}", "items_with_subjects": 6, "common_subjects": [["Cultural Revolution", 3], ["Political propaganda", 2], ["Red Guards", 2], ["Chinese political movements", 2], ["Mao Zedong thought", 2]], "subject_coherence": 3.163978494623656}, "provenance": {"collection_provenance": "Extracted from 6 images using marcsnarc", "item_provenances": {}, "consistency_score": 1.0, "has_provenance": true}, "identifiers": {"items_with_isbn": 0, "items_with_issn": 0, "items_with_oclc": 0, "items_with_lccn": 0, "identifier_coverage": 0.0}, "physical_characteristics": {"extent_variety": 6, "dimension_variety": 5, "physical_coherence": 0.08333333333333337}, "format_diversity": 4, "creator_diversity": 5, "has_books_serials": true, "shared_provenance": true, "temporal_coherence": 1.0, "workflow_type": "collection_images_to_marc", "collection_name": "CRH-test", "processing_timestamp": "2025-12-23T13:47:10.615925", "total_records": 1, "approach": "collection"}, "batch_analysis": {"collection_name": "CRH-test", "total_images": 6, "successful_analyses": 6, "failed_analyses": 0, "individual_results": [{"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164209737.jpg", "extracted_data": {"title": "Archived Box 5 Chinese Cultural Revolution handbills, plus printed miscellany", "publication_date": "1960s-1970s era (Cultural Revolution period)", "normalized_date": {"normalized": null, "end_date": null, "circa": true, "uncertain": true, "original": "1960s-1970s era (Cultural Revolution period)"}, "format": "archival collection|pamphlet collection", "extent": "Box 5 of collection series", "language": "english (description), chinese (likely collection contents)", "original_script_title": "Latin (description), likely Chinese characters in collection", "other_identifiers": "RWB Collection; Arranged chronologically; Handbills, leaflets, newspaper extras", "subjects": [{"heading": "Chinese Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "Handbills", "type": "topical", "source": "claude_analysis"}, {"heading": "Red guard groups", "type": "topical", "source": "claude_analysis"}, {"heading": "Spokespersons", "type": "topical", "source": "claude_analysis"}, {"heading": "Revolutionary committees", "type": "topical", "source": "claude_analysis"}, {"heading": "Ephemera", "type": "topical", "source": "claude_analysis"}, {"heading": "1960s China", "type": "topical", "source": "claude_analysis"}, {"heading": "1970s China", "type": "topical", "source": "claude_analysis"}, {"heading": "Political propaganda", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Collection description indicates materials arranged chronologically", "source": "image_analysis"}, {"text": "Contains handbills plus printed miscellany from Cultural Revolution era", "source": "image_analysis"}, {"text": "Materials described as being acquired in Hohhot in the 1980s and 1990s", "source": "image_analysis"}, {"text": "Items listed below were acquired by chroniclers at various times", "source": "image_analysis"}, {"text": "Items represent various red guard groups and spokespersons from local organizations", "source": "image_analysis"}, {"text": "Described as proposals to change local place names and items of national character", "source": "image_analysis"}, {"text": "Groups represented were long-lasting or only ephemeral", "source": "image_analysis"}, {"text": "Collection additions from Hohhot in Inner Mongolia region", "source": "image_analysis"}, {"text": "Handwritten note on yellow paper appears to read: 'Cultural Relic / handbills / laneboks etc / Dec 1983 / #1 of 7-20'", "source": "image_analysis"}, {"text": "Document appears to be an archival finding aid or collection description", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.2, "publication": 0.15166666666666667, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.38558333333333333}, "overall_confidence": 0.38558333333333333, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Archived Box 5 Chinese Cultural Revolution handbills, plus printed miscellany / RWB Collection / Arranged chronologically", "language": "English", "location": "document header"}, {"text": "NA Handbills, leaflets, newspaper extras / My. The nearby items listed below were all acquired in Hohhot in the late 80s, 90s. They are a mixture of handbills put up by spokespersons of various red guard groups...", "language": "English", "location": "document body"}, {"text": "Cultural Relic / handbills / laneboks etc / Dec 1983 / #1 of 7-20", "language": "English", "location": "yellow note/label"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided", "No creator/author information found"], "review_required": true, "sequence_number": 1}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164650783.jpg", "extracted_data": {"title": "Three page leaflet from pupils of the No.27 revolutionary railroad middle school", "creator": {"name": "Pupils of No.27 revolutionary railroad middle school", "type": "corporate", "source": "claude_analysis"}, "publication_place": "China", "publication_date": "1966-67 (Cultural Revolution period)", "normalized_date": {"normalized": "1966", "end_date": null, "circa": true, "uncertain": false, "original": "1966-67 (Cultural Revolution period)"}, "format": "manuscript", "extent": "3 pages", "dimensions": "Standard letter-size paper approximately", "language": "chi", "original_script_title": "Simplified Chinese characters", "other_identifiers": "Archival reference notation: 1396 W-1, Railroad Revolution Handbills, 3 pages, leaflet from Red guard + no.27? Revolutionary Railroad Middle School, 21/10/66 [?]", "subjects": [{"heading": "Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "Red Guards", "type": "topical", "source": "claude_analysis"}, {"heading": "Railroad workers", "type": "topical", "source": "claude_analysis"}, {"heading": "Revolutionary propaganda", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese political movements", "type": "topical", "source": "claude_analysis"}, {"heading": "Elementary school conflict", "type": "topical", "source": "claude_analysis"}, {"heading": "Mao Zedong thought", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Yellow sticky note contains archival cataloging information in English", "source": "image_analysis"}, {"text": "Document appears to be a leaflet from Red Guards during the Cultural Revolution period", "source": "image_analysis"}, {"text": "Mentions conflict with railroad elementary school", "source": "image_analysis"}, {"text": "References 'specially urgent appeal' (Á¥ßÊÄ•ÂëºÂêÅ)", "source": "image_analysis"}, {"text": "Published date appears to be September 27, 1966", "source": "image_analysis"}, {"text": "Handwritten manuscript in blue ink", "source": "image_analysis"}, {"text": "Document is stored in protective plastic sleeve", "source": "image_analysis"}, {"text": "Appears to be part of an archival collection of Cultural Revolution materials", "source": "image_analysis"}, {"text": "Text discusses revolutionary railroad middle school conflicts and appeals", "source": "image_analysis"}, {"text": "Contains rhetorical questions typical of Cultural Revolution propaganda style", "source": "image_analysis"}, {"text": "Numbered page (1) visible at top right of manuscript", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.675, "publication": 0.39, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.603}, "overall_confidence": 0.603, "claude_factors": {"text_clarity": "high", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "1396 W-1\nRailroad Revolution\nHandbills\n3 pages, leaflet from\nRed guard + no.27?\nRevolutionary Railroad\nMiddle School\n21/10/66 [?]", "language": "English", "location": "archival note (yellow sticky note)"}, {"text": "Headline: ÁâπÊÄ•ÂëºÂêÅ!!\n(Title): Specially urgent appeal\nPublished by: ‰∫åÈìÅË∑ØÂè∑Èù©ÂëΩÈÄ†ÂèçÊ¥æÊÄªÂ∑•‰ºöÁ∫¢ÈÄ†Âèç Er germing tie zhong Mao Zedong zhuyi...", "language": "English translation on descriptive sheet", "location": "descriptive sheet"}, {"text": "[Full handwritten Chinese text visible on manuscript page - extensive Revolutionary-era Chinese text in simplified characters discussing conflicts and revolutionary activities]", "language": "Chinese (Simplified)", "location": "manuscript body"}], "processing_notes": ["Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 2}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164821071.jpg", "extracted_data": {"title": "ÂΩªÂ∫ïÁöÑÂèçÂèõ‚Äî‚ÄîÂè§Â∏åËÖäÁä¨ÂÑíÂ≠¶Ê¥æÂì≤Â≠¶", "creator": {"name": "Unable to determine clearly from visible text", "type": "personal", "source": "claude_analysis"}, "format": "book", "extent": "Multiple pages visible", "dimensions": "Standard book format, approximately A4 or similar", "language": "chi", "original_script_title": "Simplified Chinese characters", "subjects": [{"heading": "Ancient Greek philosophy", "type": "topical", "source": "claude_analysis"}, {"heading": "Cynic philosophy", "type": "topical", "source": "claude_analysis"}, {"heading": "Philosophy history", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Yellow adhesive note attached to page with handwritten annotations", "source": "image_analysis"}, {"text": "Text appears to be a scholarly work on ancient Greek Cynic philosophy", "source": "image_analysis"}, {"text": "Document shows signs of being photocopied or printed material", "source": "image_analysis"}, {"text": "Visible plastic protective covering over the document", "source": "image_analysis"}, {"text": "Handwritten note includes 'August 27' and a circled '15'", "source": "image_analysis"}, {"text": "The title translates approximately to 'Complete Rebellion - Ancient Greek Cynic School Philosophy'", "source": "image_analysis"}, {"text": "Text includes both Chinese and romanized Western names (e.g., 'August', 'Pesthus', 'Xeniae')", "source": "image_analysis"}, {"text": "Bibliography or reference section visible with multiple author citations", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.0, "format": 0.26, "language": 0.5850000000000001, "overall": 0.40725}, "overall_confidence": 0.40725, "claude_factors": {"text_clarity": "medium", "completeness": "low", "language_certainty": "high"}, "original_text_regions": [{"text": "ÂΩªÂ∫ïÁöÑÂèçÂèõ‚Äî‚ÄîÂè§Â∏åËÖäÁä¨ÂÑíÂ≠¶Ê¥æÂì≤Â≠¶", "language": "Chinese", "location": "title/header"}, {"text": "Á¨¨‰∫åÈÉ®ÂàÜ Âì≤Â≠¶ÊÄùÊÉ≥‰∏éÂ≠¶ËØ¥", "language": "Chinese", "location": "section heading"}, {"text": "Handlin. Joanna F. Action in Late Ming thought at the chin hou qilun Jinching dai August 27...", "language": "English/Chinese mixed", "location": "body text/references"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Bibliographic information appears incomplete in image", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 3}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164339517.jpg", "extracted_data": {"title": "Urgent appeal to ban some books and songs, from red guards in the 'Anti-revisionist Commune'", "creator": {"name": "Red Guards of 'Anti-revisionist Commune'", "type": "corporate", "source": "claude_analysis", "romanization": "Fandui xiuzheng zhuyi gongshe"}, "publisher": "ÂèçÂØπ‰øÆÊ≠£‰∏ª‰πâÂÖ¨Á§æ (Fandui xiuzheng zhuyi gongshe - Anti-revisionist Commune)", "publication_place": "Beijing, China", "publication_date": "1966-1967 (Cultural Revolution period)", "normalized_date": {"normalized": "1966", "end_date": "1967", "circa": true, "uncertain": false, "original": "1966-1967 (Cultural Revolution period)"}, "format": "manuscript", "extent": "1 handwritten document, multiple pages visible", "dimensions": "Standard letter size approximately", "language": "chi", "original_script_title": "Simplified Chinese characters", "other_identifiers": "42 (noted on yellow sticky note), 67.66.27 (catalog/reference number)", "subjects": [{"heading": "Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "Red Guards", "type": "topical", "source": "claude_analysis"}, {"heading": "Censorship", "type": "topical", "source": "claude_analysis"}, {"heading": "Anti-revisionism", "type": "topical", "source": "claude_analysis"}, {"heading": "Banned books and songs", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese political movements", "type": "topical", "source": "claude_analysis"}, {"heading": "Ouyang Hai", "type": "topical", "source": "claude_analysis"}, {"heading": "Guan Huanqing", "type": "topical", "source": "claude_analysis"}, {"heading": "Fuxiu gongshe (capitalist black books)", "type": "topical", "source": "claude_analysis"}, {"heading": "Huangnianjing Commune", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document appears to be an original Cultural Revolution era manuscript", "source": "image_analysis"}, {"text": "Yellow sticky note indicates archival processing: 'Cultural Revolution Red Bills, Urgent appeal to ban some books + songs from Red Guards in the 'Anti-revisionist commune'. #2'", "source": "image_analysis"}, {"text": "Printed explanatory note in English references catalog number 67.66.27", "source": "image_analysis"}, {"text": "Content relates to banning feudal, capitalist 'black' books", "source": "image_analysis"}, {"text": "Mentions influence of Beijing Party committee", "source": "image_analysis"}, {"text": "References village in Beijing suburbs as of 1958", "source": "image_analysis"}, {"text": "Discusses Ouyang Hai (Ê¨ßÈò≥Êµ∑) and related study materials", "source": "image_analysis"}, {"text": "References burning of unhealthy books and songs", "source": "image_analysis"}, {"text": "Document preserved in plastic sleeve", "source": "image_analysis"}, {"text": "Appears to be part of larger archival collection", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.45499999999999996, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.5275}, "overall_confidence": 0.5275, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "67.66.27 Urgent appeal to ban some books and songs, from red guards in the 'Anti-revisionist Commune'", "language": "English", "location": "Printed descriptive note"}, {"text": "ÂèçÂØπ‰øÆÊ≠£‰∏ª‰πâÂÖ¨Á§æ!!!['Fandui xiuzheng zhuyi gongshe!!!'] (Trans. Urgent appeal!!!)", "language": "Chinese with English translation", "location": "Printed descriptive note"}, {"text": "Headline: Ê¨ßÈò≥Êµ∑‰∏çÊúΩÔºÅÔºÅÔºÅ['mu huya!!!]", "language": "Chinese with romanization", "location": "Printed descriptive note"}, {"text": "Published by Âèç‰øÆÂÖ¨Á§æ (È™ÇÁúüÁéãÂêìÂÖ¨Á§æ), ÊñáÂåñÂÆ£ÂÖ®‰ΩìÈù©ÂëΩÈÄ†Âèç, Fuxiu gongshe (Guan Huanqiang", "language": "Mixed Chinese and English", "location": "Printed descriptive note"}, {"text": "ÊÄ•ÊÄ•ÂëºÂêÅ!!!", "language": "Chinese", "location": "Manuscript header"}, {"text": "[Handwritten Chinese text discussing Cultural Revolution appeals and banned materials]", "language": "Chinese (simplified)", "location": "Main manuscript body"}], "processing_notes": ["Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 4}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164450342.jpg", "extracted_data": {"title": "Èù©ÂëΩÈùíÂ∞ëÂπ¥Ë¶ÅÂêëËß£ÊîæÂÜõÂ≠¶‰π†", "subtitle": "‰∫∫Ê∞ëÊó•Êä•ÂÖ´Êúà‰∫åÂçÅÂÖ´Êó•Á§æËÆ∫", "creator": {"name": "‰∫∫Ê∞ëÊó•Êä•", "type": "corporate", "source": "claude_analysis", "romanization": "Renmin Ribao (People's Daily)"}, "publisher": "‰∫∫Ê∞ëÊó•Êä•", "publication_date": "1966-08-28", "normalized_date": {"normalized": "1966", "end_date": null, "circa": false, "uncertain": false, "original": "1966-08-28"}, "format": "pamphlet", "extent": "1 sheet", "dimensions": "Standard broadsheet size", "language": "chi", "original_script_title": "Simplified Chinese", "other_identifiers": "RI 1966/9.8.28", "subjects": [{"heading": "Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "People's Liberation Army", "type": "topical", "source": "claude_analysis"}, {"heading": "Youth education", "type": "topical", "source": "claude_analysis"}, {"heading": "Mao Zedong thought", "type": "topical", "source": "claude_analysis"}, {"heading": "Political propaganda", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Cultural Revolution era editorial from People's Daily dated August 28, 1966", "source": "image_analysis"}, {"text": "Features Mao quotation at top: 'Read Chairman Mao's books, listen to Chairman Mao's words, act according to Chairman Mao's instructions, be Chairman Mao's good soldier'", "source": "image_analysis"}, {"text": "Yellow archival note attached indicating date 1966.8.28 and reference to Cultural Revolution and People's Liberation Army (PLA)", "source": "image_analysis"}, {"text": "White catalog card with detailed English description attached", "source": "image_analysis"}, {"text": "Document appears to be in protective plastic covering", "source": "image_analysis"}, {"text": "Editorial calls for revolutionary youth to learn from the Liberation Army", "source": "image_analysis"}, {"text": "Text printed in red and black ink", "source": "image_analysis"}, {"text": "Typical propaganda material from early Cultural Revolution period", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.675, "publication": 0.39, "format": 0.5850000000000001, "language": 0.5850000000000001, "overall": 0.6225}, "overall_confidence": 0.6225, "claude_factors": {"text_clarity": "high", "completeness": "high", "language_certainty": "high"}, "original_text_regions": [{"text": "ËØªÊØõ‰∏ªÂ∏≠ÁöÑ‰π¶, Âê¨ÊØõ‰∏ªÂ∏≠ÁöÑËØù, ÁÖßÊØõ‰∏ªÂ∏≠ÁöÑÊåáÁ§∫Âäû‰∫ã, ÂÅöÊØõ‰∏ªÂ∏≠ÁöÑÂ•ΩÊàòÂ£´", "language": "Chinese", "location": "header box"}, {"text": "Èù©ÂëΩÈùíÂ∞ëÂπ¥Ë¶ÅÂêëËß£ÊîæÂÜõÂ≠¶‰π†", "language": "Chinese", "location": "title"}, {"text": "‰∫∫Ê∞ëÊó•Êä•ÂÖ´Êúà‰∫åÂçÅÂÖ´Êó•Á§æËÆ∫", "language": "Chinese", "location": "subtitle"}, {"text": "1966. 8.28\nCultural Revolution\nand PLA\nPeople's Daily editorial\nfrom August 28th", "language": "English", "location": "archival note (yellow sticky note)"}, {"text": "RI 1966/9.8.28 People's Daily editorial from August 28", "language": "English", "location": "catalog card"}], "processing_notes": ["Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 5}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164253582.jpg", "extracted_data": {"title": "‰∏≠ÂúãËàáË•øÊ¥ãÊñáÂåñ‰πãÈóú‰øÇ [Zhongguo yu xiyang wenhua zhi guanxi]", "creator": {"name": "Êú™ËÉΩÂæûÂúñÂÉèÂÆåÂÖ®Á¢∫ÂÆö", "type": "personal", "source": "claude_analysis", "romanization": "Unable to fully determine from image"}, "publication_date": "1932Âπ¥", "normalized_date": {"normalized": null, "end_date": null, "circa": false, "uncertain": true, "original": "1932Âπ¥"}, "format": "manuscript", "extent": "Single sheet manuscript document", "dimensions": "Approximately standard letter/A4 size", "language": "chi", "original_script_title": "Traditional Chinese characters", "other_identifiers": "8.23 (visible on yellow note)", "subjects": [{"heading": "China-Western cultural relations", "type": "topical", "source": "claude_analysis"}, {"heading": "Cultural history", "type": "topical", "source": "claude_analysis"}, {"heading": "Sino-Western relations", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document appears to be a handwritten or typed manuscript in traditional Chinese characters", "source": "image_analysis"}, {"text": "Text is written vertically in traditional Chinese format (right to left)", "source": "image_analysis"}, {"text": "Accompanied by a yellow sticky note with handwritten notes in English", "source": "image_analysis"}, {"text": "White explanatory sheet in English discusses Beijing libraries and original archives", "source": "image_analysis"}, {"text": "Document appears to be part of an archival collection", "source": "image_analysis"}, {"text": "Text discusses cultural exchanges between China and the West", "source": "image_analysis"}, {"text": "Some red corrections or annotations visible on the manuscript", "source": "image_analysis"}, {"text": "Paper clip attached to document", "source": "image_analysis"}, {"text": "Document shows signs of age and handling", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.15166666666666667, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.4668333333333333}, "overall_confidence": 0.4668333333333333, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "„Éò„Éº [partial title visible at top right]", "language": "Chinese", "location": "manuscript top right"}, {"text": "Multiple columns of traditional Chinese text discussing cultural relations between China and the West, references to various historical periods and cultural exchanges", "language": "Chinese (Traditional)", "location": "manuscript body"}, {"text": "1932Âπ¥ visible in date references within text", "language": "Chinese", "location": "manuscript body"}, {"text": "3. 1930-2.3 A provides Chinese names of Beijing Libraries Yenching cultural center [...] Notes taken from Beijing original archives [...]", "language": "English", "location": "white explanatory sheet"}, {"text": "8.23 and additional handwritten notes in English", "language": "English", "location": "yellow sticky note"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 6}], "collection_analysis": {"total_items": 6, "successful_extractions": 6, "common_characteristics": {"primary_language": "chi", "language_distribution": {"english (description), chinese (likely collection contents)": 1, "chi": 5}, "primary_format": "manuscript", "format_distribution": {"archival collection|pamphlet collection": 1, "manuscript": 3, "book": 1, "pamphlet": 1}, "publishers": {"ÂèçÂØπ‰øÆÊ≠£‰∏ª‰πâÂÖ¨Á§æ (Fandui xiuzheng zhuyi gongshe - Anti-revisionist Commune)": 1, "‰∫∫Ê∞ëÊó•Êä•": 1}}, "quality_assessment": {"average_confidence": 0.5021111111111111, "high_confidence_items": 0, "low_confidence_items": 3, "confidence_range": [0.38558333333333333, 0.6225]}, "recommendations": ["More than 30% of items have low confidence - consider manual review", "Multiple languages detected - verify language coding", "6 items contain CJK characters - verify romanization"]}, "batch_confidence": 0.5021111111111111, "processing_timestamp": "2025-12-23T13:47:09.376771"}, "individual_extractions": [{"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164209737.jpg", "extraction_confidence": 0.38558333333333333, "extracted_fields": ["title", "publication_date", "normalized_date", "format", "extent", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164650783.jpg", "extraction_confidence": 0.603, "extracted_fields": ["title", "creator", "publication_place", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164821071.jpg", "extraction_confidence": 0.40725, "extracted_fields": ["title", "creator", "format", "extent", "dimensions", "language", "original_script_title", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164339517.jpg", "extraction_confidence": 0.5275, "extracted_fields": ["title", "creator", "publisher", "publication_place", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164450342.jpg", "extraction_confidence": 0.6225, "extracted_fields": ["title", "subtitle", "creator", "publisher", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164253582.jpg", "extraction_confidence": 0.4668333333333333, "extracted_fields": ["title", "creator", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}], "external_api_results": [{"worldcat": [], "loc": [{"type": "subject_authority", "term": "Cultural Revolution", "valid": false}, {"type": "subject_authority", "term": "Political propaganda", "valid": false}, {"type": "subject_authority", "term": "Red Guards", "valid": false}], "alma": [], "best_match": null}]};
        const metadataData = {"workflow_type": "collection_images_to_marc", "collection_name": "CRH-test", "processing_result": {"approach": "collection", "records_generated": 1, "review_required": true, "groupings": {"approach": "collection", "total_items": 6, "groups": [{"type": "collection", "items": ["Archived Box 5 Chinese Cultural Revolution handbills, plus printed miscellany", "Three page leaflet from pupils of the No.27 revolutionary railroad middle school", "ÂΩªÂ∫ïÁöÑÂèçÂèõ‚Äî‚ÄîÂè§Â∏åËÖäÁä¨ÂÑíÂ≠¶Ê¥æÂì≤Â≠¶", "Urgent appeal to ban some books and songs, from red guards in the 'Anti-revisionist Commune'", "Èù©ÂëΩÈùíÂ∞ëÂπ¥Ë¶ÅÂêëËß£ÊîæÂÜõÂ≠¶‰π†", "‰∏≠ÂúãËàáË•øÊ¥ãÊñáÂåñ‰πãÈóú‰øÇ [Zhongguo yu xiyang wenhua zhi guanxi]"], "record_type": "collection"}]}}, "collection_data": {"total_items": 6, "source_images": ["examples/Cultural Revolution Handbills/PXL_20251212_164209737.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164650783.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164821071.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164339517.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164450342.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164253582.jpg"], "provenance": "Extracted from 6 images using marcsnarc"}, "batch_analysis_summary": {"total_images": 6, "successful_analyses": 6, "batch_confidence": 0.5021111111111111}, "processing_timestamp": "2025-12-23T13:47:10.615946"};
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize images array from gallery
            const thumbnails = document.querySelectorAll('.thumbnail');
            currentImages = Array.from(thumbnails).map(img => ({
                src: img.src,
                alt: img.alt
            }));
            
            // Initialize JSON trees
            if (analysisData && Object.keys(analysisData).length > 0) {
                renderJsonTree('analysis-tree', analysisData);
            }
            if (metadataData && Object.keys(metadataData).length > 0) {
                renderJsonTree('metadata-tree', metadataData);
            }
        });
        
        // Modal functions
        function openModal(index) {
            currentImageIndex = index;
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const counter = document.getElementById('modalCounter');
            
            if (currentImages[index]) {
                modalImage.src = currentImages[index].src;
                modalImage.alt = currentImages[index].alt;
                counter.textContent = `${index + 1} of ${currentImages.length}`;
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function changeImage(direction) {
            currentImageIndex = (currentImageIndex + direction + currentImages.length) % currentImages.length;
            openModal(currentImageIndex);
        }
        
        // Keyboard controls
        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'block') {
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft') changeImage(-1);
                if (e.key === 'ArrowRight') changeImage(1);
            }
        });
        
        // Close modal on background click
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        // JSON Tree rendering functions
        function renderJsonTree(containerId, data) {
            const container = document.getElementById(containerId);
            if (!container || !data) return;
            
            container.innerHTML = '';
            const tree = createTreeElement(data, '', 0);
            container.appendChild(tree);
        }
        
        function createTreeElement(value, key, level) {
            const wrapper = document.createElement('div');
            wrapper.style.marginLeft = `${level * 20}px`;
            wrapper.style.marginBottom = '3px';
            
            if (value && typeof value === 'object' && !Array.isArray(value)) {
                // Object
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                Object.entries(value).forEach(([childKey, childValue]) => {
                    children.appendChild(createTreeElement(childValue, childKey, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìÇ ${key} {${Object.keys(value).length}}</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else if (Array.isArray(value)) {
                // Array
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                value.forEach((item, index) => {
                    children.appendChild(createTreeElement(item, `[${index}]`, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìñ ${key} [${value.length}]</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else {
                // Primitive value
                const element = document.createElement('div');
                const valueStr = value === null ? 'null' : String(value);
                const valueType = typeof value;
                let color = '#4a5568';
                let icon = 'üìÑ';
                
                if (valueType === 'string') { color = '#38a169'; icon = 'üìù'; }
                else if (valueType === 'number') { color = '#d69e2e'; icon = 'üî¢'; }
                else if (valueType === 'boolean') { color = '#9f7aea'; icon = '‚úÖ'; }
                else if (value === null) { color = '#a0aec0'; icon = '‚ùå'; }
                
                element.innerHTML = `<span style="color: #2d3748; font-weight: 600;">${icon} ${key}:</span> <span style="color: ${color};">${valueType === 'string' ? '"' + valueStr + '"' : valueStr}</span>`;
                wrapper.appendChild(element);
            }
            
            return wrapper;
        }
        
        function expandAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñ∂')) {
                    span.parentElement.click();
                }
            });
        }
        
        function collapseAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñº')) {
                    span.parentElement.click();
                }
            });
        }
    </script>
</body>
</html>