<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>api_test_crh_fixed - MARC Records</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; line-height: 1.6; background: #fafafa; }
        
        /* Header */
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 2em; font-weight: 300; }
        .header p { margin: 10px 0 0; opacity: 0.9; }
        
        /* Image Gallery */
        .image-gallery { display: flex; gap: 15px; overflow-x: auto; padding: 20px 0; margin-bottom: 30px; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .thumbnail-container { flex-shrink: 0; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .thumbnail-container:hover { transform: scale(1.02); box-shadow: 0 4px 15px rgba(0,0,0,0.15); }
        .thumbnail { width: 200px; height: 300px; object-fit: cover; border-radius: 8px; border: 3px solid #e0e0e0; transition: border-color 0.2s ease; }
        .thumbnail-container:hover .thumbnail { border-color: #667eea; }
        .thumbnail-label { text-align: center; margin-top: 8px; font-size: 0.85em; color: #666; font-weight: 500; word-break: break-word; max-width: 200px; }
        .no-images { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 90vw; max-height: 90vh; }
        .modal-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .modal-close { position: absolute; top: 15px; right: 20px; color: white; font-size: 30px; font-weight: bold; cursor: pointer; z-index: 1001; width: 40px; height: 40px; border-radius: 50%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .modal-close:hover { background: rgba(255,0,0,0.7); }
        .modal-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.5); color: white; border: none; padding: 15px 20px; font-size: 18px; cursor: pointer; border-radius: 5px; transition: background 0.2s ease; }
        .modal-nav:hover { background: rgba(0,0,0,0.8); }
        .modal-prev { left: 20px; }
        .modal-next { right: 20px; }
        .modal-counter { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: white; background: rgba(0,0,0,0.7); padding: 8px 16px; border-radius: 20px; font-size: 14px; }
        
        /* MARC Records */
        .records-section h2 { color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; margin: 30px 0 20px; }
        .marc-record { background: white; border: none; margin-bottom: 25px; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .marc-record h3 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .confidence { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); padding: 6px 12px; border-radius: 20px; display: inline-block; margin-bottom: 15px; color: #2c5530; font-weight: 500; font-size: 0.9em; }
        .review-flag { background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); border: none; color: #d63031; padding: 6px 12px; border-radius: 20px; margin-bottom: 15px; font-weight: 500; font-size: 0.9em; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 5px rgba(0,0,0,0.05); }
        th, td { padding: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #f0f0f0; }
        th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; width: 100px; }
        .subfield-code { font-weight: bold; color: #667eea; background: #f8f9ff; padding: 2px 4px; border-radius: 3px; margin-right: 5px; }
        .no-records { text-align: center; padding: 40px; color: #999; font-style: italic; background: white; border-radius: 10px; margin-bottom: 30px; }
        
        /* External API Results */
        .api-results-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .api-results-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .api-summary { background: #f8f9ff; border: 1px solid #e0e6ff; border-radius: 6px; padding: 12px; margin-bottom: 20px; }
        .api-summary p { margin: 0; color: #333; font-size: 0.95em; }
        .api-source { margin-bottom: 20px; }
        .api-source h3 { color: #667eea; margin-bottom: 10px; font-size: 1.1em; }
        .api-matches { background: #f8f9ff; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .api-match { background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 10px; margin-bottom: 10px; }
        .api-match:last-child { margin-bottom: 0; }
        .match-title { font-weight: 600; color: #333; margin-bottom: 5px; }
        .match-author { color: #666; margin-bottom: 5px; }
        .match-details { font-size: 0.9em; color: #888; }
        .no-matches { text-align: center; padding: 20px; color: #999; font-style: italic; }
        .api-no-results { }
        .search-details { background: #f8f9fa; border-radius: 6px; padding: 15px; margin-top: 15px; }
        .search-details h4 { margin-top: 0; color: #495057; }
        .search-details ul { margin: 10px 0; padding-left: 20px; }
        .search-details li { margin-bottom: 5px; color: #6c757d; }
        .search-details em { color: #6c757d; }
        .authority-result { display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 0.85em; margin-right: 10px; }
        .authority-valid { background: #d4edda; color: #155724; }
        .authority-invalid { background: #f8d7da; color: #721c24; }
        
        /* JSON Tree View */
        .json-tree-section { background: white; border-radius: 10px; padding: 20px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .json-tree-section h2 { margin-top: 0; color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px; font-weight: 600; }
        .tree-container { border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; background: #fafafa; max-height: 600px; overflow-y: auto; font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono", monospace; }
        .expand-all-btn, .collapse-all-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; margin-right: 10px; margin-bottom: 15px; font-size: 0.9em; transition: transform 0.2s ease; }
        .expand-all-btn:hover, .collapse-all-btn:hover { transform: translateY(-1px); }
        
        /* Footer */
        .footer { text-align: center; padding: 20px; color: #666; font-size: 0.9em; background: white; border-radius: 10px; margin-top: 30px; }
        .footer a { color: #667eea; text-decoration: none; font-weight: 500; }
        .footer a:hover { text-decoration: underline; }
        
        /* Responsive */
        @media (max-width: 768px) {
            body { padding: 10px; }
            .thumbnail { width: 150px; height: 225px; }
            .thumbnail-label { max-width: 150px; }
            .modal-nav { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>api_test_crh_fixed</h1>
        <p>üìö MARC Records generated by marcsnarc on 2025-12-23 09:44:22</p>
    </div>
    
    <div class='image-gallery'>

                <div class='thumbnail-container' onclick='openModal(0)'>
                    <img src='img_PXL_20251212_164209737.webp' alt='PXL_20251212_164209737.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164209737.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(1)'>
                    <img src='img_PXL_20251212_164253582.webp' alt='PXL_20251212_164253582.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164253582.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(2)'>
                    <img src='img_PXL_20251212_164339517.webp' alt='PXL_20251212_164339517.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164339517.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(3)'>
                    <img src='img_PXL_20251212_164450342.webp' alt='PXL_20251212_164450342.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164450342.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(4)'>
                    <img src='img_PXL_20251212_164650783.webp' alt='PXL_20251212_164650783.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164650783.jpg</div>
                </div>
                
                <div class='thumbnail-container' onclick='openModal(5)'>
                    <img src='img_PXL_20251212_164821071.webp' alt='PXL_20251212_164821071.jpg' class='thumbnail' loading='lazy'>
                    <div class='thumbnail-label'>PXL_20251212_164821071.jpg</div>
                </div>
                </div>

    
    <!-- Modal for image viewing -->
    <div id="imageModal" class="modal">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <button class="modal-nav modal-prev" onclick="changeImage(-1)">‚Äπ</button>
        <button class="modal-nav modal-next" onclick="changeImage(1)">‚Ä∫</button>
        <div class="modal-content">
            <img id="modalImage" class="modal-image" src="" alt="">
        </div>
        <div class="modal-counter" id="modalCounter"></div>
    </div>
    
    <div class="records-section">
        <h2>üìã MARC Records</h2>
        <div class='marc-record'>
<h3>Record 1</h3>
<div class='confidence'>Confidence: 0.47</div>
<div class='review-flag'>‚ö†Ô∏è Review Required</div>
<table><tr><th>LDR</th><td>00000nam a200000 Ki 500</td></tr><tr><th>001</th><td>msn20251223154420</td></tr><tr><th>003</th><td>DLC</td></tr><tr><th>005</th><td>20251223154420.0</td></tr><tr><th>008</th><td>251223m19061966            o     00chi und d</td></tr><tr><th>040</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>DLC <span class="subfield-code">‚Ä°b</span>eng <span class="subfield-code">‚Ä°c</span>DLC <span class="subfield-code">‚Ä°e</span>rda </td></tr><tr><th>245</th><td><strong>00</strong> <span class="subfield-code">‚Ä°a</span>api_test_crh_fixed </td></tr><tr><th>264</th><td><strong>_1</strong> <span class="subfield-code">‚Ä°c</span>1906 </td></tr><tr><th>300</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>6 items (various formats) </td></tr><tr><th>520</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection consists of 6 other items. Items date from 1906 to 1966. </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Collection-level record for 6 items </td></tr><tr><th>500</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Provenance: Extracted from 6 images using marcsnarc </td></tr><tr><th>561</th><td><strong>__</strong> <span class="subfield-code">‚Ä°a</span>Extracted from 6 images using marcsnarc </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Cultural Revolution </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Red Guards </td></tr><tr><th>650</th><td><strong>_0</strong> <span class="subfield-code">‚Ä°a</span>Mao Zedong thought </td></tr><tr><th>999</th><td><strong>__</strong> <span class="subfield-code">‚Ä°i</span>Generated by marcsnarc on 2025-12-23 <span class="subfield-code">‚Ä°s</span>marcsnarc </td></tr></table></div>

    </div>
    
    <div class="api-results-section">
<h2>üåê External API Results</h2>
<div class="api-summary">
<p><strong>Search Summary:</strong> 2 item(s) searched across WorldCat, Library of Congress, and Alma catalogs</p>
</div>
<div class="api-no-results">
<div class="no-matches">External catalog searches were performed but no matches were found.</div>
<div class="search-details">
<p><strong>Search Status by Service:</strong></p>
<ul>
<li><strong>üìö WorldCat:</strong> Search attempted - likely failed due to server issues or no matches</li>
<li><strong>üèõÔ∏è Library of Congress:</strong> Authority validation performed</li>
<li><strong>üéì Alma Catalog:</strong> Local catalog searched</li>
</ul>
<p><em>Check the processing logs for detailed error messages.</em></p>
</div>
</div>
</div>

    
    
            <div class='json-tree-section'>
                <h2>üìä Analysis Data</h2>
                <div class='tree-container' id='analysis-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("analysis-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("analysis-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
            <div class='json-tree-section'>
                <h2>üìã Processing Metadata</h2>
                <div class='tree-container' id='metadata-tree'></div>
                <button class='expand-all-btn' onclick='expandAllNodes("metadata-tree")'>
                    üîç Expand All
                </button>
                <button class='collapse-all-btn' onclick='collapseAllNodes("metadata-tree")'>
                    üìÅ Collapse All
                </button>
            </div>
            
    
    <div class="footer">
        Generated with <a href="https://github.com/anthropics/marcsnarc">marcsnarc</a> - AI-powered MARC cataloging
    </div>
    
    <script>
        // Global variables for modal and JSON data
        let currentImages = [];
        let currentImageIndex = 0;
        const analysisData = {"collection_analysis": {"item_count": 6, "formats": {"format_counts": {"archival collection": 1, "manuscript and printed materials - handbills/leaflets": 1, "printed document/pamphlet": 1, "manuscript": 2, "printed newspaper editorial/pamphlet": 1}, "unique_formats": "{'manuscript and printed materials - handbills/leaflets', 'printed newspaper editorial/pamphlet', 'manuscript', 'printed document/pamphlet', 'archival collection'}", "books": 0, "serials": 0, "ephemera": 0, "other": 6, "primary_format": "manuscript"}, "creators": {"creator_counts": {"RWB Collection": 1, "Uncertain - multiple authors referenced in text": 1, "Red guards from 'Anti-revisionist Commune'": 1, "‰∫∫Ê∞ëÊó•Êä• (Renmin Ribao / People's Daily)": 1, "Cannot be determined from visible text": 1}, "unique_creators": "{'Uncertain - multiple authors referenced in text', \"‰∫∫Ê∞ëÊó•Êä• (Renmin Ribao / People's Daily)\", \"Red guards from 'Anti-revisionist Commune'\", 'RWB Collection', 'Cannot be determined from visible text'}", "items_with_creators": 5, "items_without_creators": 1, "dominant_creator": ["RWB Collection", 1]}, "dates": {"date_range": [1906, 1966], "earliest_date": 1906, "latest_date": 1966, "date_span": 60, "items_with_dates": 5, "date_counts": {"1966": 4, "1906": 1}}, "languages": {"language_counts": {"eng": 1, "chinese (simplified)": 1, "chi": 4}, "unique_languages": "{'chinese (simplified)', 'eng', 'chi'}", "primary_language": "chi", "multilingual": true}, "subjects": {"subject_counts": {"Chinese Cultural Revolution": 1, "Handbills": 1, "Guard groups": 1, "Red Guard groups": 1, "Ephemera": 1, "Cultural Revolution": 4, "Railroad Elementary School": 1, "Revolutionary committees": 1, "Political conflict": 1, "Chinese education history": 1, "Red Guards": 2, "Mao Zedong thought": 2, "Eight Banners system": 1, "Anti-Manchu sentiment": 1, "Chinese political history": 1, "Qing Dynasty": 1, "Censorship": 1, "Anti-revisionist movement": 1, "Banned books": 1, "Political persecution": 1, "1958 Beijing suburbs": 1, "Ouyang Hai": 1, "Chairman Mao study materials": 1, "People's Liberation Army (PLA)": 1, "Revolutionary youth": 1, "Chinese politics - 1966": 1, "Chinese officials": 1, "Portrait album": 1, "Historical documents": 1, "Provenance research": 1}, "unique_subjects": "{'Chinese political history', 'Guard groups', 'Revolutionary committees', 'Eight Banners system', '1958 Beijing suburbs', 'Political persecution', 'Chinese officials', 'Chinese politics - 1966', 'Railroad Elementary School', 'Ouyang Hai', 'Anti-Manchu sentiment', 'Historical documents', \"People's Liberation Army (PLA)\", 'Ephemera', 'Censorship', 'Chairman Mao study materials', 'Cultural Revolution', 'Chinese Cultural Revolution', 'Banned books', 'Revolutionary youth', 'Portrait album', 'Mao Zedong thought', 'Qing Dynasty', 'Anti-revisionist movement', 'Red Guards', 'Handbills', 'Red Guard groups', 'Chinese education history', 'Provenance research', 'Political conflict'}", "items_with_subjects": 6, "common_subjects": [["Cultural Revolution", 4], ["Red Guards", 2], ["Mao Zedong thought", 2], ["Chinese Cultural Revolution", 1], ["Handbills", 1]], "subject_coherence": 2.9666666666666663}, "provenance": {"collection_provenance": "Extracted from 6 images using marcsnarc", "item_provenances": {}, "consistency_score": 1.0, "has_provenance": true}, "identifiers": {"items_with_isbn": 0, "items_with_issn": 0, "items_with_oclc": 0, "items_with_lccn": 0, "identifier_coverage": 0.0}, "physical_characteristics": {"extent_variety": 6, "dimension_variety": 4, "physical_coherence": 0.16666666666666663}, "format_diversity": 5, "creator_diversity": 5, "has_books_serials": false, "shared_provenance": true, "temporal_coherence": 0.2, "workflow_type": "collection_images_to_marc", "collection_name": "api_test_crh_fixed", "processing_timestamp": "2025-12-23T09:44:21.100198", "total_records": 1, "approach": "collection"}, "batch_analysis": {"collection_name": "api_test_crh_fixed", "total_images": 6, "successful_analyses": 6, "failed_analyses": 0, "individual_results": [{"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164209737.jpg", "extracted_data": {"title": "Archived Box 5 Chinese Cultural Revolution handbills, plus printed miscellany", "creator": {"name": "RWB Collection", "type": "corporate", "source": "claude_analysis"}, "publication_date": "1966-1973", "normalized_date": {"normalized": "1966", "end_date": "1973", "circa": false, "uncertain": false, "original": "1966-1973"}, "format": "archival collection", "extent": "Arranged chronologically", "language": "eng", "original_script_title": "Latin", "other_identifiers": "Handbills, leaflets, newspaper extras", "subjects": [{"heading": "Chinese Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "Handbills", "type": "topical", "source": "claude_analysis"}, {"heading": "Guard groups", "type": "topical", "source": "claude_analysis"}, {"heading": "Red Guard groups", "type": "topical", "source": "claude_analysis"}, {"heading": "Ephemera", "type": "topical", "source": "claude_analysis"}, {"heading": "Cultural Revolution", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "The posters items listed below were all acquired in Hohbot in the late 90s. They are a mixture of newspaper supplements (ËôüÂ§ñ), handbills (ÂÇ≥ÂñÆ), leaflets, newspapers, leaflet or handbill announcements (a specialized genre), of red guard groups and of items to national or local meetings.", "source": "image_analysis"}, {"text": "Archive appears to be a research collection documenting Chinese Cultural Revolution materials.", "source": "image_analysis"}, {"text": "Items include both local place names from local red guard groups and all of them to national or local place names, from local red guard groups and documents.", "source": "image_analysis"}, {"text": "Date range mentioned in materials: 1966-1973", "source": "image_analysis"}, {"text": "Specific notation: ~NWB, 2021 12.30", "source": "image_analysis"}, {"text": "Yellow sticky note indicates: 'Cultural Revolution handbills, handbills 1966-1973' with '# No $20'", "source": "image_analysis"}, {"text": "Reference to 'People's Daily of Liberation Daily' mentioned in description", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.15166666666666667, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.4668333333333333}, "overall_confidence": 0.4668333333333333, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "Archived Box 5 Chinese Cultural Revolution handbills, plus printed miscellany\nRWB Collection\nArranged chronologically\nHandbills, leaflets, newspaper extras", "language": "English", "location": "document label"}, {"text": "Cultural Revolution handbills, handbills 1966-1973\n# No $20", "language": "English", "location": "yellow sticky note"}, {"text": "M2. The poetry items listed below were all acquired in Hohbot in the late 90s. They are a mixture of newspaper supplements (ËôüÂ§ñ), handbills (ÂÇ≥ÂñÆ), leaflets, newspapers, leaflet or handbill announcements (a specialized genre), of red guard groups, and of items to national or local place names, from local red guard groups. Some had the list of red guard groups sponsoring a such as proposal to change local place names, from local red guard groups...", "language": "English", "location": "document description"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 1}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164650783.jpg", "extracted_data": {"title": "Railroad Revision Handbills - Three-page leaflet from Zhongyang Lu No. 27 Railroad Elementary/Middle School", "creator": {"name": "Unknown", "type": "corporate", "source": "claude_analysis"}, "publisher": "No. 27 Revolutionary Railroad Middle School", "publication_place": "China (likely Beijing area based on context)", "publication_date": "1966-1967 (Cultural Revolution period)", "normalized_date": {"normalized": "1966", "end_date": "1967", "circa": true, "uncertain": false, "original": "1966-1967 (Cultural Revolution period)"}, "format": "manuscript and printed materials - handbills/leaflets", "extent": "Multiple documents: handwritten letter and printed leaflet", "dimensions": "Standard letter/A4 size approximately", "language": "chinese (simplified)", "original_script_title": "Simplified Chinese characters", "other_identifiers": "Archive notation: 1/26/94, railroad revision handbills, item #4", "subjects": [{"heading": "Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "Railroad Elementary School", "type": "topical", "source": "claude_analysis"}, {"heading": "Revolutionary committees", "type": "topical", "source": "claude_analysis"}, {"heading": "Political conflict", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese education history", "type": "topical", "source": "claude_analysis"}, {"heading": "Red Guards", "type": "topical", "source": "claude_analysis"}, {"heading": "Mao Zedong thought", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Yellow sticky note indicates: '1/26/94, railroad revision handbills, Three-page leaflet from Zhongyang Lu No. 27 railroad elementary/middle school, 2/10/[67], item #4'", "source": "image_analysis"}, {"text": "Attached printed description discusses conflict between No. 27 railroad middle school and railroad elementary school", "source": "image_analysis"}, {"text": "Describes revolutionary committees and factionalism during Cultural Revolution", "source": "image_analysis"}, {"text": "References meetings in September 1966 and subsequent political conflicts", "source": "image_analysis"}, {"text": "Handwritten document appears to be a personal letter or statement in blue ink", "source": "image_analysis"}, {"text": "Document numbered '(1)' at top right", "source": "image_analysis"}, {"text": "Materials appear to be archival documents stored in protective plastic sleeve", "source": "image_analysis"}, {"text": "Text discusses internal conflicts, revolutionary pilgrimages, and party politics", "source": "image_analysis"}, {"text": "Mentions dates: October 2 and October 7, 1966", "source": "image_analysis"}, {"text": "References 'Railroad Elementary School Revolutionary Committee'", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.45499999999999996, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.5275}, "overall_confidence": 0.5275, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "1/26/94, railroad revision handbills, Three-page leaflet from Zhongyang Lu No. 27 railroad elementary/middle school, 2/10/[67], #4", "language": "English", "location": "yellow sticky note"}, {"text": "Headline: ÈìÅÊÄªÁ∫¢Âç´ÂÖµ [Railroad Red Guards]\nDate: Specially urgent report\nPublished by: ‰∫åÊÄªÊîøÈìÅË∑ØÈù©ÂëΩÈÄ†ÂèçÂÖµÂ§ßÊÄªÈÉ®ÂÆ£‰º†ÁªÑ [Propaganda section of the Second General Headquarters of Railroad Revolutionary Rebels]", "language": "Chinese/English", "location": "printed leaflet header"}, {"text": "[Extensive handwritten Chinese text - full transcription would require detailed character-by-character analysis]", "language": "Chinese (Simplified)", "location": "handwritten document body"}], "processing_notes": ["Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 2}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164821071.jpg", "extracted_data": {"title": "ÂΩªÂ∫ïÁöÑÂèçÊª°‚Äî‚ÄîÔºàÂÖ´ÊóóÁîüËÆ°Ôºâ", "creator": {"name": "Uncertain - multiple authors referenced in text", "type": "personal", "source": "claude_analysis"}, "format": "printed document/pamphlet", "extent": "Single sheet or page", "dimensions": "Approximately A4 or similar size", "language": "chi", "original_script_title": "Simplified Chinese characters", "other_identifiers": "Number '15' visible on yellow note", "subjects": [{"heading": "Eight Banners system", "type": "topical", "source": "claude_analysis"}, {"heading": "Anti-Manchu sentiment", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese political history", "type": "topical", "source": "claude_analysis"}, {"heading": "Qing Dynasty", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document appears to be a historical or political text discussing the Eight Banners (ÂÖ´Êóó) system", "source": "image_analysis"}, {"text": "Yellow sticky note attached with handwritten notes in cursive script", "source": "image_analysis"}, {"text": "Text includes references to various historical figures and events", "source": "image_analysis"}, {"text": "Multiple column format typical of Chinese academic or historical documents", "source": "image_analysis"}, {"text": "Document appears to be a photocopy or reproduction", "source": "image_analysis"}, {"text": "Contains extensive footnotes and references at bottom of page", "source": "image_analysis"}, {"text": "Header indicates this is from a series or collection (Â∫è - preface/introduction section)", "source": "image_analysis"}, {"text": "Text discusses anti-Manchu (ÂèçÊª°) ideology", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.0, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.4365}, "overall_confidence": 0.4365, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "ÂΩªÂ∫ïÁöÑÂèçÊª°‚Äî‚ÄîÔºàÂÖ´ÊóóÁîüËÆ°Ôºâ", "language": "Chinese", "location": "header/title"}, {"text": "Â∫è", "language": "Chinese", "location": "left margin identifier"}, {"text": "Handwritten note on yellow paper (partially legible cursive)", "language": "English or romanized text", "location": "sticky note overlay"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 3}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164339517.jpg", "extracted_data": {"title": "Urgent appeal to ban some books and songs, from red guards in the 'Anti-revisionist Commune'", "creator": {"name": "Red guards from 'Anti-revisionist Commune'", "type": "corporate", "source": "claude_analysis"}, "publisher": "Unpublished - Red Guard document", "publication_place": "Beijing area (Huangzhuang/Haidian district implied)", "publication_date": "1966-1967 (Cultural Revolution period)", "normalized_date": {"normalized": "1966", "end_date": "1967", "circa": true, "uncertain": false, "original": "1966-1967 (Cultural Revolution period)"}, "format": "manuscript", "extent": "Multiple pages - handwritten document with typed English description", "dimensions": "Standard letter/A4 size approximately", "language": "chi", "original_script_title": "Simplified Chinese characters (handwritten)", "other_identifiers": "42 (marked on yellow note); 12.8.97 (date notation on yellow note)", "subjects": [{"heading": "Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "Red Guards", "type": "topical", "source": "claude_analysis"}, {"heading": "Censorship", "type": "topical", "source": "claude_analysis"}, {"heading": "Anti-revisionist movement", "type": "topical", "source": "claude_analysis"}, {"heading": "Banned books", "type": "topical", "source": "claude_analysis"}, {"heading": "Political persecution", "type": "topical", "source": "claude_analysis"}, {"heading": "1958 Beijing suburbs", "type": "topical", "source": "claude_analysis"}, {"heading": "Ouyang Hai", "type": "topical", "source": "claude_analysis"}, {"heading": "Chairman Mao study materials", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document is preserved in plastic sleeve with archival yellow note and typed English description", "source": "image_analysis"}, {"text": "Yellow note indicates: 'Cultural Revolution handouts, Urgent appeal to ban some books & songs from Red Guards in the 'Anti-revisionist Commune'", "source": "image_analysis"}, {"text": "English description references: call number 67 66.8.27, mentions 'Eastlu gonghe' (Guanr Huangzhuang), discusses banning of 'black' books", "source": "image_analysis"}, {"text": "References to former Beijing Party Committee and Ouyang Hai", "source": "image_analysis"}, {"text": "Mentions Huangzhuang Commune and Chen Ling borough", "source": "image_analysis"}, {"text": "Document discusses Cultural Revolution era censorship activities", "source": "image_analysis"}, {"text": "Appears to be part of an archival collection documenting Cultural Revolution materials", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.45499999999999996, "format": 0.45499999999999996, "language": 0.5850000000000001, "overall": 0.5275}, "overall_confidence": 0.5275, "claude_factors": {"text_clarity": "medium", "completeness": "medium", "language_certainty": "high"}, "original_text_regions": [{"text": "12.8.97\nCultural Revolution\nhandouts\nUrgent appeal to ban\nsome books & songs from\nRed Guards in the 'Anti-\nrevisionist Commune'.\n42", "language": "English", "location": "yellow archival note"}, {"text": "67 66.8.27 Urgent appeal to ban some books and songs, from red guards in the 'Anti-revisionist Commune'\nHeadline: ÂùöÂÜ≥ÊâìÂáªÔºÅÔºÅÔºÅ[jian hoyu!!!]\n[Trans: Urgent appeal!!!]\nPublished by: ‰∏úË∑ØÂÖ¨Á§æ'Âèç‰øÆÂÖ¨Á§æ'ÊñáÂåñÈù©ÂëΩËÅîÊü•‰øùÂç´Âëò Eastlu gonghe Guanr Huangzhuang", "language": "English with Chinese", "location": "typed description card"}, {"text": "Á¥ßÊÄ•ÂëºÂêÅ!!!", "language": "Chinese", "location": "handwritten document heading"}], "processing_notes": ["Title extraction has low confidence", "Creator/author extraction has low confidence", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 4}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164450342.jpg", "extracted_data": {"title": "Èù©ÂëΩÈùíÂ∞ëÂπ¥Ë¶ÅÂêëËß£ÊîæÂÜõÂ≠¶‰π†", "subtitle": "‰∫∫Ê∞ëÊó•Êä•ÂÖ´Êúà‰∫åÂçÅÂÖ´Êó•Á§æËÆ∫", "creator": {"name": "‰∫∫Ê∞ëÊó•Êä• (Renmin Ribao / People's Daily)", "type": "corporate", "source": "claude_analysis", "romanization": "Renmin Ribao"}, "publisher": "‰∫∫Ê∞ëÊó•Êä• (People's Daily)", "publication_place": "China", "publication_date": "1966-08-28", "normalized_date": {"normalized": "1966", "end_date": null, "circa": false, "uncertain": false, "original": "1966-08-28"}, "format": "printed newspaper editorial/pamphlet", "extent": "Single sheet, printed on one side", "dimensions": "Approximately standard newspaper/bulletin size", "language": "chi", "original_script_title": "Simplified Chinese", "other_identifiers": "RI.1966/9.3.28 (archival reference number visible on attached label)", "subjects": [{"heading": "Cultural Revolution", "type": "topical", "source": "claude_analysis"}, {"heading": "People's Liberation Army (PLA)", "type": "topical", "source": "claude_analysis"}, {"heading": "Revolutionary youth", "type": "topical", "source": "claude_analysis"}, {"heading": "Mao Zedong thought", "type": "topical", "source": "claude_analysis"}, {"heading": "Chinese politics - 1966", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "This is a People's Daily editorial from August 28, 1966, during the Cultural Revolution period", "source": "image_analysis"}, {"text": "The document features a prominent red quotation box at the top with Mao's sayings: 'Read Chairman Mao's books, listen to Chairman Mao's words, follow Chairman Mao's instructions, be Chairman Mao's good soldiers'", "source": "image_analysis"}, {"text": "Title translates to: 'Revolutionary Youth Must Learn from the Liberation Army'", "source": "image_analysis"}, {"text": "Document appears to be archivally preserved in a protective sleeve on a wooden board", "source": "image_analysis"}, {"text": "Yellow archival note attached indicates: '1966.8.28 Cultural Revolution unveiled People's Daily editorial from August 28'", "source": "image_analysis"}, {"text": "White label provides English translation and cataloging information, referencing Liu Biao's directive and quotations from Chairman Mao", "source": "image_analysis"}, {"text": "The document exemplifies PLA heroes such as Dong Cunrui, Huang Jiguang, Qiu Shaoyun, and others", "source": "image_analysis"}, {"text": "Text is printed entirely in red ink on cream/tan colored paper, typical of Cultural Revolution propaganda materials", "source": "image_analysis"}, {"text": "Year explicitly stated as 1966 on the archival label", "source": "image_analysis"}, {"text": "Archival reference number appears to be (93) circled on the yellow note", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.765, "creator": 0.675, "publication": 0.5850000000000001, "format": 0.5850000000000001, "language": 0.5850000000000001, "overall": 0.6615}, "overall_confidence": 0.6615, "claude_factors": {"text_clarity": "high", "completeness": "high", "language_certainty": "high"}, "original_text_regions": [{"text": "ËØªÊØõ‰∏ªÂ∏≠ÁöÑ‰π¶ÔºåÂê¨ÊØõ‰∏ªÂ∏≠ÁöÑËØùÔºåÁÖßÊØõ‰∏ªÂ∏≠ÁöÑÊåáÁ§∫Âäû‰∫ãÔºåÂÅöÊØõ‰∏ªÂ∏≠ÁöÑÂ•ΩÊàòÂ£´„ÄÇ", "language": "Simplified Chinese", "location": "header quote box"}, {"text": "Èù©ÂëΩÈùíÂ∞ëÂπ¥Ë¶ÅÂêëËß£ÊîæÂÜõÂ≠¶‰π†", "language": "Simplified Chinese", "location": "main title"}, {"text": "(‰∫∫Ê∞ëÊó•Êä•ÂÖ´Êúà‰∫åÂçÅÂÖ´Êó•Á§æËÆ∫)", "language": "Simplified Chinese", "location": "subtitle"}, {"text": "1966.8.28 Cultural Revolution unveiled People's Daily editorial from August 28", "language": "English", "location": "yellow archival note"}, {"text": "RI.1966/9.3.28 People's Daily editorial from August 28", "language": "English", "location": "white archival label"}], "processing_notes": ["Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 5}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164253582.jpg", "extracted_data": {"title": "A Provenance: the name of the man / Portrait Album of Eight Officials from the", "creator": {"name": "Cannot be determined from visible text", "type": null, "source": "claude_analysis"}, "publication_date": "1906-2.3", "normalized_date": {"normalized": "1906", "end_date": null, "circa": false, "uncertain": false, "original": "1906-2.3"}, "format": "manuscript", "extent": "Multiple sheets, including yellow note and white descriptive sheet", "dimensions": "Standard manuscript size, approximately A4 or similar", "language": "chi", "original_script_title": "Traditional Chinese characters", "other_identifiers": "File: 8.25", "subjects": [{"heading": "Chinese officials", "type": "topical", "source": "claude_analysis"}, {"heading": "Portrait album", "type": "topical", "source": "claude_analysis"}, {"heading": "Historical documents", "type": "topical", "source": "claude_analysis"}, {"heading": "Provenance research", "type": "topical", "source": "claude_analysis"}], "notes": [{"text": "Document appears to be archival material with research notes", "source": "image_analysis"}, {"text": "Yellow sticky note contains handwritten notes including 'File: 8.25' and mentions 'research'", "source": "image_analysis"}, {"text": "White sheet contains English text describing provenance of portrait album", "source": "image_analysis"}, {"text": "Main document contains traditional Chinese vertical text", "source": "image_analysis"}, {"text": "Item is stored in protective plastic sleeve", "source": "image_analysis"}, {"text": "Paper clip attached to documents", "source": "image_analysis"}, {"text": "Some red markings visible on the Chinese text document", "source": "image_analysis"}, {"text": "Documents appear to be cataloging or research materials rather than the original album itself", "source": "image_analysis"}], "extraction_source": "claude_vision", "title_source": "claude_analysis", "creator_source": "claude_analysis", "publication_source": "claude_analysis"}, "confidence_scores": {"title": 0.595, "creator": 0.5249999999999999, "publication": 0.15166666666666667, "format": 0.26, "language": 0.5850000000000001, "overall": 0.4375833333333333}, "overall_confidence": 0.4375833333333333, "claude_factors": {"text_clarity": "medium", "completeness": "low", "language_certainty": "high"}, "original_text_regions": [{"text": "A Provenance: the name of the man / Portrait Album of Eight Officials from the... Notes taken from bound album on the second of eight portrait paintings... [partial text visible]", "language": "English", "location": "white descriptive sheet"}, {"text": "ÂêÑÂßìÂêçÊüêÊüêÊüê‰∏ªÊüêÁ≠âÊüêÊüê‰∫é‰∏âÊúàÊüêÊüê... [Traditional Chinese characters in vertical columns]", "language": "Chinese", "location": "main document"}, {"text": "File: 8.25 [and other handwritten notes]", "language": "English", "location": "yellow note"}], "processing_notes": ["Overall confidence is low - manual review recommended", "Title extraction has low confidence", "Creator/author extraction has low confidence", "Bibliographic information appears incomplete in image", "Contains CJK characters - romanization provided"], "review_required": true, "sequence_number": 6}], "collection_analysis": {"total_items": 6, "successful_extractions": 6, "common_characteristics": {"primary_language": "chi", "language_distribution": {"eng": 1, "chinese (simplified)": 1, "chi": 4}, "primary_format": "manuscript", "format_distribution": {"archival collection": 1, "manuscript and printed materials - handbills/leaflets": 1, "printed document/pamphlet": 1, "manuscript": 2, "printed newspaper editorial/pamphlet": 1}, "publishers": {"No. 27 Revolutionary Railroad Middle School": 1, "Unpublished - Red Guard document": 1, "‰∫∫Ê∞ëÊó•Êä• (People's Daily)": 1}}, "quality_assessment": {"average_confidence": 0.5095694444444444, "high_confidence_items": 0, "low_confidence_items": 3, "confidence_range": [0.4365, 0.6615]}, "recommendations": ["More than 30% of items have low confidence - consider manual review", "Multiple languages detected - verify language coding", "6 items contain CJK characters - verify romanization"]}, "batch_confidence": 0.5095694444444444, "processing_timestamp": "2025-12-23T09:44:20.812102"}, "individual_extractions": [{"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164209737.jpg", "extraction_confidence": 0.4668333333333333, "extracted_fields": ["title", "creator", "publication_date", "normalized_date", "format", "extent", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164650783.jpg", "extraction_confidence": 0.5275, "extracted_fields": ["title", "creator", "publisher", "publication_place", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164821071.jpg", "extraction_confidence": 0.4365, "extracted_fields": ["title", "creator", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164339517.jpg", "extraction_confidence": 0.5275, "extracted_fields": ["title", "creator", "publisher", "publication_place", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164450342.jpg", "extraction_confidence": 0.6615, "extracted_fields": ["title", "subtitle", "creator", "publisher", "publication_place", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}, {"image_path": "examples/Cultural Revolution Handbills/PXL_20251212_164253582.jpg", "extraction_confidence": 0.4375833333333333, "extracted_fields": ["title", "creator", "publication_date", "normalized_date", "format", "extent", "dimensions", "language", "original_script_title", "other_identifiers", "subjects", "notes", "extraction_source", "title_source", "creator_source", "publication_source", "source_image", "extraction_confidence", "sequence_number"]}], "external_api_results": [{"worldcat": [], "loc": [], "alma": [], "best_match": null}]};
        const metadataData = {"workflow_type": "collection_images_to_marc", "collection_name": "api_test_crh_fixed", "processing_result": {"approach": "collection", "records_generated": 1, "review_required": true, "groupings": {"approach": "collection", "total_items": 6, "groups": [{"type": "collection", "items": ["Archived Box 5 Chinese Cultural Revolution handbills, plus printed miscellany", "Railroad Revision Handbills - Three-page leaflet from Zhongyang Lu No. 27 Railroad Elementary/Middle School", "ÂΩªÂ∫ïÁöÑÂèçÊª°‚Äî‚ÄîÔºàÂÖ´ÊóóÁîüËÆ°Ôºâ", "Urgent appeal to ban some books and songs, from red guards in the 'Anti-revisionist Commune'", "Èù©ÂëΩÈùíÂ∞ëÂπ¥Ë¶ÅÂêëËß£ÊîæÂÜõÂ≠¶‰π†", "A Provenance: the name of the man / Portrait Album of Eight Officials from the"], "record_type": "collection"}]}}, "collection_data": {"total_items": 6, "source_images": ["examples/Cultural Revolution Handbills/PXL_20251212_164209737.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164650783.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164821071.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164339517.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164450342.jpg", "examples/Cultural Revolution Handbills/PXL_20251212_164253582.jpg"], "provenance": "Extracted from 6 images using marcsnarc"}, "batch_analysis_summary": {"total_images": 6, "successful_analyses": 6, "batch_confidence": 0.5095694444444444}, "processing_timestamp": "2025-12-23T09:44:21.100212"};
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize images array from gallery
            const thumbnails = document.querySelectorAll('.thumbnail');
            currentImages = Array.from(thumbnails).map(img => ({
                src: img.src,
                alt: img.alt
            }));
            
            // Initialize JSON trees
            if (analysisData && Object.keys(analysisData).length > 0) {
                renderJsonTree('analysis-tree', analysisData);
            }
            if (metadataData && Object.keys(metadataData).length > 0) {
                renderJsonTree('metadata-tree', metadataData);
            }
        });
        
        // Modal functions
        function openModal(index) {
            currentImageIndex = index;
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const counter = document.getElementById('modalCounter');
            
            if (currentImages[index]) {
                modalImage.src = currentImages[index].src;
                modalImage.alt = currentImages[index].alt;
                counter.textContent = `${index + 1} of ${currentImages.length}`;
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function changeImage(direction) {
            currentImageIndex = (currentImageIndex + direction + currentImages.length) % currentImages.length;
            openModal(currentImageIndex);
        }
        
        // Keyboard controls
        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'block') {
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft') changeImage(-1);
                if (e.key === 'ArrowRight') changeImage(1);
            }
        });
        
        // Close modal on background click
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        // JSON Tree rendering functions
        function renderJsonTree(containerId, data) {
            const container = document.getElementById(containerId);
            if (!container || !data) return;
            
            container.innerHTML = '';
            const tree = createTreeElement(data, '', 0);
            container.appendChild(tree);
        }
        
        function createTreeElement(value, key, level) {
            const wrapper = document.createElement('div');
            wrapper.style.marginLeft = `${level * 20}px`;
            wrapper.style.marginBottom = '3px';
            
            if (value && typeof value === 'object' && !Array.isArray(value)) {
                // Object
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                Object.entries(value).forEach(([childKey, childValue]) => {
                    children.appendChild(createTreeElement(childValue, childKey, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìÅ ${key} {${Object.keys(value).length}}</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìÇ ${key} {${Object.keys(value).length}}</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else if (Array.isArray(value)) {
                // Array
                const keyElement = document.createElement('div');
                keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                keyElement.style.userSelect = 'none';
                
                const children = document.createElement('div');
                children.style.display = 'none';
                children.style.borderLeft = '2px solid #e2e8f0';
                children.style.marginLeft = '15px';
                children.style.paddingLeft = '10px';
                
                value.forEach((item, index) => {
                    children.appendChild(createTreeElement(item, `[${index}]`, 0));
                });
                
                keyElement.addEventListener('click', function() {
                    const isExpanded = children.style.display !== 'none';
                    if (isExpanded) {
                        children.style.display = 'none';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñ∂ üìö ${key} [${value.length}]</span>`;
                    } else {
                        children.style.display = 'block';
                        keyElement.innerHTML = `<span style="cursor: pointer; color: #2d3748; font-weight: 600;">‚ñº üìñ ${key} [${value.length}]</span>`;
                    }
                });
                
                wrapper.appendChild(keyElement);
                wrapper.appendChild(children);
            } else {
                // Primitive value
                const element = document.createElement('div');
                const valueStr = value === null ? 'null' : String(value);
                const valueType = typeof value;
                let color = '#4a5568';
                let icon = 'üìÑ';
                
                if (valueType === 'string') { color = '#38a169'; icon = 'üìù'; }
                else if (valueType === 'number') { color = '#d69e2e'; icon = 'üî¢'; }
                else if (valueType === 'boolean') { color = '#9f7aea'; icon = '‚úÖ'; }
                else if (value === null) { color = '#a0aec0'; icon = '‚ùå'; }
                
                element.innerHTML = `<span style="color: #2d3748; font-weight: 600;">${icon} ${key}:</span> <span style="color: ${color};">${valueType === 'string' ? '"' + valueStr + '"' : valueStr}</span>`;
                wrapper.appendChild(element);
            }
            
            return wrapper;
        }
        
        function expandAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñ∂')) {
                    span.parentElement.click();
                }
            });
        }
        
        function collapseAllNodes(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            // Find all clickable tree nodes (divs containing spans with cursor: pointer)
            container.querySelectorAll('span[style*="cursor: pointer"]').forEach(span => {
                if (span.innerHTML.includes('‚ñº')) {
                    span.parentElement.click();
                }
            });
        }
    </script>
</body>
</html>